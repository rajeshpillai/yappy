(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();const Vn=!1,Hn=(t,e)=>t===e,fe=Symbol("solid-proxy"),gn=typeof Proxy=="function",Lt=Symbol("solid-track"),ut={equals:Hn};let yn=vn;const Se=1,ft=2,mn={owned:null,cleanups:null,context:null,owner:null};var te=null;let Ot=null,Un=null,K=null,oe=null,ve=null,$t=0;function rt(t,e){const n=K,s=te,i=t.length===0,o=e===void 0?s:e,a=i?mn:{owned:null,cleanups:null,context:o?o.context:null,owner:o},l=i?t:()=>t(()=>ge(()=>Ue(a)));te=a,K=null;try{return je(l,!0)}finally{K=n,te=s}}function ne(t,e){e=e?Object.assign({},ut,e):ut;const n={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},s=i=>(typeof i=="function"&&(i=i(n.value)),wn(n,i));return[bn.bind(n),s]}function B(t,e,n){const s=Bt(t,e,!1,Se);Je(s)}function Ie(t,e,n){yn=Kn;const s=Bt(t,e,!1,Se);s.user=!0,ve?ve.push(s):Je(s)}function ue(t,e,n){n=n?Object.assign({},ut,n):ut;const s=Bt(t,e,!0,0);return s.observers=null,s.observerSlots=null,s.comparator=n.equals||void 0,Je(s),bn.bind(s)}function qn(t){return je(t,!1)}function ge(t){if(K===null)return t();const e=K;K=null;try{return t()}finally{K=e}}function St(t){Ie(()=>ge(t))}function Mt(t){return te===null||(te.cleanups===null?te.cleanups=[t]:te.cleanups.push(t)),t}function It(){return K}function bn(){if(this.sources&&this.state)if(this.state===Se)Je(this);else{const t=oe;oe=null,je(()=>pt(this),!1),oe=t}if(K){const t=this.observers?this.observers.length:0;K.sources?(K.sources.push(this),K.sourceSlots.push(t)):(K.sources=[this],K.sourceSlots=[t]),this.observers?(this.observers.push(K),this.observerSlots.push(K.sources.length-1)):(this.observers=[K],this.observerSlots=[K.sources.length-1])}return this.value}function wn(t,e,n){let s=t.value;return(!t.comparator||!t.comparator(s,e))&&(t.value=e,t.observers&&t.observers.length&&je(()=>{for(let i=0;i<t.observers.length;i+=1){const o=t.observers[i],a=Ot&&Ot.running;a&&Ot.disposed.has(o),(a?!o.tState:!o.state)&&(o.pure?oe.push(o):ve.push(o),o.observers&&kn(o)),a||(o.state=Se)}if(oe.length>1e6)throw oe=[],new Error},!1)),e}function Je(t){if(!t.fn)return;Ue(t);const e=$t;Bn(t,t.value,e)}function Bn(t,e,n){let s;const i=te,o=K;K=te=t;try{s=t.fn(e)}catch(a){return t.pure&&(t.state=Se,t.owned&&t.owned.forEach(Ue),t.owned=null),t.updatedAt=n+1,xn(a)}finally{K=o,te=i}(!t.updatedAt||t.updatedAt<=n)&&(t.updatedAt!=null&&"observers"in t?wn(t,s):t.value=s,t.updatedAt=n)}function Bt(t,e,n,s=Se,i){const o={fn:t,state:s,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:te,context:te?te.context:null,pure:n};return te===null||te!==mn&&(te.owned?te.owned.push(o):te.owned=[o]),o}function dt(t){if(t.state===0)return;if(t.state===ft)return pt(t);if(t.suspense&&ge(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<$t);)t.state&&e.push(t);for(let n=e.length-1;n>=0;n--)if(t=e[n],t.state===Se)Je(t);else if(t.state===ft){const s=oe;oe=null,je(()=>pt(t,e[0]),!1),oe=s}}function je(t,e){if(oe)return t();let n=!1;e||(oe=[]),ve?n=!0:ve=[],$t++;try{const s=t();return Gn(n),s}catch(s){n||(ve=null),oe=null,xn(s)}}function Gn(t){if(oe&&(vn(oe),oe=null),t)return;const e=ve;ve=null,e.length&&je(()=>yn(e),!1)}function vn(t){for(let e=0;e<t.length;e++)dt(t[e])}function Kn(t){let e,n=0;for(e=0;e<t.length;e++){const s=t[e];s.user?t[n++]=s:dt(s)}for(e=0;e<n;e++)dt(t[e])}function pt(t,e){t.state=0;for(let n=0;n<t.sources.length;n+=1){const s=t.sources[n];if(s.sources){const i=s.state;i===Se?s!==e&&(!s.updatedAt||s.updatedAt<$t)&&dt(s):i===ft&&pt(s,e)}}}function kn(t){for(let e=0;e<t.observers.length;e+=1){const n=t.observers[e];n.state||(n.state=ft,n.pure?oe.push(n):ve.push(n),n.observers&&kn(n))}}function Ue(t){let e;if(t.sources)for(;t.sources.length;){const n=t.sources.pop(),s=t.sourceSlots.pop(),i=n.observers;if(i&&i.length){const o=i.pop(),a=n.observerSlots.pop();s<i.length&&(o.sourceSlots[a]=s,i[s]=o,n.observerSlots[s]=a)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)Ue(t.tOwned[e]);delete t.tOwned}if(t.owned){for(e=t.owned.length-1;e>=0;e--)Ue(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function Zn(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function xn(t,e=te){throw Zn(t)}const Jn=Symbol("fallback");function tn(t){for(let e=0;e<t.length;e++)t[e]()}function Qn(t,e,n={}){let s=[],i=[],o=[],a=0,l=e.length>1?[]:null;return Mt(()=>tn(o)),()=>{let r=t()||[],h=r.length,c,u;return r[Lt],ge(()=>{let p,m,k,g,x,P,A,O,z;if(h===0)a!==0&&(tn(o),o=[],s=[],i=[],a=0,l&&(l=[])),n.fallback&&(s=[Jn],i[0]=rt(L=>(o[0]=L,n.fallback())),a=1);else if(a===0){for(i=new Array(h),u=0;u<h;u++)s[u]=r[u],i[u]=rt(f);a=h}else{for(k=new Array(h),g=new Array(h),l&&(x=new Array(h)),P=0,A=Math.min(a,h);P<A&&s[P]===r[P];P++);for(A=a-1,O=h-1;A>=P&&O>=P&&s[A]===r[O];A--,O--)k[O]=i[A],g[O]=o[A],l&&(x[O]=l[A]);for(p=new Map,m=new Array(O+1),u=O;u>=P;u--)z=r[u],c=p.get(z),m[u]=c===void 0?-1:c,p.set(z,u);for(c=P;c<=A;c++)z=s[c],u=p.get(z),u!==void 0&&u!==-1?(k[u]=i[c],g[u]=o[c],l&&(x[u]=l[c]),u=m[u],p.set(z,u)):o[c]();for(u=P;u<h;u++)u in k?(i[u]=k[u],o[u]=g[u],l&&(l[u]=x[u],l[u](u))):i[u]=rt(f);i=i.slice(0,a=h),s=r.slice(0)}return i});function f(p){if(o[u]=p,l){const[m,k]=ne(u);return l[u]=k,e(r[u],m)}return e(r[u])}}}function v(t,e){return ge(()=>t(e||{}))}function nt(){return!0}const Dt={get(t,e,n){return e===fe?n:t.get(e)},has(t,e){return e===fe?!0:t.has(e)},set:nt,deleteProperty:nt,getOwnPropertyDescriptor(t,e){return{configurable:!0,enumerable:!0,get(){return t.get(e)},set:nt,deleteProperty:nt}},ownKeys(t){return t.keys()}};function Tt(t){return(t=typeof t=="function"?t():t)?t:{}}function es(){for(let t=0,e=this.length;t<e;++t){const n=this[t]();if(n!==void 0)return n}}function F(...t){let e=!1;for(let a=0;a<t.length;a++){const l=t[a];e=e||!!l&&fe in l,t[a]=typeof l=="function"?(e=!0,ue(l)):l}if(gn&&e)return new Proxy({get(a){for(let l=t.length-1;l>=0;l--){const r=Tt(t[l])[a];if(r!==void 0)return r}},has(a){for(let l=t.length-1;l>=0;l--)if(a in Tt(t[l]))return!0;return!1},keys(){const a=[];for(let l=0;l<t.length;l++)a.push(...Object.keys(Tt(t[l])));return[...new Set(a)]}},Dt);const n={},s=Object.create(null);for(let a=t.length-1;a>=0;a--){const l=t[a];if(!l)continue;const r=Object.getOwnPropertyNames(l);for(let h=r.length-1;h>=0;h--){const c=r[h];if(c==="__proto__"||c==="constructor")continue;const u=Object.getOwnPropertyDescriptor(l,c);if(!s[c])s[c]=u.get?{enumerable:!0,configurable:!0,get:es.bind(n[c]=[u.get.bind(l)])}:u.value!==void 0?u:void 0;else{const f=n[c];f&&(u.get?f.push(u.get.bind(l)):u.value!==void 0&&f.push(()=>u.value))}}}const i={},o=Object.keys(s);for(let a=o.length-1;a>=0;a--){const l=o[a],r=s[l];r&&r.get?Object.defineProperty(i,l,r):i[l]=r?r.value:void 0}return i}function $n(t,...e){const n=e.length;if(gn&&fe in t){const i=n>1?e.flat():e[0],o=e.map(a=>new Proxy({get(l){return a.includes(l)?t[l]:void 0},has(l){return a.includes(l)&&l in t},keys(){return a.filter(l=>l in t)}},Dt));return o.push(new Proxy({get(a){return i.includes(a)?void 0:t[a]},has(a){return i.includes(a)?!1:a in t},keys(){return Object.keys(t).filter(a=>!i.includes(a))}},Dt)),o}const s=[];for(let i=0;i<=n;i++)s[i]={};for(const i of Object.getOwnPropertyNames(t)){let o=n;for(let r=0;r<e.length;r++)if(e[r].includes(i)){o=r;break}const a=Object.getOwnPropertyDescriptor(t,i);!a.get&&!a.set&&a.enumerable&&a.writable&&a.configurable?s[o][i]=a.value:Object.defineProperty(s[o],i,a)}return s}const ts=t=>`Stale read from <${t}>.`;function Le(t){const e="fallback"in t&&{fallback:()=>t.fallback};return ue(Qn(()=>t.each,t.children,e||void 0))}function ce(t){const e=t.keyed,n=ue(()=>t.when,void 0,void 0),s=e?n:ue(n,void 0,{equals:(i,o)=>!i==!o});return ue(()=>{const i=s();if(i){const o=t.children;return typeof o=="function"&&o.length>0?ge(()=>o(e?i:()=>{if(!ge(s))throw ts("Show");return n()})):o}return t.fallback},void 0,void 0)}const ns=["allowfullscreen","async","alpha","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected","adauctionheaders","browsingtopics","credentialless","defaultchecked","defaultmuted","defaultselected","defer","disablepictureinpicture","disableremoteplayback","preservespitch","shadowrootclonable","shadowrootcustomelementregistry","shadowrootdelegatesfocus","shadowrootserializable","sharedstoragewritable"],ss=new Set(["className","value","readOnly","noValidate","formNoValidate","isMap","noModule","playsInline","adAuctionHeaders","allowFullscreen","browsingTopics","defaultChecked","defaultMuted","defaultSelected","disablePictureInPicture","disableRemotePlayback","preservesPitch","shadowRootClonable","shadowRootCustomElementRegistry","shadowRootDelegatesFocus","shadowRootSerializable","sharedStorageWritable",...ns]),is=new Set(["innerHTML","textContent","innerText","children"]),os=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),ls=Object.assign(Object.create(null),{class:"className",novalidate:{$:"noValidate",FORM:1},formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1},adauctionheaders:{$:"adAuctionHeaders",IFRAME:1},allowfullscreen:{$:"allowFullscreen",IFRAME:1},browsingtopics:{$:"browsingTopics",IMG:1},defaultchecked:{$:"defaultChecked",INPUT:1},defaultmuted:{$:"defaultMuted",AUDIO:1,VIDEO:1},defaultselected:{$:"defaultSelected",OPTION:1},disablepictureinpicture:{$:"disablePictureInPicture",VIDEO:1},disableremoteplayback:{$:"disableRemotePlayback",AUDIO:1,VIDEO:1},preservespitch:{$:"preservesPitch",AUDIO:1,VIDEO:1},shadowrootclonable:{$:"shadowRootClonable",TEMPLATE:1},shadowrootdelegatesfocus:{$:"shadowRootDelegatesFocus",TEMPLATE:1},shadowrootserializable:{$:"shadowRootSerializable",TEMPLATE:1},sharedstoragewritable:{$:"sharedStorageWritable",IFRAME:1,IMG:1}});function as(t,e){const n=ls[t];return typeof n=="object"?n[e]?n.$:void 0:n}const rs=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),cs=new Set(["altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignObject","g","glyph","glyphRef","hkern","image","line","linearGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","set","stop","svg","switch","symbol","text","textPath","tref","tspan","use","view","vkern"]),hs={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"},_t=t=>ue(()=>t());function us(t,e,n){let s=n.length,i=e.length,o=s,a=0,l=0,r=e[i-1].nextSibling,h=null;for(;a<i||l<o;){if(e[a]===n[l]){a++,l++;continue}for(;e[i-1]===n[o-1];)i--,o--;if(i===a){const c=o<s?l?n[l-1].nextSibling:n[o-l]:r;for(;l<o;)t.insertBefore(n[l++],c)}else if(o===l)for(;a<i;)(!h||!h.has(e[a]))&&e[a].remove(),a++;else if(e[a]===n[o-1]&&n[l]===e[i-1]){const c=e[--i].nextSibling;t.insertBefore(n[l++],e[a++].nextSibling),t.insertBefore(n[--o],c),e[i]=n[o]}else{if(!h){h=new Map;let u=l;for(;u<o;)h.set(n[u],u++)}const c=h.get(e[a]);if(c!=null)if(l<c&&c<o){let u=a,f=1,p;for(;++u<i&&u<o&&!((p=h.get(e[u]))==null||p!==c+f);)f++;if(f>c-l){const m=e[a];for(;l<c;)t.insertBefore(n[l++],m)}else t.replaceChild(n[l++],e[a++])}else a++;else e[a++].remove()}}}const nn="_$DX_DELEGATE";function fs(t,e,n,s={}){let i;return rt(o=>{i=o,e===document?t():T(e,t(),e.firstChild?null:void 0,n)},s.owner),()=>{i(),e.textContent=""}}function R(t,e,n,s){let i;const o=()=>{const l=document.createElement("template");return l.innerHTML=t,l.content.firstChild},a=()=>(i||(i=o())).cloneNode(!0);return a.cloneNode=a,a}function ke(t,e=window.document){const n=e[nn]||(e[nn]=new Set);for(let s=0,i=t.length;s<i;s++){const o=t[s];n.has(o)||(n.add(o),e.addEventListener(o,ws))}}function xe(t,e,n){n==null?t.removeAttribute(e):t.setAttribute(e,n)}function ds(t,e,n,s){s==null?t.removeAttributeNS(e,n):t.setAttributeNS(e,n,s)}function ps(t,e,n){n?t.setAttribute(e,""):t.removeAttribute(e)}function Ce(t,e){e==null?t.removeAttribute("class"):t.className=e}function he(t,e,n,s){if(s)Array.isArray(n)?(t[`$$${e}`]=n[0],t[`$$${e}Data`]=n[1]):t[`$$${e}`]=n;else if(Array.isArray(n)){const i=n[0];t.addEventListener(e,n[0]=o=>i.call(t,n[1],o))}else t.addEventListener(e,n,typeof n!="function"&&n)}function gs(t,e,n={}){const s=Object.keys(e||{}),i=Object.keys(n);let o,a;for(o=0,a=i.length;o<a;o++){const l=i[o];!l||l==="undefined"||e[l]||(sn(t,l,!1),delete n[l])}for(o=0,a=s.length;o<a;o++){const l=s[o],r=!!e[l];!l||l==="undefined"||n[l]===r||!r||(sn(t,l,!0),n[l]=r)}return n}function ys(t,e,n){if(!e)return n?xe(t,"style"):e;const s=t.style;if(typeof e=="string")return s.cssText=e;typeof n=="string"&&(s.cssText=n=void 0),n||(n={}),e||(e={});let i,o;for(o in n)e[o]==null&&s.removeProperty(o),delete n[o];for(o in e)i=e[o],i!==n[o]&&(s.setProperty(o,i),n[o]=i);return n}function Ne(t,e,n){n!=null?t.style.setProperty(e,n):t.style.removeProperty(e)}function Sn(t,e={},n,s){const i={};return s||B(()=>i.children=Be(t,e.children,i.children)),B(()=>typeof e.ref=="function"&&qe(e.ref,t)),B(()=>ms(t,e,n,!0,i,!0)),i}function qe(t,e,n){return ge(()=>t(e,n))}function T(t,e,n,s){if(n!==void 0&&!s&&(s=[]),typeof e!="function")return Be(t,e,s,n);B(i=>Be(t,e(),i,n),s)}function ms(t,e,n,s,i={},o=!1){e||(e={});for(const a in i)if(!(a in e)){if(a==="children")continue;i[a]=on(t,a,null,i[a],n,o,e)}for(const a in e){if(a==="children")continue;const l=e[a];i[a]=on(t,a,l,i[a],n,o,e)}}function bs(t){return t.toLowerCase().replace(/-([a-z])/g,(e,n)=>n.toUpperCase())}function sn(t,e,n){const s=e.trim().split(/\s+/);for(let i=0,o=s.length;i<o;i++)t.classList.toggle(s[i],n)}function on(t,e,n,s,i,o,a){let l,r,h,c,u;if(e==="style")return ys(t,n,s);if(e==="classList")return gs(t,n,s);if(n===s)return s;if(e==="ref")o||n(t);else if(e.slice(0,3)==="on:"){const f=e.slice(3);s&&t.removeEventListener(f,s,typeof s!="function"&&s),n&&t.addEventListener(f,n,typeof n!="function"&&n)}else if(e.slice(0,10)==="oncapture:"){const f=e.slice(10);s&&t.removeEventListener(f,s,!0),n&&t.addEventListener(f,n,!0)}else if(e.slice(0,2)==="on"){const f=e.slice(2).toLowerCase(),p=rs.has(f);if(!p&&s){const m=Array.isArray(s)?s[0]:s;t.removeEventListener(f,m)}(p||n)&&(he(t,f,n,p),p&&ke([f]))}else if(e.slice(0,5)==="attr:")xe(t,e.slice(5),n);else if(e.slice(0,5)==="bool:")ps(t,e.slice(5),n);else if((u=e.slice(0,5)==="prop:")||(h=is.has(e))||!i&&((c=as(e,t.tagName))||(r=ss.has(e)))||(l=t.nodeName.includes("-")||"is"in a))u&&(e=e.slice(5),r=!0),e==="class"||e==="className"?Ce(t,n):l&&!r&&!h?t[bs(e)]=n:t[c||e]=n;else{const f=i&&e.indexOf(":")>-1&&hs[e.split(":")[0]];f?ds(t,f,e,n):xe(t,os[e]||e,n)}return n}function ws(t){let e=t.target;const n=`$$${t.type}`,s=t.target,i=t.currentTarget,o=r=>Object.defineProperty(t,"target",{configurable:!0,value:r}),a=()=>{const r=e[n];if(r&&!e.disabled){const h=e[`${n}Data`];if(h!==void 0?r.call(e,h,t):r.call(e,t),t.cancelBubble)return}return e.host&&typeof e.host!="string"&&!e.host._$host&&e.contains(t.target)&&o(e.host),!0},l=()=>{for(;a()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return e||document}}),t.composedPath){const r=t.composedPath();o(r[0]);for(let h=0;h<r.length-2&&(e=r[h],!!a());h++){if(e._$host){e=e._$host,l();break}if(e.parentNode===i)break}}else l();o(s)}function Be(t,e,n,s,i){for(;typeof n=="function";)n=n();if(e===n)return n;const o=typeof e,a=s!==void 0;if(t=a&&n[0]&&n[0].parentNode||t,o==="string"||o==="number"){if(o==="number"&&(e=e.toString(),e===n))return n;if(a){let l=n[0];l&&l.nodeType===3?l.data!==e&&(l.data=e):l=document.createTextNode(e),n=Te(t,n,s,l)}else n!==""&&typeof n=="string"?n=t.firstChild.data=e:n=t.textContent=e}else if(e==null||o==="boolean")n=Te(t,n,s);else{if(o==="function")return B(()=>{let l=e();for(;typeof l=="function";)l=l();n=Be(t,l,n,s)}),()=>n;if(Array.isArray(e)){const l=[],r=n&&Array.isArray(n);if(Rt(l,e,n,i))return B(()=>n=Be(t,l,n,s,!0)),()=>n;if(l.length===0){if(n=Te(t,n,s),a)return n}else r?n.length===0?ln(t,l,s):us(t,n,l):(n&&Te(t),ln(t,l));n=l}else if(e.nodeType){if(Array.isArray(n)){if(a)return n=Te(t,n,s,e);Te(t,n,null,e)}else n==null||n===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);n=e}}return n}function Rt(t,e,n,s){let i=!1;for(let o=0,a=e.length;o<a;o++){let l=e[o],r=n&&n[t.length],h;if(!(l==null||l===!0||l===!1))if((h=typeof l)=="object"&&l.nodeType)t.push(l);else if(Array.isArray(l))i=Rt(t,l,r)||i;else if(h==="function")if(s){for(;typeof l=="function";)l=l();i=Rt(t,Array.isArray(l)?l:[l],Array.isArray(r)?r:[r])||i}else t.push(l),i=!0;else{const c=String(l);r&&r.nodeType===3&&r.data===c?t.push(r):t.push(document.createTextNode(c))}}return i}function ln(t,e,n=null){for(let s=0,i=e.length;s<i;s++)t.insertBefore(e[s],n)}function Te(t,e,n,s){if(n===void 0)return t.textContent="";const i=s||document.createTextNode("");if(e.length){let o=!1;for(let a=e.length-1;a>=0;a--){const l=e[a];if(i!==l){const r=l.parentNode===t;!o&&!a?r?t.replaceChild(i,l):t.insertBefore(i,n):r&&l.remove()}else o=!0}}else t.insertBefore(i,n);return[i]}const vs="http://www.w3.org/2000/svg";function ks(t,e=!1,n=void 0){return e?document.createElementNS(vs,t):document.createElement(t,{is:n})}function xs(t,e){const n=ue(t);return ue(()=>{const s=n();switch(typeof s){case"function":return ge(()=>s(e));case"string":const i=cs.has(s),o=ks(s,i,ge(()=>e.is));return Sn(o,e,i),o}})}function $s(t){const[,e]=$n(t,["component"]);return xs(()=>t.component,e)}const jt=Symbol("store-raw"),De=Symbol("store-node"),be=Symbol("store-has"),Mn=Symbol("store-self");function _n(t){let e=t[fe];if(!e&&(Object.defineProperty(t,fe,{value:e=new Proxy(t,_s)}),!Array.isArray(t))){const n=Object.keys(t),s=Object.getOwnPropertyDescriptors(t);for(let i=0,o=n.length;i<o;i++){const a=n[i];s[a].get&&Object.defineProperty(t,a,{enumerable:s[a].enumerable,get:s[a].get.bind(e)})}}return e}function gt(t){let e;return t!=null&&typeof t=="object"&&(t[fe]||!(e=Object.getPrototypeOf(t))||e===Object.prototype||Array.isArray(t))}function Ge(t,e=new Set){let n,s,i,o;if(n=t!=null&&t[jt])return n;if(!gt(t)||e.has(t))return t;if(Array.isArray(t)){Object.isFrozen(t)?t=t.slice(0):e.add(t);for(let a=0,l=t.length;a<l;a++)i=t[a],(s=Ge(i,e))!==i&&(t[a]=s)}else{Object.isFrozen(t)?t=Object.assign({},t):e.add(t);const a=Object.keys(t),l=Object.getOwnPropertyDescriptors(t);for(let r=0,h=a.length;r<h;r++)o=a[r],!l[o].get&&(i=t[o],(s=Ge(i,e))!==i&&(t[o]=s))}return t}function yt(t,e){let n=t[e];return n||Object.defineProperty(t,e,{value:n=Object.create(null)}),n}function Ke(t,e,n){if(t[e])return t[e];const[s,i]=ne(n,{equals:!1,internal:!0});return s.$=i,t[e]=s}function Ss(t,e){const n=Reflect.getOwnPropertyDescriptor(t,e);return!n||n.get||!n.configurable||e===fe||e===De||(delete n.value,delete n.writable,n.get=()=>t[fe][e]),n}function Cn(t){It()&&Ke(yt(t,De),Mn)()}function Ms(t){return Cn(t),Reflect.ownKeys(t)}const _s={get(t,e,n){if(e===jt)return t;if(e===fe)return n;if(e===Lt)return Cn(t),n;const s=yt(t,De),i=s[e];let o=i?i():t[e];if(e===De||e===be||e==="__proto__")return o;if(!i){const a=Object.getOwnPropertyDescriptor(t,e);It()&&(typeof o!="function"||t.hasOwnProperty(e))&&!(a&&a.get)&&(o=Ke(s,e,o)())}return gt(o)?_n(o):o},has(t,e){return e===jt||e===fe||e===Lt||e===De||e===be||e==="__proto__"?!0:(It()&&Ke(yt(t,be),e)(),e in t)},set(){return!0},deleteProperty(){return!0},ownKeys:Ms,getOwnPropertyDescriptor:Ss};function mt(t,e,n,s=!1){if(!s&&t[e]===n)return;const i=t[e],o=t.length;n===void 0?(delete t[e],t[be]&&t[be][e]&&i!==void 0&&t[be][e].$()):(t[e]=n,t[be]&&t[be][e]&&i===void 0&&t[be][e].$());let a=yt(t,De),l;if((l=Ke(a,e,i))&&l.$(()=>n),Array.isArray(t)&&t.length!==o){for(let r=t.length;r<o;r++)(l=a[r])&&l.$();(l=Ke(a,"length",o))&&l.$(t.length)}(l=a[Mn])&&l.$()}function Pn(t,e){const n=Object.keys(e);for(let s=0;s<n.length;s+=1){const i=n[s];mt(t,i,e[i])}}function Cs(t,e){if(typeof e=="function"&&(e=e(t)),e=Ge(e),Array.isArray(e)){if(t===e)return;let n=0,s=e.length;for(;n<s;n++){const i=e[n];t[n]!==i&&mt(t,n,i)}mt(t,"length",s)}else Pn(t,e)}function He(t,e,n=[]){let s,i=t;if(e.length>1){s=e.shift();const a=typeof s,l=Array.isArray(t);if(Array.isArray(s)){for(let r=0;r<s.length;r++)He(t,[s[r]].concat(e),n);return}else if(l&&a==="function"){for(let r=0;r<t.length;r++)s(t[r],r)&&He(t,[r].concat(e),n);return}else if(l&&a==="object"){const{from:r=0,to:h=t.length-1,by:c=1}=s;for(let u=r;u<=h;u+=c)He(t,[u].concat(e),n);return}else if(e.length>1){He(t[s],e,[s].concat(n));return}i=t[s],n=[s].concat(n)}let o=e[0];typeof o=="function"&&(o=o(i,n),o===i)||s===void 0&&o==null||(o=Ge(o),s===void 0||gt(i)&&gt(o)&&!Array.isArray(o)?Pn(i,o):mt(t,s,o))}function Ps(...[t,e]){const n=Ge(t||{}),s=Array.isArray(n),i=_n(n);function o(...a){qn(()=>{s&&a.length===1?Cs(n,a[0]):He(n,a)})}return[i,o]}const An={elements:[],viewState:{scale:1,panX:0,panY:0},selectedTool:"selection",selection:[],defaultElementStyles:{strokeColor:"#000000",backgroundColor:"transparent",fillStyle:"hachure",strokeWidth:1,strokeStyle:"solid",roughness:1,renderStyle:"sketch",opacity:100,angle:0,roundness:null,locked:!1,fontFamily:1,fontSize:20,textAlign:"left",startArrowhead:null,endArrowhead:"arrow",seed:0},theme:localStorage.getItem("theme")||"light"},[b,H]=Ps(An),Pe=[],Ze=[],Ae=()=>{const t=JSON.parse(JSON.stringify(b.elements));Pe.push(t),Pe.length>50&&Pe.shift(),Ze.length=0},On=()=>{if(Pe.length===0)return;const t=JSON.parse(JSON.stringify(b.elements));Ze.push(t);const e=Pe.pop();e&&H("elements",e)},Ft=()=>{if(Ze.length===0)return;const t=JSON.parse(JSON.stringify(b.elements));Pe.push(t);const e=Ze.pop();e&&H("elements",e)},Xt=t=>{Ae(),H("elements",e=>[...e,t])},Re=t=>{t.length!==0&&(Ae(),H("elements",e=>e.filter(n=>!t.includes(n.id))),H("selection",[]))},pe=(t,e,n=!1)=>{n&&Ae(),H("elements",s=>s.id===t,e)},we=t=>{H("viewState",e=>({...e,...t}))},As=t=>{H("selectedTool",t)},Os=t=>{H("defaultElementStyles",e=>({...e,...t}))},Ts=()=>{Pe.length=0,Ze.length=0},Es=t=>{const e=b.elements.find(o=>o.id===t);if(!e)return;Ae();const n=crypto.randomUUID(),s=10/b.viewState.scale,i={...e,id:n,x:e.x+s,y:e.y+s,points:e.points?e.points.map(o=>({...o})):void 0,roundness:e.roundness?{...e.roundness}:null,crop:e.crop?{...e.crop}:null,boundElements:null,groupIds:e.groupIds?[...e.groupIds]:void 0,seed:Math.floor(Math.random()*2147483647)};H("elements",o=>[...o,i]),H("selection",[n])},st=(t,e)=>{const n=b.elements.findIndex(s=>s.id===t);n!==-1&&(Ae(),H("elements",s=>{const i=[...s],o=i.splice(n,1)[0];if(e==="front")i.push(o);else if(e==="back")i.unshift(o);else if(e==="forward"){const a=Math.min(i.length,n+1);i.splice(a,0,o)}else if(e==="backward"){const a=Math.max(0,n-1);i.splice(a,0,o)}return i}))},Ns=()=>{const t=b.theme==="light"?"dark":"light";H("theme",t),localStorage.setItem("theme",t),document.documentElement.setAttribute("data-theme",t)},zs=()=>{if(b.elements.length===0){H("viewState",{scale:1,panX:0,panY:0});return}let t=1/0,e=1/0,n=-1/0,s=-1/0;b.elements.forEach(g=>{t=Math.min(t,g.x),n=Math.max(n,g.x+g.width),e=Math.min(e,g.y),s=Math.max(s,g.y+g.height)});const i=n-t,o=s-e;if(i===0&&o===0){const g=t,x=e,P=window.innerWidth/2,A=window.innerHeight/2;H("viewState",{scale:1,panX:-g+P,panY:-x+A});return}const a=50,l=window.innerWidth,r=window.innerHeight,h=(l-a*2)/i,c=(r-a*2)/o;let u=Math.min(h,c);u=Math.min(Math.max(u,.1),2);const f=t+i/2,p=e+o/2,m=l/2,k=r/2;H("viewState",{scale:u,panX:-f*u+m,panY:-p*u+k})};document.documentElement.setAttribute("data-theme",An.theme);function Wt(t,e,n){if(t&&t.length){const[s,i]=e,o=Math.PI/180*n,a=Math.cos(o),l=Math.sin(o);for(const r of t){const[h,c]=r;r[0]=(h-s)*a-(c-i)*l+s,r[1]=(h-s)*l+(c-i)*a+i}}}function Ls(t,e,n){const s=[];t.forEach(i=>s.push(...i)),Wt(s,e,n)}function Is(t,e){return t[0]===e[0]&&t[1]===e[1]}function Ds(t,e,n,s=1){const i=n,o=Math.max(e,.1),a=t[0]&&t[0][0]&&typeof t[0][0]=="number"?[t]:t,l=[0,0];if(i)for(const h of a)Wt(h,l,i);const r=Rs(a,o,s);if(i){for(const h of a)Wt(h,l,-i);Ls(r,l,-i)}return r}function Rs(t,e,n){const s=[];for(const h of t){const c=[...h];Is(c[0],c[c.length-1])||c.push([c[0][0],c[0][1]]),c.length>2&&s.push(c)}const i=[];e=Math.max(e,.1);const o=[];for(const h of s)for(let c=0;c<h.length-1;c++){const u=h[c],f=h[c+1];if(u[1]!==f[1]){const p=Math.min(u[1],f[1]);o.push({ymin:p,ymax:Math.max(u[1],f[1]),x:p===u[1]?u[0]:f[0],islope:(f[0]-u[0])/(f[1]-u[1])})}}if(o.sort((h,c)=>h.ymin<c.ymin?-1:h.ymin>c.ymin?1:h.x<c.x?-1:h.x>c.x?1:h.ymax===c.ymax?0:(h.ymax-c.ymax)/Math.abs(h.ymax-c.ymax)),!o.length)return i;let a=[],l=o[0].ymin,r=0;for(;a.length||o.length;){if(o.length){let h=-1;for(let u=0;u<o.length&&!(o[u].ymin>l);u++)h=u;o.splice(0,h+1).forEach(u=>{a.push({s:l,edge:u})})}if(a=a.filter(h=>!(h.edge.ymax<=l)),a.sort((h,c)=>h.edge.x===c.edge.x?0:(h.edge.x-c.edge.x)/Math.abs(h.edge.x-c.edge.x)),(n!==1||r%e===0)&&a.length>1)for(let h=0;h<a.length;h=h+2){const c=h+1;if(c>=a.length)break;const u=a[h].edge,f=a[c].edge;i.push([[Math.round(u.x),l],[Math.round(f.x),l]])}l+=n,a.forEach(h=>{h.edge.x=h.edge.x+n*h.edge.islope}),r++}return i}function Qe(t,e){var n;const s=e.hachureAngle+90;let i=e.hachureGap;i<0&&(i=e.strokeWidth*4),i=Math.round(Math.max(i,.1));let o=1;return e.roughness>=1&&(((n=e.randomizer)===null||n===void 0?void 0:n.next())||Math.random())>.7&&(o=i),Ds(t,i,s,o||1)}class Gt{constructor(e){this.helper=e}fillPolygons(e,n){return this._fillPolygons(e,n)}_fillPolygons(e,n){const s=Qe(e,n);return{type:"fillSketch",ops:this.renderLines(s,n)}}renderLines(e,n){const s=[];for(const i of e)s.push(...this.helper.doubleLineOps(i[0][0],i[0][1],i[1][0],i[1][1],n));return s}}function Ct(t){const e=t[0],n=t[1];return Math.sqrt(Math.pow(e[0]-n[0],2)+Math.pow(e[1]-n[1],2))}class js extends Gt{fillPolygons(e,n){let s=n.hachureGap;s<0&&(s=n.strokeWidth*4),s=Math.max(s,.1);const i=Object.assign({},n,{hachureGap:s}),o=Qe(e,i),a=Math.PI/180*n.hachureAngle,l=[],r=s*.5*Math.cos(a),h=s*.5*Math.sin(a);for(const[u,f]of o)Ct([u,f])&&l.push([[u[0]-r,u[1]+h],[...f]],[[u[0]+r,u[1]-h],[...f]]);return{type:"fillSketch",ops:this.renderLines(l,n)}}}class Fs extends Gt{fillPolygons(e,n){const s=this._fillPolygons(e,n),i=Object.assign({},n,{hachureAngle:n.hachureAngle+90}),o=this._fillPolygons(e,i);return s.ops=s.ops.concat(o.ops),s}}class Xs{constructor(e){this.helper=e}fillPolygons(e,n){n=Object.assign({},n,{hachureAngle:0});const s=Qe(e,n);return this.dotsOnLines(s,n)}dotsOnLines(e,n){const s=[];let i=n.hachureGap;i<0&&(i=n.strokeWidth*4),i=Math.max(i,.1);let o=n.fillWeight;o<0&&(o=n.strokeWidth/2);const a=i/4;for(const l of e){const r=Ct(l),h=r/i,c=Math.ceil(h)-1,u=r-c*i,f=(l[0][0]+l[1][0])/2-i/4,p=Math.min(l[0][1],l[1][1]);for(let m=0;m<c;m++){const k=p+u+m*i,g=f-a+Math.random()*2*a,x=k-a+Math.random()*2*a,P=this.helper.ellipse(g,x,o,o,n);s.push(...P.ops)}}return{type:"fillSketch",ops:s}}}class Ws{constructor(e){this.helper=e}fillPolygons(e,n){const s=Qe(e,n);return{type:"fillSketch",ops:this.dashedLine(s,n)}}dashedLine(e,n){const s=n.dashOffset<0?n.hachureGap<0?n.strokeWidth*4:n.hachureGap:n.dashOffset,i=n.dashGap<0?n.hachureGap<0?n.strokeWidth*4:n.hachureGap:n.dashGap,o=[];return e.forEach(a=>{const l=Ct(a),r=Math.floor(l/(s+i)),h=(l+i-r*(s+i))/2;let c=a[0],u=a[1];c[0]>u[0]&&(c=a[1],u=a[0]);const f=Math.atan((u[1]-c[1])/(u[0]-c[0]));for(let p=0;p<r;p++){const m=p*(s+i),k=m+s,g=[c[0]+m*Math.cos(f)+h*Math.cos(f),c[1]+m*Math.sin(f)+h*Math.sin(f)],x=[c[0]+k*Math.cos(f)+h*Math.cos(f),c[1]+k*Math.sin(f)+h*Math.sin(f)];o.push(...this.helper.doubleLineOps(g[0],g[1],x[0],x[1],n))}}),o}}class Ys{constructor(e){this.helper=e}fillPolygons(e,n){const s=n.hachureGap<0?n.strokeWidth*4:n.hachureGap,i=n.zigzagOffset<0?s:n.zigzagOffset;n=Object.assign({},n,{hachureGap:s+i});const o=Qe(e,n);return{type:"fillSketch",ops:this.zigzagLines(o,i,n)}}zigzagLines(e,n,s){const i=[];return e.forEach(o=>{const a=Ct(o),l=Math.round(a/(2*n));let r=o[0],h=o[1];r[0]>h[0]&&(r=o[1],h=o[0]);const c=Math.atan((h[1]-r[1])/(h[0]-r[0]));for(let u=0;u<l;u++){const f=u*2*n,p=(u+1)*2*n,m=Math.sqrt(2*Math.pow(n,2)),k=[r[0]+f*Math.cos(c),r[1]+f*Math.sin(c)],g=[r[0]+p*Math.cos(c),r[1]+p*Math.sin(c)],x=[k[0]+m*Math.cos(c+Math.PI/4),k[1]+m*Math.sin(c+Math.PI/4)];i.push(...this.helper.doubleLineOps(k[0],k[1],x[0],x[1],s),...this.helper.doubleLineOps(x[0],x[1],g[0],g[1],s))}}),i}}const ae={};function Vs(t,e){let n=t.fillStyle||"hachure";if(!ae[n])switch(n){case"zigzag":ae[n]||(ae[n]=new js(e));break;case"cross-hatch":ae[n]||(ae[n]=new Fs(e));break;case"dots":ae[n]||(ae[n]=new Xs(e));break;case"dashed":ae[n]||(ae[n]=new Ws(e));break;case"zigzag-line":ae[n]||(ae[n]=new Ys(e));break;default:n="hachure",ae[n]||(ae[n]=new Gt(e));break}return ae[n]}function Hs(){return Math.floor(Math.random()*2**31)}class Us{constructor(e){this.seed=e}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}}const qs=0,Yt=1,Tn=2,it={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function Bs(t){const e=new Array;for(;t!=="";)if(t.match(/^([ \t\r\n,]+)/))t=t.substr(RegExp.$1.length);else if(t.match(/^([aAcChHlLmMqQsStTvVzZ])/))e[e.length]={type:qs,text:RegExp.$1},t=t.substr(RegExp.$1.length);else if(t.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))e[e.length]={type:Yt,text:`${parseFloat(RegExp.$1)}`},t=t.substr(RegExp.$1.length);else return[];return e[e.length]={type:Tn,text:""},e}function Et(t,e){return t.type===e}function Kt(t){const e=[],n=Bs(t);let s="BOD",i=0,o=n[i];for(;!Et(o,Tn);){let a=0;const l=[];if(s==="BOD")if(o.text==="M"||o.text==="m")i++,a=it[o.text],s=o.text;else return Kt("M0,0"+t);else Et(o,Yt)?a=it[s]:(i++,a=it[o.text],s=o.text);if(i+a<n.length){for(let r=i;r<i+a;r++){const h=n[r];if(Et(h,Yt))l[l.length]=+h.text;else throw new Error("Param not a number: "+s+","+h.text)}if(typeof it[s]=="number"){const r={key:s,data:l};e.push(r),i+=a,o=n[i],s==="M"&&(s="L"),s==="m"&&(s="l")}else throw new Error("Bad segment: "+s)}else throw new Error("Path data ended short")}return e}function En(t){let e=0,n=0,s=0,i=0;const o=[];for(const{key:a,data:l}of t)switch(a){case"M":o.push({key:"M",data:[...l]}),[e,n]=l,[s,i]=l;break;case"m":e+=l[0],n+=l[1],o.push({key:"M",data:[e,n]}),s=e,i=n;break;case"L":o.push({key:"L",data:[...l]}),[e,n]=l;break;case"l":e+=l[0],n+=l[1],o.push({key:"L",data:[e,n]});break;case"C":o.push({key:"C",data:[...l]}),e=l[4],n=l[5];break;case"c":{const r=l.map((h,c)=>c%2?h+n:h+e);o.push({key:"C",data:r}),e=r[4],n=r[5];break}case"Q":o.push({key:"Q",data:[...l]}),e=l[2],n=l[3];break;case"q":{const r=l.map((h,c)=>c%2?h+n:h+e);o.push({key:"Q",data:r}),e=r[2],n=r[3];break}case"A":o.push({key:"A",data:[...l]}),e=l[5],n=l[6];break;case"a":e+=l[5],n+=l[6],o.push({key:"A",data:[l[0],l[1],l[2],l[3],l[4],e,n]});break;case"H":o.push({key:"H",data:[...l]}),e=l[0];break;case"h":e+=l[0],o.push({key:"H",data:[e]});break;case"V":o.push({key:"V",data:[...l]}),n=l[0];break;case"v":n+=l[0],o.push({key:"V",data:[n]});break;case"S":o.push({key:"S",data:[...l]}),e=l[2],n=l[3];break;case"s":{const r=l.map((h,c)=>c%2?h+n:h+e);o.push({key:"S",data:r}),e=r[2],n=r[3];break}case"T":o.push({key:"T",data:[...l]}),e=l[0],n=l[1];break;case"t":e+=l[0],n+=l[1],o.push({key:"T",data:[e,n]});break;case"Z":case"z":o.push({key:"Z",data:[]}),e=s,n=i;break}return o}function Nn(t){const e=[];let n="",s=0,i=0,o=0,a=0,l=0,r=0;for(const{key:h,data:c}of t){switch(h){case"M":e.push({key:"M",data:[...c]}),[s,i]=c,[o,a]=c;break;case"C":e.push({key:"C",data:[...c]}),s=c[4],i=c[5],l=c[2],r=c[3];break;case"L":e.push({key:"L",data:[...c]}),[s,i]=c;break;case"H":s=c[0],e.push({key:"L",data:[s,i]});break;case"V":i=c[0],e.push({key:"L",data:[s,i]});break;case"S":{let u=0,f=0;n==="C"||n==="S"?(u=s+(s-l),f=i+(i-r)):(u=s,f=i),e.push({key:"C",data:[u,f,...c]}),l=c[0],r=c[1],s=c[2],i=c[3];break}case"T":{const[u,f]=c;let p=0,m=0;n==="Q"||n==="T"?(p=s+(s-l),m=i+(i-r)):(p=s,m=i);const k=s+2*(p-s)/3,g=i+2*(m-i)/3,x=u+2*(p-u)/3,P=f+2*(m-f)/3;e.push({key:"C",data:[k,g,x,P,u,f]}),l=p,r=m,s=u,i=f;break}case"Q":{const[u,f,p,m]=c,k=s+2*(u-s)/3,g=i+2*(f-i)/3,x=p+2*(u-p)/3,P=m+2*(f-m)/3;e.push({key:"C",data:[k,g,x,P,p,m]}),l=u,r=f,s=p,i=m;break}case"A":{const u=Math.abs(c[0]),f=Math.abs(c[1]),p=c[2],m=c[3],k=c[4],g=c[5],x=c[6];u===0||f===0?(e.push({key:"C",data:[s,i,g,x,g,x]}),s=g,i=x):(s!==g||i!==x)&&(zn(s,i,g,x,u,f,p,m,k).forEach(function(A){e.push({key:"C",data:A})}),s=g,i=x);break}case"Z":e.push({key:"Z",data:[]}),s=o,i=a;break}n=h}return e}function Gs(t){return Math.PI*t/180}function Ye(t,e,n){const s=t*Math.cos(n)-e*Math.sin(n),i=t*Math.sin(n)+e*Math.cos(n);return[s,i]}function zn(t,e,n,s,i,o,a,l,r,h){const c=Gs(a);let u=[],f=0,p=0,m=0,k=0;if(h)[f,p,m,k]=h;else{[t,e]=Ye(t,e,-c),[n,s]=Ye(n,s,-c);const Z=(t-n)/2,U=(e-s)/2;let Y=Z*Z/(i*i)+U*U/(o*o);Y>1&&(Y=Math.sqrt(Y),i=Y*i,o=Y*o);const se=l===r?-1:1,ie=i*i,le=o*o,Fe=ie*le-ie*U*U-le*Z*Z,Xe=ie*U*U+le*Z*Z,ye=se*Math.sqrt(Math.abs(Fe/Xe));m=ye*i*U/o+(t+n)/2,k=ye*-o*Z/i+(e+s)/2,f=Math.asin(parseFloat(((e-k)/o).toFixed(9))),p=Math.asin(parseFloat(((s-k)/o).toFixed(9))),t<m&&(f=Math.PI-f),n<m&&(p=Math.PI-p),f<0&&(f=Math.PI*2+f),p<0&&(p=Math.PI*2+p),r&&f>p&&(f=f-Math.PI*2),!r&&p>f&&(p=p-Math.PI*2)}let g=p-f;if(Math.abs(g)>Math.PI*120/180){const Z=p,U=n,Y=s;r&&p>f?p=f+Math.PI*120/180*1:p=f+Math.PI*120/180*-1,n=m+i*Math.cos(p),s=k+o*Math.sin(p),u=zn(n,s,U,Y,i,o,a,0,r,[p,Z,m,k])}g=p-f;const x=Math.cos(f),P=Math.sin(f),A=Math.cos(p),O=Math.sin(p),z=Math.tan(g/4),L=4/3*i*z,W=4/3*o*z,D=[t,e],V=[t+L*P,e-W*x],J=[n+L*O,s-W*A],Q=[n,s];if(V[0]=2*D[0]-V[0],V[1]=2*D[1]-V[1],h)return[V,J,Q].concat(u);{u=[V,J,Q].concat(u);const Z=[];for(let U=0;U<u.length;U+=3){const Y=Ye(u[U][0],u[U][1],c),se=Ye(u[U+1][0],u[U+1][1],c),ie=Ye(u[U+2][0],u[U+2][1],c);Z.push([Y[0],Y[1],se[0],se[1],ie[0],ie[1]])}return Z}}const Ks={randOffset:ti,randOffsetWithRange:ni,ellipse:Qs,doubleLineOps:si};function Ln(t,e,n,s,i){return{type:"path",ops:$e(t,e,n,s,i)}}function ct(t,e,n){const s=(t||[]).length;if(s>2){const i=[];for(let o=0;o<s-1;o++)i.push(...$e(t[o][0],t[o][1],t[o+1][0],t[o+1][1],n));return e&&i.push(...$e(t[s-1][0],t[s-1][1],t[0][0],t[0][1],n)),{type:"path",ops:i}}else if(s===2)return Ln(t[0][0],t[0][1],t[1][0],t[1][1],n);return{type:"path",ops:[]}}function Zs(t,e){return ct(t,!0,e)}function Js(t,e,n,s,i){const o=[[t,e],[t+n,e],[t+n,e+s],[t,e+s]];return Zs(o,i)}function an(t,e){if(t.length){const s=typeof t[0][0]=="number"?[t]:t,i=ot(s[0],1*(1+e.roughness*.2),e),o=e.disableMultiStroke?[]:ot(s[0],1.5*(1+e.roughness*.22),hn(e));for(let a=1;a<s.length;a++){const l=s[a];if(l.length){const r=ot(l,1*(1+e.roughness*.2),e),h=e.disableMultiStroke?[]:ot(l,1.5*(1+e.roughness*.22),hn(e));for(const c of r)c.op!=="move"&&i.push(c);for(const c of h)c.op!=="move"&&o.push(c)}}return{type:"path",ops:i.concat(o)}}return{type:"path",ops:[]}}function Qs(t,e,n,s,i){const o=In(n,s,i);return Vt(t,e,i,o).opset}function In(t,e,n){const s=Math.sqrt(Math.PI*2*Math.sqrt((Math.pow(t/2,2)+Math.pow(e/2,2))/2)),i=Math.ceil(Math.max(n.curveStepCount,n.curveStepCount/Math.sqrt(200)*s)),o=Math.PI*2/i;let a=Math.abs(t/2),l=Math.abs(e/2);const r=1-n.curveFitting;return a+=N(a*r,n),l+=N(l*r,n),{increment:o,rx:a,ry:l}}function Vt(t,e,n,s){const[i,o]=un(s.increment,t,e,s.rx,s.ry,1,s.increment*bt(.1,bt(.4,1,n),n),n);let a=wt(i,null,n);if(!n.disableMultiStroke&&n.roughness!==0){const[l]=un(s.increment,t,e,s.rx,s.ry,1.5,0,n),r=wt(l,null,n);a=a.concat(r)}return{estimatedPoints:o,opset:{type:"path",ops:a}}}function rn(t,e,n,s,i,o,a,l,r){const h=t,c=e;let u=Math.abs(n/2),f=Math.abs(s/2);u+=N(u*.01,r),f+=N(f*.01,r);let p=i,m=o;for(;p<0;)p+=Math.PI*2,m+=Math.PI*2;m-p>Math.PI*2&&(p=0,m=Math.PI*2);const k=Math.PI*2/r.curveStepCount,g=Math.min(k/2,(m-p)/2),x=fn(g,h,c,u,f,p,m,1,r);if(!r.disableMultiStroke){const P=fn(g,h,c,u,f,p,m,1.5,r);x.push(...P)}return a&&(l?x.push(...$e(h,c,h+u*Math.cos(p),c+f*Math.sin(p),r),...$e(h,c,h+u*Math.cos(m),c+f*Math.sin(m),r)):x.push({op:"lineTo",data:[h,c]},{op:"lineTo",data:[h+u*Math.cos(p),c+f*Math.sin(p)]})),{type:"path",ops:x}}function cn(t,e){const n=Nn(En(Kt(t))),s=[];let i=[0,0],o=[0,0];for(const{key:a,data:l}of n)switch(a){case"M":{o=[l[0],l[1]],i=[l[0],l[1]];break}case"L":s.push(...$e(o[0],o[1],l[0],l[1],e)),o=[l[0],l[1]];break;case"C":{const[r,h,c,u,f,p]=l;s.push(...ii(r,h,c,u,f,p,o,e)),o=[f,p];break}case"Z":s.push(...$e(o[0],o[1],i[0],i[1],e)),o=[i[0],i[1]];break}return{type:"path",ops:s}}function Nt(t,e){const n=[];for(const s of t)if(s.length){const i=e.maxRandomnessOffset||0,o=s.length;if(o>2){n.push({op:"move",data:[s[0][0]+N(i,e),s[0][1]+N(i,e)]});for(let a=1;a<o;a++)n.push({op:"lineTo",data:[s[a][0]+N(i,e),s[a][1]+N(i,e)]})}}return{type:"fillPath",ops:n}}function ze(t,e){return Vs(e,Ks).fillPolygons(t,e)}function ei(t,e,n,s,i,o,a){const l=t,r=e;let h=Math.abs(n/2),c=Math.abs(s/2);h+=N(h*.01,a),c+=N(c*.01,a);let u=i,f=o;for(;u<0;)u+=Math.PI*2,f+=Math.PI*2;f-u>Math.PI*2&&(u=0,f=Math.PI*2);const p=(f-u)/a.curveStepCount,m=[];for(let k=u;k<=f;k=k+p)m.push([l+h*Math.cos(k),r+c*Math.sin(k)]);return m.push([l+h*Math.cos(f),r+c*Math.sin(f)]),m.push([l,r]),ze([m],a)}function ti(t,e){return N(t,e)}function ni(t,e,n){return bt(t,e,n)}function si(t,e,n,s,i){return $e(t,e,n,s,i,!0)}function hn(t){const e=Object.assign({},t);return e.randomizer=void 0,t.seed&&(e.seed=t.seed+1),e}function Dn(t){return t.randomizer||(t.randomizer=new Us(t.seed||0)),t.randomizer.next()}function bt(t,e,n,s=1){return n.roughness*s*(Dn(n)*(e-t)+t)}function N(t,e,n=1){return bt(-t,t,e,n)}function $e(t,e,n,s,i,o=!1){const a=o?i.disableMultiStrokeFill:i.disableMultiStroke,l=Ht(t,e,n,s,i,!0,!1);if(a)return l;const r=Ht(t,e,n,s,i,!0,!0);return l.concat(r)}function Ht(t,e,n,s,i,o,a){const l=Math.pow(t-n,2)+Math.pow(e-s,2),r=Math.sqrt(l);let h=1;r<200?h=1:r>500?h=.4:h=-.0016668*r+1.233334;let c=i.maxRandomnessOffset||0;c*c*100>l&&(c=r/10);const u=c/2,f=.2+Dn(i)*.2;let p=i.bowing*i.maxRandomnessOffset*(s-e)/200,m=i.bowing*i.maxRandomnessOffset*(t-n)/200;p=N(p,i,h),m=N(m,i,h);const k=[],g=()=>N(u,i,h),x=()=>N(c,i,h),P=i.preserveVertices;return a?k.push({op:"move",data:[t+(P?0:g()),e+(P?0:g())]}):k.push({op:"move",data:[t+(P?0:N(c,i,h)),e+(P?0:N(c,i,h))]}),a?k.push({op:"bcurveTo",data:[p+t+(n-t)*f+g(),m+e+(s-e)*f+g(),p+t+2*(n-t)*f+g(),m+e+2*(s-e)*f+g(),n+(P?0:g()),s+(P?0:g())]}):k.push({op:"bcurveTo",data:[p+t+(n-t)*f+x(),m+e+(s-e)*f+x(),p+t+2*(n-t)*f+x(),m+e+2*(s-e)*f+x(),n+(P?0:x()),s+(P?0:x())]}),k}function ot(t,e,n){if(!t.length)return[];const s=[];s.push([t[0][0]+N(e,n),t[0][1]+N(e,n)]),s.push([t[0][0]+N(e,n),t[0][1]+N(e,n)]);for(let i=1;i<t.length;i++)s.push([t[i][0]+N(e,n),t[i][1]+N(e,n)]),i===t.length-1&&s.push([t[i][0]+N(e,n),t[i][1]+N(e,n)]);return wt(s,null,n)}function wt(t,e,n){const s=t.length,i=[];if(s>3){const o=[],a=1-n.curveTightness;i.push({op:"move",data:[t[1][0],t[1][1]]});for(let l=1;l+2<s;l++){const r=t[l];o[0]=[r[0],r[1]],o[1]=[r[0]+(a*t[l+1][0]-a*t[l-1][0])/6,r[1]+(a*t[l+1][1]-a*t[l-1][1])/6],o[2]=[t[l+1][0]+(a*t[l][0]-a*t[l+2][0])/6,t[l+1][1]+(a*t[l][1]-a*t[l+2][1])/6],o[3]=[t[l+1][0],t[l+1][1]],i.push({op:"bcurveTo",data:[o[1][0],o[1][1],o[2][0],o[2][1],o[3][0],o[3][1]]})}}else s===3?(i.push({op:"move",data:[t[1][0],t[1][1]]}),i.push({op:"bcurveTo",data:[t[1][0],t[1][1],t[2][0],t[2][1],t[2][0],t[2][1]]})):s===2&&i.push(...Ht(t[0][0],t[0][1],t[1][0],t[1][1],n,!0,!0));return i}function un(t,e,n,s,i,o,a,l){const r=l.roughness===0,h=[],c=[];if(r){t=t/4,c.push([e+s*Math.cos(-t),n+i*Math.sin(-t)]);for(let u=0;u<=Math.PI*2;u=u+t){const f=[e+s*Math.cos(u),n+i*Math.sin(u)];h.push(f),c.push(f)}c.push([e+s*Math.cos(0),n+i*Math.sin(0)]),c.push([e+s*Math.cos(t),n+i*Math.sin(t)])}else{const u=N(.5,l)-Math.PI/2;c.push([N(o,l)+e+.9*s*Math.cos(u-t),N(o,l)+n+.9*i*Math.sin(u-t)]);const f=Math.PI*2+u-.01;for(let p=u;p<f;p=p+t){const m=[N(o,l)+e+s*Math.cos(p),N(o,l)+n+i*Math.sin(p)];h.push(m),c.push(m)}c.push([N(o,l)+e+s*Math.cos(u+Math.PI*2+a*.5),N(o,l)+n+i*Math.sin(u+Math.PI*2+a*.5)]),c.push([N(o,l)+e+.98*s*Math.cos(u+a),N(o,l)+n+.98*i*Math.sin(u+a)]),c.push([N(o,l)+e+.9*s*Math.cos(u+a*.5),N(o,l)+n+.9*i*Math.sin(u+a*.5)])}return[c,h]}function fn(t,e,n,s,i,o,a,l,r){const h=o+N(.1,r),c=[];c.push([N(l,r)+e+.9*s*Math.cos(h-t),N(l,r)+n+.9*i*Math.sin(h-t)]);for(let u=h;u<=a;u=u+t)c.push([N(l,r)+e+s*Math.cos(u),N(l,r)+n+i*Math.sin(u)]);return c.push([e+s*Math.cos(a),n+i*Math.sin(a)]),c.push([e+s*Math.cos(a),n+i*Math.sin(a)]),wt(c,null,r)}function ii(t,e,n,s,i,o,a,l){const r=[],h=[l.maxRandomnessOffset||1,(l.maxRandomnessOffset||1)+.3];let c=[0,0];const u=l.disableMultiStroke?1:2,f=l.preserveVertices;for(let p=0;p<u;p++)p===0?r.push({op:"move",data:[a[0],a[1]]}):r.push({op:"move",data:[a[0]+(f?0:N(h[0],l)),a[1]+(f?0:N(h[0],l))]}),c=f?[i,o]:[i+N(h[p],l),o+N(h[p],l)],r.push({op:"bcurveTo",data:[t+N(h[p],l),e+N(h[p],l),n+N(h[p],l),s+N(h[p],l),c[0],c[1]]});return r}function Ve(t){return[...t]}function dn(t,e=0){const n=t.length;if(n<3)throw new Error("A curve must have at least three points.");const s=[];if(n===3)s.push(Ve(t[0]),Ve(t[1]),Ve(t[2]),Ve(t[2]));else{const i=[];i.push(t[0],t[0]);for(let l=1;l<t.length;l++)i.push(t[l]),l===t.length-1&&i.push(t[l]);const o=[],a=1-e;s.push(Ve(i[0]));for(let l=1;l+2<i.length;l++){const r=i[l];o[0]=[r[0],r[1]],o[1]=[r[0]+(a*i[l+1][0]-a*i[l-1][0])/6,r[1]+(a*i[l+1][1]-a*i[l-1][1])/6],o[2]=[i[l+1][0]+(a*i[l][0]-a*i[l+2][0])/6,i[l+1][1]+(a*i[l][1]-a*i[l+2][1])/6],o[3]=[i[l+1][0],i[l+1][1]],s.push(o[1],o[2],o[3])}}return s}function oi(t,e){return Math.sqrt(ht(t,e))}function ht(t,e){return Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)}function li(t,e,n){const s=ht(e,n);if(s===0)return ht(t,e);let i=((t[0]-e[0])*(n[0]-e[0])+(t[1]-e[1])*(n[1]-e[1]))/s;return i=Math.max(0,Math.min(1,i)),ht(t,_e(e,n,i))}function _e(t,e,n){return[t[0]+(e[0]-t[0])*n,t[1]+(e[1]-t[1])*n]}function ai(t,e){const n=t[e+0],s=t[e+1],i=t[e+2],o=t[e+3];let a=3*s[0]-2*n[0]-o[0];a*=a;let l=3*s[1]-2*n[1]-o[1];l*=l;let r=3*i[0]-2*o[0]-n[0];r*=r;let h=3*i[1]-2*o[1]-n[1];return h*=h,a<r&&(a=r),l<h&&(l=h),a+l}function Ut(t,e,n,s){const i=s||[];if(ai(t,e)<n){const o=t[e+0];i.length?oi(i[i.length-1],o)>1&&i.push(o):i.push(o),i.push(t[e+3])}else{const a=t[e+0],l=t[e+1],r=t[e+2],h=t[e+3],c=_e(a,l,.5),u=_e(l,r,.5),f=_e(r,h,.5),p=_e(c,u,.5),m=_e(u,f,.5),k=_e(p,m,.5);Ut([a,c,p,k],0,n,i),Ut([k,m,f,h],0,n,i)}return i}function ri(t,e){return vt(t,0,t.length,e)}function vt(t,e,n,s,i){const o=i||[],a=t[e],l=t[n-1];let r=0,h=1;for(let c=e+1;c<n-1;++c){const u=li(t[c],a,l);u>r&&(r=u,h=c)}return Math.sqrt(r)>s?(vt(t,e,h+1,s,o),vt(t,h,n,s,o)):(o.length||o.push(a),o.push(l)),o}function qt(t,e=.15,n){const s=[],i=(t.length-1)/3;for(let o=0;o<i;o++){const a=o*3;Ut(t,a,e,s)}return n&&n>0?vt(s,0,s.length,n):s}function ci(t,e,n){const s=Kt(t),i=Nn(En(s)),o=[];let a=[],l=[0,0],r=[];const h=()=>{r.length>=4&&a.push(...qt(r,e)),r=[]},c=()=>{h(),a.length&&(o.push(a),a=[])};for(const{key:f,data:p}of i)switch(f){case"M":c(),l=[p[0],p[1]],a.push(l);break;case"L":h(),a.push([p[0],p[1]]);break;case"C":if(!r.length){const m=a.length?a[a.length-1]:l;r.push([m[0],m[1]])}r.push([p[0],p[1]]),r.push([p[2],p[3]]),r.push([p[4],p[5]]);break;case"Z":h(),a.push([l[0],l[1]]);break}if(c(),!n)return o;const u=[];for(const f of o){const p=ri(f,n);p.length&&u.push(p)}return u}const re="none";class kt{constructor(e){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=e||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Hs()}_o(e){return e?Object.assign({},this.defaultOptions,e):this.defaultOptions}_d(e,n,s){return{shape:e,sets:n||[],options:s||this.defaultOptions}}line(e,n,s,i,o){const a=this._o(o);return this._d("line",[Ln(e,n,s,i,a)],a)}rectangle(e,n,s,i,o){const a=this._o(o),l=[],r=Js(e,n,s,i,a);if(a.fill){const h=[[e,n],[e+s,n],[e+s,n+i],[e,n+i]];a.fillStyle==="solid"?l.push(Nt([h],a)):l.push(ze([h],a))}return a.stroke!==re&&l.push(r),this._d("rectangle",l,a)}ellipse(e,n,s,i,o){const a=this._o(o),l=[],r=In(s,i,a),h=Vt(e,n,a,r);if(a.fill)if(a.fillStyle==="solid"){const c=Vt(e,n,a,r).opset;c.type="fillPath",l.push(c)}else l.push(ze([h.estimatedPoints],a));return a.stroke!==re&&l.push(h.opset),this._d("ellipse",l,a)}circle(e,n,s,i){const o=this.ellipse(e,n,s,s,i);return o.shape="circle",o}linearPath(e,n){const s=this._o(n);return this._d("linearPath",[ct(e,!1,s)],s)}arc(e,n,s,i,o,a,l=!1,r){const h=this._o(r),c=[],u=rn(e,n,s,i,o,a,l,!0,h);if(l&&h.fill)if(h.fillStyle==="solid"){const f=Object.assign({},h);f.disableMultiStroke=!0;const p=rn(e,n,s,i,o,a,!0,!1,f);p.type="fillPath",c.push(p)}else c.push(ei(e,n,s,i,o,a,h));return h.stroke!==re&&c.push(u),this._d("arc",c,h)}curve(e,n){const s=this._o(n),i=[],o=an(e,s);if(s.fill&&s.fill!==re)if(s.fillStyle==="solid"){const a=an(e,Object.assign(Object.assign({},s),{disableMultiStroke:!0,roughness:s.roughness?s.roughness+s.fillShapeRoughnessGain:0}));i.push({type:"fillPath",ops:this._mergedShape(a.ops)})}else{const a=[],l=e;if(l.length){const h=typeof l[0][0]=="number"?[l]:l;for(const c of h)c.length<3?a.push(...c):c.length===3?a.push(...qt(dn([c[0],c[0],c[1],c[2]]),10,(1+s.roughness)/2)):a.push(...qt(dn(c),10,(1+s.roughness)/2))}a.length&&i.push(ze([a],s))}return s.stroke!==re&&i.push(o),this._d("curve",i,s)}polygon(e,n){const s=this._o(n),i=[],o=ct(e,!0,s);return s.fill&&(s.fillStyle==="solid"?i.push(Nt([e],s)):i.push(ze([e],s))),s.stroke!==re&&i.push(o),this._d("polygon",i,s)}path(e,n){const s=this._o(n),i=[];if(!e)return this._d("path",i,s);e=(e||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");const o=s.fill&&s.fill!=="transparent"&&s.fill!==re,a=s.stroke!==re,l=!!(s.simplification&&s.simplification<1),r=l?4-4*(s.simplification||1):(1+s.roughness)/2,h=ci(e,1,r),c=cn(e,s);if(o)if(s.fillStyle==="solid")if(h.length===1){const u=cn(e,Object.assign(Object.assign({},s),{disableMultiStroke:!0,roughness:s.roughness?s.roughness+s.fillShapeRoughnessGain:0}));i.push({type:"fillPath",ops:this._mergedShape(u.ops)})}else i.push(Nt(h,s));else i.push(ze(h,s));return a&&(l?h.forEach(u=>{i.push(ct(u,!1,s))}):i.push(c)),this._d("path",i,s)}opsToPath(e,n){let s="";for(const i of e.ops){const o=typeof n=="number"&&n>=0?i.data.map(a=>+a.toFixed(n)):i.data;switch(i.op){case"move":s+=`M${o[0]} ${o[1]} `;break;case"bcurveTo":s+=`C${o[0]} ${o[1]}, ${o[2]} ${o[3]}, ${o[4]} ${o[5]} `;break;case"lineTo":s+=`L${o[0]} ${o[1]} `;break}}return s.trim()}toPaths(e){const n=e.sets||[],s=e.options||this.defaultOptions,i=[];for(const o of n){let a=null;switch(o.type){case"path":a={d:this.opsToPath(o),stroke:s.stroke,strokeWidth:s.strokeWidth,fill:re};break;case"fillPath":a={d:this.opsToPath(o),stroke:re,strokeWidth:0,fill:s.fill||re};break;case"fillSketch":a=this.fillSketch(o,s);break}a&&i.push(a)}return i}fillSketch(e,n){let s=n.fillWeight;return s<0&&(s=n.strokeWidth/2),{d:this.opsToPath(e),stroke:n.fill||re,strokeWidth:s,fill:re}}_mergedShape(e){return e.filter((n,s)=>s===0?!0:n.op!=="move")}}class hi{constructor(e,n){this.canvas=e,this.ctx=this.canvas.getContext("2d"),this.gen=new kt(n)}draw(e){const n=e.sets||[],s=e.options||this.getDefaultOptions(),i=this.ctx,o=e.options.fixedDecimalPlaceDigits;for(const a of n)switch(a.type){case"path":i.save(),i.strokeStyle=s.stroke==="none"?"transparent":s.stroke,i.lineWidth=s.strokeWidth,s.strokeLineDash&&i.setLineDash(s.strokeLineDash),s.strokeLineDashOffset&&(i.lineDashOffset=s.strokeLineDashOffset),this._drawToContext(i,a,o),i.restore();break;case"fillPath":{i.save(),i.fillStyle=s.fill||"";const l=e.shape==="curve"||e.shape==="polygon"||e.shape==="path"?"evenodd":"nonzero";this._drawToContext(i,a,o,l),i.restore();break}case"fillSketch":this.fillSketch(i,a,s);break}}fillSketch(e,n,s){let i=s.fillWeight;i<0&&(i=s.strokeWidth/2),e.save(),s.fillLineDash&&e.setLineDash(s.fillLineDash),s.fillLineDashOffset&&(e.lineDashOffset=s.fillLineDashOffset),e.strokeStyle=s.fill||"",e.lineWidth=i,this._drawToContext(e,n,s.fixedDecimalPlaceDigits),e.restore()}_drawToContext(e,n,s,i="nonzero"){e.beginPath();for(const o of n.ops){const a=typeof s=="number"&&s>=0?o.data.map(l=>+l.toFixed(s)):o.data;switch(o.op){case"move":e.moveTo(a[0],a[1]);break;case"bcurveTo":e.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5]);break;case"lineTo":e.lineTo(a[0],a[1]);break}}n.type==="fillPath"?e.fill(i):e.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(e,n,s,i,o){const a=this.gen.line(e,n,s,i,o);return this.draw(a),a}rectangle(e,n,s,i,o){const a=this.gen.rectangle(e,n,s,i,o);return this.draw(a),a}ellipse(e,n,s,i,o){const a=this.gen.ellipse(e,n,s,i,o);return this.draw(a),a}circle(e,n,s,i){const o=this.gen.circle(e,n,s,i);return this.draw(o),o}linearPath(e,n){const s=this.gen.linearPath(e,n);return this.draw(s),s}polygon(e,n){const s=this.gen.polygon(e,n);return this.draw(s),s}arc(e,n,s,i,o,a,l=!1,r){const h=this.gen.arc(e,n,s,i,o,a,l,r);return this.draw(h),h}curve(e,n){const s=this.gen.curve(e,n);return this.draw(s),s}path(e,n){const s=this.gen.path(e,n);return this.draw(s),s}}const lt="http://www.w3.org/2000/svg";class ui{constructor(e,n){this.svg=e,this.gen=new kt(n)}draw(e){const n=e.sets||[],s=e.options||this.getDefaultOptions(),i=this.svg.ownerDocument||window.document,o=i.createElementNS(lt,"g"),a=e.options.fixedDecimalPlaceDigits;for(const l of n){let r=null;switch(l.type){case"path":{r=i.createElementNS(lt,"path"),r.setAttribute("d",this.opsToPath(l,a)),r.setAttribute("stroke",s.stroke),r.setAttribute("stroke-width",s.strokeWidth+""),r.setAttribute("fill","none"),s.strokeLineDash&&r.setAttribute("stroke-dasharray",s.strokeLineDash.join(" ").trim()),s.strokeLineDashOffset&&r.setAttribute("stroke-dashoffset",`${s.strokeLineDashOffset}`);break}case"fillPath":{r=i.createElementNS(lt,"path"),r.setAttribute("d",this.opsToPath(l,a)),r.setAttribute("stroke","none"),r.setAttribute("stroke-width","0"),r.setAttribute("fill",s.fill||""),(e.shape==="curve"||e.shape==="polygon")&&r.setAttribute("fill-rule","evenodd");break}case"fillSketch":{r=this.fillSketch(i,l,s);break}}r&&o.appendChild(r)}return o}fillSketch(e,n,s){let i=s.fillWeight;i<0&&(i=s.strokeWidth/2);const o=e.createElementNS(lt,"path");return o.setAttribute("d",this.opsToPath(n,s.fixedDecimalPlaceDigits)),o.setAttribute("stroke",s.fill||""),o.setAttribute("stroke-width",i+""),o.setAttribute("fill","none"),s.fillLineDash&&o.setAttribute("stroke-dasharray",s.fillLineDash.join(" ").trim()),s.fillLineDashOffset&&o.setAttribute("stroke-dashoffset",`${s.fillLineDashOffset}`),o}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(e,n){return this.gen.opsToPath(e,n)}line(e,n,s,i,o){const a=this.gen.line(e,n,s,i,o);return this.draw(a)}rectangle(e,n,s,i,o){const a=this.gen.rectangle(e,n,s,i,o);return this.draw(a)}ellipse(e,n,s,i,o){const a=this.gen.ellipse(e,n,s,i,o);return this.draw(a)}circle(e,n,s,i){const o=this.gen.circle(e,n,s,i);return this.draw(o)}linearPath(e,n){const s=this.gen.linearPath(e,n);return this.draw(s)}polygon(e,n){const s=this.gen.polygon(e,n);return this.draw(s)}arc(e,n,s,i,o,a,l=!1,r){const h=this.gen.arc(e,n,s,i,o,a,l,r);return this.draw(h)}curve(e,n){const s=this.gen.curve(e,n);return this.draw(s)}path(e,n){const s=this.gen.path(e,n);return this.draw(s)}}const Zt={canvas(t,e){return new hi(t,e)},svg(t,e){return new ui(t,e)},generator(t){return new kt(t)},newSeed(){return kt.newSeed()}},Rn=(t,e,n)=>{const s=t.x,i=t.y,o=e.x,a=e.y,l=n.x,r=n.y,h=s-o,c=i-a,u=l-o,f=r-a,p=h*u+c*f,m=u*u+f*f;let k=-1;m!==0&&(k=p/m);let g,x;k<0?(g=o,x=a):k>1?(g=l,x=r):(g=o+k*u,x=a+k*f);const P=s-g,A=i-x;return Math.sqrt(P*P+A*A)},fi=(t,e,n)=>{if(e.length<2)return!1;for(let s=0;s<e.length-1;s++)if(Rn(t,e[s],e[s+1])<=n)return!0;return!1},di=(t,e,n,s,i)=>{const o=Math.abs(s/2),a=Math.abs(i/2),l=e+s/2,r=n+i/2;return o<=0||a<=0?!1:Math.pow(t.x-l,2)/Math.pow(o,2)+Math.pow(t.y-r,2)/Math.pow(a,2)<=1},zt=new Map,at=new Set,pi=t=>{if(zt.has(t))return zt.get(t);if(!at.has(t)){at.add(t);const e=new Image;e.src=t,e.onload=()=>{zt.set(t,e),at.delete(t)},e.onerror=()=>{at.delete(t)}}return null},jn=(t,e,n)=>{e.save(),e.globalAlpha=(n.opacity??100)/100;const s=n.x+n.width/2,i=n.y+n.height/2;n.angle&&(e.translate(s,i),e.rotate(n.angle),e.translate(-s,-i));const o={seed:n.seed,roughness:n.roughness,stroke:n.strokeColor,strokeWidth:n.strokeWidth,fill:n.backgroundColor==="transparent"?void 0:n.backgroundColor,fillStyle:n.fillStyle,strokeLineDash:n.strokeStyle==="dashed"?[10,10]:n.strokeStyle==="dotted"?[5,10]:void 0};if(n.type==="rectangle")t.rectangle(n.x,n.y,n.width,n.height,o);else if(n.type==="circle")t.ellipse(n.x+n.width/2,n.y+n.height/2,Math.abs(n.width),Math.abs(n.height),o);else if(n.type==="line"||n.type==="arrow"){const a=n.x+n.width,l=n.y+n.height;if(t.line(n.x,n.y,a,l,o),n.type==="arrow"){const r=Math.atan2(n.height,n.width),h=15,c={x:a-h*Math.cos(r-Math.PI/6),y:l-h*Math.sin(r-Math.PI/6)},u={x:a-h*Math.cos(r+Math.PI/6),y:l-h*Math.sin(r+Math.PI/6)};t.line(a,l,c.x,c.y,o),t.line(a,l,u.x,u.y,o)}}else if(n.type==="pencil"&&n.points&&n.points.length>0){const a=n.points.map(l=>[n.x+l.x,n.y+l.y]);t.linearPath(a,o)}else if(n.type==="image"&&n.dataURL){const a=pi(n.dataURL);a?e.drawImage(a,n.x,n.y,n.width,n.height):(e.save(),e.fillStyle="#e5e5e5",e.fillRect(n.x,n.y,n.width,n.height),e.fillStyle="#999",e.font="12px sans-serif",e.fillText("Loading image...",n.x+10,n.y+20),e.restore())}else if(n.type==="text"&&n.text){const a=n.fontSize||20;e.font=`${a}px sans-serif`;const r=e.measureText(n.text).width,h=n.width&&r?n.width/r:1;e.fillStyle=n.strokeColor,h!==1?(e.save(),e.translate(n.x,n.y),e.scale(h,1),e.fillText(n.text,0,a),e.restore()):e.fillText(n.text,n.x,n.y+a)}e.restore()};var gi=R("<canvas style=display:block;touch-action:none>"),yi=R('<div style=position:fixed;bottom:30px;left:50%;transform:translateX(-50%);z-index:100><button style="background-color:white;border:1px solid #e5e7eb;padding:8px 16px;border-radius:9999px;box-shadow:0 4px 6px -1px rgba(0, 0, 0, 0.1);cursor:pointer;color:#3b82f6;font-weight:500;font-size:14px;transition:all 0.2s">Scroll back to content'),mi=R('<textarea style="position:absolute;background:transparent;border:1px dashed #007acc;outline:none;margin:0;padding:0;resize:none;overflow:hidden;min-width:50px;min-height:1em">');const bi=()=>{let t,e=!1,n=null,s=0,i=0;const[o,a]=ne(null),[l,r]=ne("");let h,c=!1,u=!1,f=null;const[p,m]=ne(null);let k=new Map,g=0,x=0,P=0,A=0,O,z=20;const L=()=>{t&&(t.width=window.innerWidth,t.height=window.innerHeight,V())},[W,D]=ne("default"),V=()=>{if(!t)return;const d=t.getContext("2d");if(!d)return;d.setTransform(1,0,0,1,0,0),d.clearRect(0,0,t.width,t.height),d.fillStyle="#fafafa",d.fillRect(0,0,t.width,t.height),d.save();const{scale:w,panX:M,panY:$}=b.viewState;d.translate(M,$),d.scale(w,w),b.elements.forEach(y=>{let E=y.x+y.width/2,C=y.y+y.height/2;if(y.type!=="text"||o()!==y.id){const S=Zt.canvas(t);jn(S,d,y)}if(b.selection.includes(y.id)){d.save(),y.angle&&(d.translate(E,C),d.rotate(y.angle),d.translate(-E,-C)),d.strokeStyle="#3b82f6",d.lineWidth=1/w;const S=2/w;if(d.strokeRect(y.x-S,y.y-S,y.width+S*2,y.height+S*2),b.selection.length===1){const I=8/w;d.fillStyle="#ffffff",d.strokeStyle="#3b82f6",d.lineWidth=2/w,[{x:y.x-S,y:y.y-S},{x:y.x+y.width+S,y:y.y-S},{x:y.x+y.width+S,y:y.y+y.height+S},{x:y.x-S,y:y.y+y.height+S},{x:y.x+y.width/2,y:y.y-S},{x:y.x+y.width+S,y:y.y+y.height/2},{x:y.x+y.width/2,y:y.y+y.height+S},{x:y.x-S,y:y.y+y.height/2}].forEach(q=>{d.fillRect(q.x-I/2,q.y-I/2,I,I),d.strokeRect(q.x-I/2,q.y-I/2,I,I)});const ee={x:y.x+y.width/2,y:y.y-S-20/w};d.beginPath(),d.moveTo(y.x+y.width/2,y.y-S),d.lineTo(ee.x,ee.y),d.stroke(),d.beginPath(),d.arc(ee.x,ee.y,I/2,0,2*Math.PI),d.fill(),d.stroke(),d.stroke(),d.restore()}else d.restore()}});const _=p();_&&(d.save(),d.fillStyle="rgba(59, 130, 246, 0.2)",d.strokeStyle="#3b82f6",d.lineWidth=1/w,d.fillRect(_.x,_.y,_.w,_.h),d.strokeRect(_.x,_.y,_.w,_.h),d.restore())};Ie(()=>{b.elements.length,b.elements.forEach(d=>{d.x,d.y,d.width,d.height,d.points&&d.points.length,d.angle,d.opacity,d.strokeColor,d.backgroundColor,d.fillStyle,d.strokeWidth,d.strokeStyle,d.roughness,d.roundness,d.text,d.fontSize,d.fontFamily,d.textAlign,d.startArrowhead,d.endArrowhead}),b.viewState.scale,b.viewState.panX,b.viewState.panY,b.selection.length,p(),requestAnimationFrame(V)});const J=d=>({x:d.clientX,y:d.clientY}),Q=(d,w)=>{const{scale:M,panX:$,panY:_}=b.viewState;return{x:(d-$)/M,y:(w-_)/M}},Z=d=>{d.preventDefault();const w=d.deltaMode===1?33:d.deltaMode===2?400:1,M=d.deltaX*w,$=d.deltaY*w;if(d.ctrlKey||d.metaKey){const y=1-$*.001,E=Math.min(Math.max(b.viewState.scale*y,.1),10),{x:C,y:S}=J(d),{scale:I,panX:j,panY:ee}=b.viewState,q=(C-j)/I,G=(S-ee)/I,me=C-q*E,de=S-G*E;we({scale:E,panX:me,panY:de})}else d.shiftKey?we({panX:b.viewState.panX-($||M),panY:b.viewState.panY}):we({panX:b.viewState.panX-M,panY:b.viewState.panY-$})},U=(d,w,M,$,_)=>{const y=Math.cos(_),E=Math.sin(_);return{x:y*(d-M)-E*(w-$)+M,y:E*(d-M)+y*(w-$)+$}},Y=(d,w,M,$,_)=>U(d,w,M,$,-_),se=(d,w)=>{const{scale:M}=b.viewState,$=10/M;for(let _=b.elements.length-1;_>=0;_--){const y=b.elements[_];if(!b.selection.includes(y.id))continue;const E=y.x+y.width/2,C=y.y+y.height/2,S=y.angle||0,I=Y(d,w,E,C,S),j=2/M,ee=[{type:"tl",x:y.x-j,y:y.y-j},{type:"tr",x:y.x+y.width+j,y:y.y-j},{type:"br",x:y.x+y.width+j,y:y.y+y.height+j},{type:"bl",x:y.x-j,y:y.y+y.height+j},{type:"tm",x:y.x+y.width/2,y:y.y-j},{type:"rm",x:y.x+y.width+j,y:y.y+y.height/2},{type:"bm",x:y.x+y.width/2,y:y.y+y.height+j},{type:"lm",x:y.x-j,y:y.y+y.height/2}];for(const G of ee)if(Math.abs(I.x-G.x)<=$/2&&Math.abs(I.y-G.y)<=$/2)return{id:y.id,handle:G.type};const q={x:y.x+y.width/2,y:y.y-j-20/M};if(Math.abs(I.x-q.x)<=$&&Math.abs(I.y-q.y)<=$/2)return{id:y.id,handle:"rotate"}}return null},ie=d=>{if(!d.points||d.points.length===0)return null;let w=1/0,M=1/0,$=-1/0,_=-1/0;d.points.forEach(S=>{w=Math.min(w,S.x),M=Math.min(M,S.y),$=Math.max($,S.x),_=Math.max(_,S.y)});const y=$-w,E=_-M,C=d.points.map(S=>({x:S.x-w,y:S.y-M}));return{x:d.x+w,y:d.y+M,width:y,height:E,points:C}},le=(d,w,M,$)=>{const _=d.x+d.width/2,y=d.y+d.height/2,E=Y(w,M,_,y,d.angle||0);if(E.x<d.x-$||E.x>d.x+d.width+$||E.y<d.y-$||E.y>d.y+d.height+$)return!1;if(d.type==="rectangle")return!0;if(d.type==="circle")return di(E,d.x,d.y,d.width,d.height);if(d.type==="line"||d.type==="arrow")return Rn(E,{x:d.x,y:d.y},{x:d.x+d.width,y:d.y+d.height})<=$;if(d.type==="pencil"&&d.points){const C={x:E.x-d.x,y:E.y-d.y};return fi(C,d.points,$)}else if(d.type==="text"||d.type==="image")return!0;return!1},Fe=d=>{d.currentTarget.setPointerCapture(d.pointerId);const{x:w,y:M}=Q(d.clientX,d.clientY);if(o()){et();return}if(b.selectedTool==="selection"){const _=se(w,M);if(_&&b.selection.length===1){Ae(),c=!0,f=_.handle;const C=b.elements.find(S=>S.id===_.id);C&&(g=C.x,x=C.y,P=C.width,A=C.height,O=C.points?[...C.points]:void 0,z=C.fontSize||20,s=w,i=M);return}let y=null;const E=10/b.viewState.scale;for(let C=b.elements.length-1;C>=0;C--){const S=b.elements[C];if(le(S,w,M,E)){y=S.id;break}}if(y){const C=b.selection.includes(y);d.shiftKey?C?H("selection",S=>S.filter(I=>I!==y)):H("selection",S=>[...S,y]):C||H("selection",[y]),b.selection.length>0&&(Ae(),c=!0,f=null,s=w,i=M,k.clear(),b.elements.forEach(S=>{b.selection.includes(S.id)&&k.set(S.id,{x:S.x,y:S.y})}))}else d.shiftKey||H("selection",[]),u=!0,s=w,i=M,m({x:w,y:M,w:0,h:0});return}if(b.selectedTool==="text"){const _=crypto.randomUUID(),y={id:_,type:"text",x:w,y:M,width:100,height:30,strokeColor:"#000000",backgroundColor:"transparent",strokeWidth:1,text:"",fontSize:20,angle:0,opacity:100,fillStyle:"hachure",strokeStyle:"solid",roughness:1,renderStyle:"sketch",seed:Math.floor(Math.random()*2**31),roundness:null,locked:!1,link:null};Xt(y),a(_),r(""),setTimeout(()=>h?.focus(),0);return}if(b.selectedTool==="eraser"){e=!0;const _=10/b.viewState.scale;for(let y=b.elements.length-1;y>=0;y--){const E=b.elements[y];le(E,w,M,_)&&Re([E.id])}return}if(b.selectedTool==="pan"){c=!0,D("grabbing");return}e=!0,s=w,i=M,n=crypto.randomUUID();const $={id:n,type:b.selectedTool,x:w,y:M,width:0,height:0,strokeColor:"#000000",backgroundColor:"transparent",strokeWidth:2,points:b.selectedTool==="pencil"?[{x:0,y:0}]:void 0,angle:0,opacity:100,strokeStyle:"solid",fillStyle:"hachure",roughness:1,renderStyle:"sketch",seed:Math.floor(Math.random()*2**31),roundness:null,locked:!1,link:null};Xt($)},Xe=d=>{const{x:w,y:M}=Q(d.clientX,d.clientY);if(b.selectedTool==="pan")D(c?"grabbing":"grab");else if(b.selectedTool==="selection"&&!c){const $=se(w,M);$?$.handle==="rotate"?D("grab"):$.handle==="tl"||$.handle==="br"?D("nwse-resize"):$.handle==="tr"||$.handle==="bl"?D("nesw-resize"):$.handle==="tm"||$.handle==="bm"?D("ns-resize"):($.handle==="lm"||$.handle==="rm")&&D("ew-resize"):D("default")}if(b.selectedTool==="pan"){c&&we({panX:b.viewState.panX+d.movementX,panY:b.viewState.panY+d.movementY});return}if(b.selectedTool==="selection"){if(u){const $=w-s,_=M-i;m({x:$>0?s:s+$,y:_>0?i:i+_,w:Math.abs($),h:Math.abs(_)});return}if(c&&b.selection.length>0){const $=b.selection[0],_=b.elements.find(y=>y.id===$);if(!_)return;if(f)if(f==="rotate"){const y=_.x+_.width/2,E=_.y+_.height/2,C=Math.atan2(M-E,w-y);pe($,{angle:C+Math.PI/2})}else{const y=w-s,E=M-i;let C=g,S=x,I=P,j=A;f==="tl"?(C+=y,S+=E,I-=y,j-=E):f==="tr"?(S+=E,I+=y,j-=E):f==="bl"?(C+=y,I-=y,j+=E):f==="br"?(I+=y,j+=E):f==="tm"?(S+=E,j-=E):f==="bm"?j+=E:f==="lm"?(C+=y,I-=y):f==="rm"&&(I+=y);const ee={x:C,y:S,width:I,height:j};if(_.type==="pencil"&&O){const q=I/P,G=j/A,me=O.map(de=>({x:de.x*(P===0?1:q),y:de.y*(A===0?1:G)}));ee.points=me}if(_.type==="text"){const q=j/A;if(q>0){let G=z*q;G=Math.max(G,8),ee.fontSize=G,ee.width=I}}pe($,ee)}else{const y=w-s,E=M-i;b.selection.forEach(C=>{const S=k.get(C);S&&pe(C,{x:S.x+y,y:S.y+E})})}}}if(!e||!n){if(e&&b.selectedTool==="eraser"){const $=10/b.viewState.scale;for(let _=b.elements.length-1;_>=0;_--){const y=b.elements[_];le(y,w,M,$)&&Re([y.id])}}return}if(b.selectedTool==="pencil"){const $=b.elements.find(_=>_.id===n);$&&$.points&&pe(n,{points:[...$.points,{x:w-s,y:M-i}]})}else pe(n,{width:w-s,height:M-i});if(c||e){const y=d.clientX,E=d.clientY;let C=0,S=0;y<50&&(C=10),y>window.innerWidth-50&&(C=-10),E<50&&(S=10),E>window.innerHeight-50&&(S=-10),(C!==0||S!==0)&&we({panX:b.viewState.panX+C,panY:b.viewState.panY+S})}},ye=d=>{if(d.currentTarget.releasePointerCapture(d.pointerId),b.selectedTool==="pan"){c=!1,D("grab");return}if(b.selectedTool==="selection"){if(u){const w=p();if(w){const M=[],$=w.x,_=w.y,y=w.w,E=w.h;if(b.elements.forEach(C=>{const S=C.x,I=C.y,j=C.width,ee=C.height;$<S+j&&$+y>S&&_<I+ee&&_+E>I&&M.push(C.id)}),d.shiftKey){const C=new Set(b.selection);M.forEach(S=>C.add(S)),H("selection",Array.from(C))}else H("selection",M)}u=!1,m(null)}c=!1,f=null,k.clear();return}if(e&&n){const w=b.elements.find(M=>M.id===n);if(w){if(w.type==="rectangle"||w.type==="circle")w.width<0&&pe(n,{x:w.x+w.width,width:Math.abs(w.width)}),w.height<0&&pe(n,{y:w.y+w.height,height:Math.abs(w.height)});else if(w.type==="pencil"){const M=ie(w);M&&pe(n,M)}}}e=!1,n=null},et=()=>{const d=o();if(d){const w=l().trim();if(w){const M=b.elements.find(y=>y.id===d);let $=0,_=0;if(t&&M){const y=t.getContext("2d");if(y){const E=M.fontSize||20;y.font=`${E}px sans-serif`,$=y.measureText(w).width,_=E}}$=Math.max($,10),_=Math.max(_,10),pe(d,{text:l(),width:$,height:_},!0)}else Re([d]);a(null),r(""),requestAnimationFrame(V)}},Oe=()=>{o()&&et()},tt=()=>{const d=o();return d?b.elements.find(w=>w.id===d):null};Ie(()=>{o()&&h&&(h.style.height="auto",h.style.height=h.scrollHeight+"px")});const[Pt,Me]=ne(!1);Ie(()=>{const{scale:d,panX:w,panY:M}=b.viewState;if(!t||b.elements.length===0){Me(!1);return}const $=-w/d,_=-M/d,y=t.width/d,E=t.height/d;let C=1/0,S=1/0,I=-1/0,j=-1/0;b.elements.forEach(q=>{const G=q.x,me=q.x+q.width,de=q.y,We=q.y+q.height;C=Math.min(C,G,me),I=Math.max(I,G,me),S=Math.min(S,de,We),j=Math.max(j,de,We)});const ee=!(C>$+y||I<$||S>_+E||j<_);Me(!ee)});const At=()=>{if(b.elements.length===0)return;let d=1/0,w=1/0,M=-1/0,$=-1/0;b.elements.forEach(G=>{const me=G.x,de=G.x+G.width,We=G.y,en=G.y+G.height;d=Math.min(d,me,de),M=Math.max(M,me,de),w=Math.min(w,We,en),$=Math.max($,We,en)});const _=M-d,y=$-w,E=d+_/2,C=w+y/2,{scale:S}=b.viewState,I=window.innerWidth/2,j=window.innerHeight/2,ee=-E*S+I,q=-C*S+j;we({panX:ee,panY:q})};return St(()=>{window.addEventListener("resize",L),L(),Mt(()=>window.removeEventListener("resize",L))}),[(()=>{var d=gi();d.$$pointerup=ye,d.$$pointermove=Xe,d.$$pointerdown=Fe,d.addEventListener("wheel",Z);var w=t;return typeof w=="function"?qe(w,d):t=d,B(M=>Ne(d,"cursor",W())),d})(),v(ce,{get when(){return Pt()},get children(){var d=yi(),w=d.firstChild;return w.$$click=At,d}}),v(ce,{get when(){return _t(()=>!!o())()&&tt()},children:d=>{const w=tt(),{scale:M,panX:$,panY:_}=b.viewState,y=w.x*M+$,E=w.y*M+_;return(()=>{var C=mi();C.addEventListener("blur",Oe),C.$$input=I=>r(I.currentTarget.value);var S=h;return typeof S=="function"?qe(S,C):h=C,Ne(C,"top",`${E}px`),Ne(C,"left",`${y}px`),Ne(C,"font",`${20*M}px sans-serif`),B(I=>Ne(C,"color",w.strokeColor)),B(()=>C.value=l()),C})()}})]};ke(["pointerdown","pointermove","pointerup","click","input"]);var wi={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"},Ee=wi,vi=R("<svg>"),pn=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ki=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,s)=>s?s.toUpperCase():n.toLowerCase()),xi=t=>{const e=ki(t);return e.charAt(0).toUpperCase()+e.slice(1)},$i=(...t)=>t.filter((e,n,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===n).join(" ").trim(),Si=t=>{const[e,n]=$n(t,["color","size","strokeWidth","children","class","name","iconNode","absoluteStrokeWidth"]);return(()=>{var s=vi();return Sn(s,F(Ee,{get width(){return e.size??Ee.width},get height(){return e.size??Ee.height},get stroke(){return e.color??Ee.stroke},get"stroke-width"(){return _t(()=>!!e.absoluteStrokeWidth)()?Number(e.strokeWidth??Ee["stroke-width"])*24/Number(e.size):Number(e.strokeWidth??Ee["stroke-width"])},get class(){return $i("lucide","lucide-icon",...e.name!=null?[`lucide-${pn(xi(e.name))}`,`lucide-${pn(e.name)}`]:[],e.class!=null?e.class:"")}},n),!0,!0),T(s,v(Le,{get each(){return e.iconNode},children:([i,o])=>v($s,F({component:i},o))})),s})()},X=Si,Mi=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],_i=t=>v(X,F(t,{iconNode:Mi,name:"chevron-down"})),Ci=_i,Pi=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Ai=t=>v(X,F(t,{iconNode:Pi,name:"chevron-up"})),Oi=Ai,Ti=[["path",{d:"m7 6 5 5 5-5",key:"1lc07p"}],["path",{d:"m7 13 5 5 5-5",key:"1d48rs"}]],Ei=t=>v(X,F(t,{iconNode:Ti,name:"chevrons-down"})),Ni=Ei,zi=[["path",{d:"m17 11-5-5-5 5",key:"e8nh98"}],["path",{d:"m17 18-5-5-5 5",key:"2avn1x"}]],Li=t=>v(X,F(t,{iconNode:zi,name:"chevrons-up"})),Ii=Li,Di=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ri=t=>v(X,F(t,{iconNode:Di,name:"circle"})),ji=Ri,Fi=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Xi=t=>v(X,F(t,{iconNode:Fi,name:"copy"})),Wi=Xi,Yi=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Vi=t=>v(X,F(t,{iconNode:Yi,name:"download"})),Hi=Vi,Ui=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],qi=t=>v(X,F(t,{iconNode:Ui,name:"eraser"})),Bi=qi,Gi=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M9 15h6",key:"cctwl0"}],["path",{d:"M12 18v-6",key:"17g6i2"}]],Ki=t=>v(X,F(t,{iconNode:Gi,name:"file-plus"})),Zi=Ki,Ji=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Qi=t=>v(X,F(t,{iconNode:Ji,name:"file-text"})),eo=Qi,to=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],no=t=>v(X,F(t,{iconNode:to,name:"folder-open"})),so=no,io=[["path",{d:"M18 11V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2",key:"1fvzgz"}],["path",{d:"M14 10V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v2",key:"1kc0my"}],["path",{d:"M10 10.5V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2v8",key:"10h0bg"}],["path",{d:"M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"1s1gnw"}]],oo=t=>v(X,F(t,{iconNode:io,name:"hand"})),lo=oo,ao=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],ro=t=>v(X,F(t,{iconNode:ao,name:"image"})),Fn=ro,co=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]],ho=t=>v(X,F(t,{iconNode:co,name:"maximize"})),uo=ho,fo=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],po=t=>v(X,F(t,{iconNode:fo,name:"menu"})),go=po,yo=[["path",{d:"M5 12h14",key:"1ays0h"}]],mo=t=>v(X,F(t,{iconNode:yo,name:"minus"})),Xn=mo,bo=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],wo=t=>v(X,F(t,{iconNode:bo,name:"moon"})),vo=wo,ko=[["path",{d:"M4.037 4.688a.495.495 0 0 1 .651-.651l16 6.5a.5.5 0 0 1-.063.947l-6.124 1.58a2 2 0 0 0-1.438 1.435l-1.579 6.126a.5.5 0 0 1-.947.063z",key:"edeuup"}]],xo=t=>v(X,F(t,{iconNode:ko,name:"mouse-pointer-2"})),$o=xo,So=[["path",{d:"M13 5H19V11",key:"1n1gyv"}],["path",{d:"M19 5L5 19",key:"72u4yj"}]],Mo=t=>v(X,F(t,{iconNode:So,name:"move-up-right"})),_o=Mo,Co=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Po=t=>v(X,F(t,{iconNode:Co,name:"pencil"})),Ao=Po,Oo=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],To=t=>v(X,F(t,{iconNode:Oo,name:"plus"})),Eo=To,No=[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M20 9H9.5A5.5 5.5 0 0 0 4 14.5A5.5 5.5 0 0 0 9.5 20H13",key:"6uklza"}]],zo=t=>v(X,F(t,{iconNode:No,name:"redo-2"})),Wn=zo,Lo=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Io=t=>v(X,F(t,{iconNode:Lo,name:"save"})),Do=Io,Ro=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],jo=t=>v(X,F(t,{iconNode:Ro,name:"share-2"})),Fo=jo,Xo=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Wo=t=>v(X,F(t,{iconNode:Xo,name:"square"})),Yo=Wo,Vo=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],Ho=t=>v(X,F(t,{iconNode:Vo,name:"sun"})),Uo=Ho,qo=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Bo=t=>v(X,F(t,{iconNode:qo,name:"trash-2"})),Jt=Bo,Go=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],Ko=t=>v(X,F(t,{iconNode:Go,name:"type"})),Zo=Ko,Jo=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],Qo=t=>v(X,F(t,{iconNode:Jo,name:"undo-2"})),Yn=Qo,el=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],tl=t=>v(X,F(t,{iconNode:el,name:"upload"})),nl=tl,sl=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],il=t=>v(X,F(t,{iconNode:sl,name:"x"})),Qt=il,ol=R("<div class=toolbar-container><input type=file accept=image/* style=display:none>"),ll=R("<button>");const al=[{type:"pan",icon:lo,label:"Pan Tool"},{type:"selection",icon:$o,label:"Selection"},{type:"rectangle",icon:Yo,label:"Rectangle"},{type:"circle",icon:ji,label:"Circle"},{type:"arrow",icon:_o,label:"Arrow"},{type:"line",icon:Xn,label:"Line"},{type:"pencil",icon:Ao,label:"Pencil"},{type:"text",icon:Zo,label:"Text"},{type:"image",icon:Fn,label:"Insert Image"},{type:"eraser",icon:Bi,label:"Eraser"}],rl=()=>{let t=null;const e=s=>{s==="image"?t?.click():As(s)},n=s=>{const i=s.target.files?.[0];if(!i)return;const o=new FileReader;o.onload=a=>{const l=a.target?.result;if(l){const r=new Image;r.src=l,r.onload=()=>{let c=r.width,u=r.height;if(c>500||u>500){const f=c/u;c>u?(c=500,u=c/f):(u=500,c=u*f)}Xt({id:crypto.randomUUID(),type:"image",x:100,y:100,width:c,height:u,strokeColor:"transparent",backgroundColor:"transparent",fillStyle:"solid",strokeWidth:0,strokeStyle:"solid",roughness:0,opacity:100,angle:0,renderStyle:"sketch",seed:Math.floor(Math.random()*2**31),roundness:null,locked:!1,link:null,dataURL:l,mimeType:i.type})}}},o.readAsDataURL(i),s.target.value=""};return(()=>{var s=ol(),i=s.firstChild;return i.addEventListener("change",n),qe(o=>t=o,i),T(s,()=>al.map(o=>(()=>{var a=ll();return a.$$click=()=>e(o.type),T(a,v(o.icon,{size:20})),B(l=>{var r=`toolbar-btn ${b.selectedTool===o.type?"active":""}`,h=o.label;return r!==l.e&&Ce(a,l.e=r),h!==l.t&&xe(a,"title",l.t=h),l},{e:void 0,t:void 0}),a})()),null),s})()};ke(["click"]);class cl{baseUrl="/api/drawings";async saveDrawing(e,n){await fetch(`${this.baseUrl}/${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})}async loadDrawing(e){const n=await fetch(`${this.baseUrl}/${e}`);return n.ok?await n.json():null}async listDrawings(){const e=await fetch(this.baseUrl);return e.ok?await e.json():[]}async deleteDrawing(e){await fetch(`${this.baseUrl}/${e}`,{method:"DELETE"})}}const xt=new cl;var hl=R("<div class=loading>Loading..."),ul=R("<div class=empty>No saved drawings found."),fl=R("<div class=modal-overlay><div class=modal-content><div class=modal-header><h3>Open Drawing</h3><button class=close-btn></button></div><div class=modal-body><div class=file-list>"),dl=R("<div class=file-item><div style=display:flex;align-items:center;gap:8px;flex:1><span></span></div><button class=delete-file-btn title=Delete>");const pl=t=>{const[e,n]=ne([]),[s,i]=ne(!1),o=async()=>{i(!0);try{const l=await xt.listDrawings();n(l.map(r=>r.replace(".json","")))}catch(l){console.error(l)}finally{i(!1)}},a=async(l,r)=>{if(r.stopPropagation(),confirm(`Are you sure you want to delete "${l}"?`))try{await xt.deleteDrawing(l),o()}catch{alert("Failed to delete file")}};return St(()=>{t.isOpen&&o()}),Ie(()=>{t.isOpen&&o()}),v(ce,{get when(){return t.isOpen},get children(){var l=fl(),r=l.firstChild,h=r.firstChild,c=h.firstChild,u=c.nextSibling,f=h.nextSibling,p=f.firstChild;return he(l,"click",t.onClose,!0),r.$$click=m=>m.stopPropagation(),he(u,"click",t.onClose,!0),T(u,v(Qt,{size:20})),T(f,v(ce,{get when(){return s()},get children(){return hl()}}),p),T(f,v(ce,{get when(){return _t(()=>!s())()&&e().length===0},get children(){return ul()}}),p),T(p,v(Le,{get each(){return e()},children:m=>(()=>{var k=dl(),g=k.firstChild,x=g.firstChild,P=g.nextSibling;return k.$$click=()=>t.onSelect(m),T(g,v(eo,{size:16}),x),T(x,m),P.$$click=A=>a(m,A),T(P,v(Jt,{size:16})),k})()})),l}})};ke(["click"]);const gl=async(t,e)=>{const n=b.elements;if(n.length===0)return;let s=1/0,i=1/0,o=-1/0,a=-1/0;n.forEach(m=>{s=Math.min(s,m.x),i=Math.min(i,m.y),o=Math.max(o,m.x+m.width),a=Math.max(a,m.y+m.height)});const l=20,r=o-s+l*2,h=a-i+l*2,c=document.createElement("canvas");c.width=r*t,c.height=h*t;const u=c.getContext("2d");if(!u)return;e&&(u.fillStyle="#ffffff",u.fillRect(0,0,c.width,c.height)),u.scale(t,t),u.translate(-s+l,-i+l);const f=Zt.canvas(c);n.forEach(m=>{jn(f,u,m)});const p=document.createElement("a");p.download="yappy_drawing.png",p.href=c.toDataURL("image/png"),p.click()},yl=()=>{const t=b.elements;if(t.length===0)return;let e=1/0,n=1/0,s=-1/0,i=-1/0;t.forEach(g=>{e=Math.min(e,g.x),n=Math.min(n,g.y),s=Math.max(s,g.x+g.width),i=Math.max(i,g.y+g.height)});const o=20,a=s-e+o*2,l=i-n+o*2,r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttribute("width",`${a}`),r.setAttribute("height",`${l}`),r.setAttribute("viewBox",`0 0 ${a} ${l}`),r.style.backgroundColor="#ffffff";const h=Zt.svg(r),c=document.createElementNS("http://www.w3.org/2000/svg","g");c.setAttribute("transform",`translate(${-e+o}, ${-n+o})`),r.appendChild(c),t.forEach(g=>{let x=null;const P={seed:g.seed,roughness:g.roughness,stroke:g.strokeColor,strokeWidth:g.strokeWidth,fill:g.backgroundColor==="transparent"?void 0:g.backgroundColor,fillStyle:g.fillStyle,strokeLineDash:g.strokeStyle==="dashed"?[10,10]:g.strokeStyle==="dotted"?[5,10]:void 0};if(g.type==="rectangle")x=h.rectangle(g.x,g.y,g.width,g.height,P);else if(g.type==="circle")x=h.ellipse(g.x+g.width/2,g.y+g.height/2,Math.abs(g.width),Math.abs(g.height),P);else if(g.type==="line"||g.type==="arrow"){const A=g.x+g.width,O=g.y+g.height;if(g.type==="arrow"){const z=document.createElementNS("http://www.w3.org/2000/svg","g");z.appendChild(h.line(g.x,g.y,A,O,P));const L=Math.atan2(g.height,g.width),W=15,D={x:A-W*Math.cos(L-Math.PI/6),y:O-W*Math.sin(L-Math.PI/6)},V={x:A-W*Math.cos(L+Math.PI/6),y:O-W*Math.sin(L+Math.PI/6)};z.appendChild(h.line(A,O,D.x,D.y,P)),z.appendChild(h.line(A,O,V.x,V.y,P)),x=z}else x=h.line(g.x,g.y,A,O,P)}else if(g.type==="pencil"&&g.points){const A=g.points.map(O=>[g.x+O.x,g.y+O.y]);x=h.linearPath(A,P)}else if(g.type==="text"&&g.text){const A=document.createElementNS("http://www.w3.org/2000/svg","text");A.textContent=g.text,A.setAttribute("x",`${g.x}`),A.setAttribute("y",`${g.y+(g.fontSize||20)}`),A.setAttribute("fill",g.strokeColor),A.setAttribute("font-family","sans-serif"),A.setAttribute("font-size",`${g.fontSize||20}px`),x=A}else if(g.type==="image"&&g.dataURL){const A=document.createElementNS("http://www.w3.org/2000/svg","image");A.setAttribute("href",g.dataURL),A.setAttribute("x",`${g.x}`),A.setAttribute("y",`${g.y}`),A.setAttribute("width",`${g.width}`),A.setAttribute("height",`${g.height}`),x=A}if(x){if(x.setAttribute("opacity",`${(g.opacity??100)/100}`),g.angle){const A=g.x+g.width/2,O=g.y+g.height/2;x.setAttribute("transform",`rotate(${g.angle*(180/Math.PI)}, ${A}, ${O})`)}c.appendChild(x)}});const f=new XMLSerializer().serializeToString(r),p=new Blob([f],{type:"image/svg+xml"}),m=URL.createObjectURL(p),k=document.createElement("a");k.download="yappy_drawing.svg",k.href=m,k.click()};var ml=R("<div class=option-group><label>Scale</label><div class=scale-group><button>1x</button><button>2x</button><button>3x"),bl=R("<div class=option-group><label class=checkbox-label><input type=checkbox>White Background"),wl=R("<div class=export-modal-overlay><div class=export-modal><div class=export-header><h3>Export Image</h3><button class=close-btn></button></div><div class=export-options><div class=option-group><label>Format</label><div class=radio-group><label class=radio-label><input type=radio name=format>PNG</label><label class=radio-label><input type=radio name=format>SVG</label></div></div></div><div class=export-actions><button class=cancel-btn>Cancel</button><button class=export-confirm-btn>Export");const vl=t=>{const[e,n]=ne("png"),[s,i]=ne(2),[o,a]=ne(!0),l=()=>{e()==="png"?gl(s(),o()):yl(),t.onClose()};return v(ce,{get when(){return t.isOpen},get children(){var r=wl(),h=r.firstChild,c=h.firstChild,u=c.firstChild,f=u.nextSibling,p=c.nextSibling,m=p.firstChild,k=m.firstChild,g=k.nextSibling,x=g.firstChild,P=x.firstChild,A=x.nextSibling,O=A.firstChild,z=p.nextSibling,L=z.firstChild,W=L.nextSibling;return he(r,"click",t.onClose,!0),h.$$click=D=>D.stopPropagation(),he(f,"click",t.onClose,!0),T(f,v(Qt,{size:20})),P.addEventListener("change",()=>n("png")),O.addEventListener("change",()=>n("svg")),T(p,v(ce,{get when(){return e()==="png"},get children(){return[(()=>{var D=ml(),V=D.firstChild,J=V.nextSibling,Q=J.firstChild,Z=Q.nextSibling,U=Z.nextSibling;return Q.$$click=()=>i(1),Z.$$click=()=>i(2),U.$$click=()=>i(3),B(Y=>{var se=`scale-btn ${s()===1?"active":""}`,ie=`scale-btn ${s()===2?"active":""}`,le=`scale-btn ${s()===3?"active":""}`;return se!==Y.e&&Ce(Q,Y.e=se),ie!==Y.t&&Ce(Z,Y.t=ie),le!==Y.a&&Ce(U,Y.a=le),Y},{e:void 0,t:void 0,a:void 0}),D})(),(()=>{var D=bl(),V=D.firstChild,J=V.firstChild;return J.addEventListener("change",Q=>a(Q.currentTarget.checked)),B(()=>J.checked=o()),D})()]}}),null),he(L,"click",t.onClose,!0),W.$$click=l,B(()=>P.checked=e()==="png"),B(()=>O.checked=e()==="svg"),r}})};ke(["click"]);var kl=R("<div class=save-overlay><div class=save-modal><div class=save-header><h2>Save Drawing</h2><button class=close-btn></button></div><div class=save-content><div class=input-group><label>Filename</label><input type=text class=filename-input autofocus></div><div class=save-actions><button class=cancel-btn>Cancel</button><button class=confirm-btn>Save");const xl=t=>{const[e,n]=ne("");Ie(()=>{t.isOpen&&n(t.initialFilename||"untitled")});const s=()=>{e().trim()&&(t.onSave(e().trim()),t.onClose())},i=o=>{o.key==="Enter"?s():o.key==="Escape"&&t.onClose()};return v(ce,{get when(){return t.isOpen},get children(){var o=kl(),a=o.firstChild,l=a.firstChild,r=l.firstChild,h=r.nextSibling,c=l.nextSibling,u=c.firstChild,f=u.firstChild,p=f.nextSibling,m=u.nextSibling,k=m.firstChild,g=k.nextSibling;return he(o,"click",t.onClose,!0),a.$$click=x=>x.stopPropagation(),he(h,"click",t.onClose,!0),T(h,v(Qt,{size:20})),p.$$keydown=i,p.$$input=x=>n(x.currentTarget.value),he(k,"click",t.onClose,!0),g.$$click=s,B(()=>p.value=e()),o}})};ke(["click","input","keydown"]);var $l=R("<div class=menu-backdrop>"),Sl=R("<input type=file accept=.json style=display:none>"),Ml=R("<div class=app-title>"),_l=R('<div class=menu-dropdown><button class=menu-item><span class=label>Open from Workspace...</span><span class=shortcut>Ctrl+O</span></button><button class=menu-item><span class=label>Save to Workspace...</span><span class=shortcut>Ctrl+S</span></button><div class=menu-separator></div><button class=menu-item><span class=label>Open from Disk...</span></button><button class=menu-item><span class=label>Save to Disk...</span></button><div class=menu-separator></div><button class=menu-item><span class=label>Export image...</span><span class=shortcut>Ctrl+Shift+E</span></button><div class=menu-separator></div><button class=menu-item><span class=label>Reset Canvas</span></button><div class=menu-separator></div><div style="padding:4px 12px;font-size:12px;color:var(--text-secondary)">Found a bug? <a href=https://github.com/rajeshpillai/yappy/issues target=_blank rel="noopener noreferrer">Report'),Cl=R('<div style=position:fixed;top:12px;left:12px;z-index:1001><div class=menu-container style=position:relative><button title=Menu></button><div style="width:1px;height:24px;background:var(--border-color);margin:0 4px"></div><button class=menu-btn title="Undo (Ctrl+Z)"></button><button class=menu-btn title="Redo (Ctrl+Y)"></button><div style="width:1px;height:24px;background:var(--border-color);margin:0 4px"></div><button class=menu-btn title=Delete></button><div style="width:1px;height:24px;background:var(--border-color);margin:0 4px"></div><button class=menu-btn title="Zoom to Fit">'),Pl=R('<div style=position:fixed;top:12px;right:12px;z-index:100><div class=menu-container><button class="menu-btn primary"title=Share><span style=margin-left:4px>Share</span></button><div style="width:1px;height:24px;background:var(--border-color);margin:0 4px"></div><button class=menu-btn title="Toggle Theme">');const Al=()=>{const[t,e]=ne("default"),[n,s]=ne(!1),[i,o]=ne(!1),[a,l]=ne(!1),[r,h]=ne(!1);let c;const[u,f]=ne("workspace"),p=O=>{f(O),l(!0),h(!1)},m=async O=>{if(e(O),u()==="workspace")try{await xt.saveDrawing(O,{elements:b.elements,viewState:b.viewState}),alert(`Drawing saved as "${O}"!`)}catch(z){console.error(z),alert("Failed to save to workspace")}else{const z=JSON.stringify({elements:b.elements,viewState:b.viewState,version:1},null,2),L=new Blob([z],{type:"application/json"}),W=`${O}.json`,D=new File([L],W,{type:"application/json"});if(navigator.canShare&&navigator.canShare({files:[D]}))try{await navigator.share({files:[D],title:"Yappy Drawing",text:"Save your drawing JSON"});return}catch(Q){Q.name!=="AbortError"&&console.error("Share failed:",Q)}const V=URL.createObjectURL(L),J=document.createElement("a");J.href=V,J.download=W,document.body.appendChild(J),J.click(),document.body.removeChild(J),URL.revokeObjectURL(V)}},k=async O=>{const z=O||t();try{const L=await xt.loadDrawing(z);L?(H({elements:L.elements||[],viewState:L.viewState||{scale:1,panX:0,panY:0}}),e(z)):alert("Drawing not found")}catch(L){console.error(L),alert("Failed to load")}},g=()=>{confirm("Clear canvas?")&&(H("elements",[]),H("viewState",{scale:1,panX:0,panY:0}),H("selection",[]),Ts(),e("untitled")),h(!1)},x=()=>{zs()},P=()=>{const O=`${window.location.origin}${window.location.pathname}?id=${t()}`;navigator.clipboard.writeText(O),alert(`Link copied: ${O}`)},A=O=>{const z=O.target.files?.[0];if(!z)return;const L=new FileReader;L.onload=W=>{try{const D=JSON.parse(W.target?.result);if(D.elements){H({elements:D.elements,viewState:D.viewState||{scale:1,panX:0,panY:0}});const V=z.name.replace(/\.json$/i,"");e(V)}else alert("Invalid file format")}catch(D){console.error(D),alert("Failed to parse JSON")}},L.readAsText(z),h(!1),O.target.value=""};return St(()=>{const z=new URLSearchParams(window.location.search).get("id");z&&(e(z),k(z));const L=W=>{W.ctrlKey&&(W.key==="o"?(W.preventDefault(),s(!0)):W.key==="s"?(W.preventDefault(),p("workspace")):W.key.toLowerCase()==="e"&&W.shiftKey&&(W.preventDefault(),o(!0)))};window.addEventListener("keydown",L),Mt(()=>window.removeEventListener("keydown",L))}),[v(ce,{get when(){return r()},get children(){var O=$l();return O.$$click=()=>h(!1),O}}),(()=>{var O=Sl();O.addEventListener("change",A);var z=c;return typeof z=="function"?qe(z,O):c=O,O})(),v(pl,{get isOpen(){return n()},onClose:()=>s(!1),onSelect:O=>{k(O),s(!1)}}),v(vl,{get isOpen(){return i()},onClose:()=>o(!1)}),v(xl,{get isOpen(){return a()},onClose:()=>l(!1),onSave:m,get initialFilename(){return t()}}),(()=>{var O=Ml();return T(O,t),O})(),(()=>{var O=Cl(),z=O.firstChild,L=z.firstChild,W=L.nextSibling,D=W.nextSibling,V=D.nextSibling,J=V.nextSibling,Q=J.nextSibling,Z=Q.nextSibling,U=Z.nextSibling;return L.$$click=()=>h(!r()),T(L,v(go,{size:20})),T(z,v(ce,{get when(){return r()},get children(){var Y=_l(),se=Y.firstChild,ie=se.firstChild,le=se.nextSibling,Fe=le.firstChild,Xe=le.nextSibling,ye=Xe.nextSibling,et=ye.firstChild,Oe=ye.nextSibling,tt=Oe.firstChild,Pt=Oe.nextSibling,Me=Pt.nextSibling,At=Me.firstChild,d=Me.nextSibling,w=d.nextSibling,M=w.firstChild,$=w.nextSibling;return $.nextSibling,se.$$click=()=>{s(!0),h(!1)},T(se,v(so,{size:16}),ie),le.$$click=()=>p("workspace"),T(le,v(Do,{size:16}),Fe),ye.$$click=()=>{c?.click(),h(!1)},T(ye,v(nl,{size:16}),et),Oe.$$click=()=>p("disk"),T(Oe,v(Hi,{size:16}),tt),Me.$$click=()=>{o(!0),h(!1)},T(Me,v(Fn,{size:16}),At),w.$$click=g,T(w,v(Zi,{size:16}),M),Y}}),W),he(D,"click",On,!0),T(D,v(Yn,{size:18})),he(V,"click",Ft,!0),T(V,v(Wn,{size:18})),Q.$$click=()=>Re(b.selection),T(Q,v(Jt,{size:18})),U.$$click=x,T(U,v(uo,{size:18})),B(Y=>{var se=`menu-btn ${r()?"active":""}`,ie=b.selection.length===0;return se!==Y.e&&Ce(L,Y.e=se),ie!==Y.t&&(Q.disabled=Y.t=ie),Y},{e:void 0,t:void 0}),O})(),(()=>{var O=Pl(),z=O.firstChild,L=z.firstChild,W=L.firstChild,D=L.nextSibling,V=D.nextSibling;return L.$$click=P,T(L,v(Fo,{size:18}),W),he(V,"click",Ns,!0),T(V,(()=>{var J=_t(()=>b.theme==="dark");return()=>J()?v(Uo,{size:18}):v(vo,{size:18})})()),O})()]};ke(["click"]);var Ol=R('<div class=zoom-container><div class=zoom-group><button class=zoom-btn title="Zoom Out"></button><button class="zoom-btn text-btn"title="Reset Zoom">%</button><button class=zoom-btn title="Zoom In"></button></div><div class=zoom-group style=margin-left:12px><button class=zoom-btn title="Undo (Coming Soon)"></button><button class=zoom-btn title="Redo (Coming Soon)">');const Tl=()=>{const t=()=>{const s=Math.min(b.viewState.scale*1.1,10);we({scale:s})},e=()=>{const s=Math.max(b.viewState.scale*.9,.1);we({scale:s})},n=()=>{we({scale:1})};return(()=>{var s=Ol(),i=s.firstChild,o=i.firstChild,a=o.nextSibling,l=a.firstChild,r=a.nextSibling,h=i.nextSibling,c=h.firstChild,u=c.nextSibling;return o.$$click=e,T(o,v(Xn,{size:16})),a.$$click=n,T(a,()=>Math.round(b.viewState.scale*100),l),r.$$click=t,T(r,v(Eo,{size:16})),T(c,v(Yn,{size:16})),T(u,v(Wn,{size:16})),s})()};ke(["click"]);const El=[{key:"renderStyle",label:"Style",type:"select",group:"style",options:[{label:"Sketch",value:"sketch"},{label:"Architectural",value:"architectural"}],applicableTo:["rectangle","circle","line","arrow"],defaultValue:"sketch"},{key:"strokeColor",label:"Stroke",type:"color",group:"stroke",applicableTo:"all",defaultValue:"#000000"},{key:"backgroundColor",label:"Background",type:"color",group:"background",applicableTo:["rectangle","circle","text"],defaultValue:"transparent"},{key:"fillStyle",label:"Fill",type:"select",group:"background",options:[{label:"Solid",value:"solid"},{label:"Hachure",value:"hachure"},{label:"Cross-Hatch",value:"cross-hatch"}],applicableTo:["rectangle","circle"],defaultValue:"hachure"},{key:"strokeWidth",label:"Width",type:"slider",min:1,max:20,step:1,group:"stroke",applicableTo:["rectangle","circle","line","arrow","pencil"],defaultValue:1},{key:"strokeStyle",label:"Stroke Style",type:"select",group:"stroke",options:[{label:"Solid",value:"solid"},{label:"Dashed",value:"dashed"},{label:"Dotted",value:"dotted"}],applicableTo:["rectangle","circle","line","arrow","pencil"],defaultValue:"solid"},{key:"roughness",label:"Sloppiness",type:"slider",min:0,max:3,step:.1,group:"style",applicableTo:["rectangle","circle","line","arrow"],defaultValue:1},{key:"opacity",label:"Opacity",type:"slider",min:0,max:100,step:1,group:"style",applicableTo:"all",defaultValue:100},{key:"fontSize",label:"Size",type:"select",options:[{label:"Small",value:16},{label:"Medium",value:20},{label:"Large",value:28},{label:"XL",value:36}],group:"text",applicableTo:["text"],defaultValue:20},{key:"fontFamily",label:"Font",type:"select",options:[{label:"Hand-drawn",value:1},{label:"Normal",value:2},{label:"Code",value:3}],group:"text",applicableTo:["text"],defaultValue:1},{key:"textAlign",label:"Align",type:"select",options:[{label:"Left",value:"left"},{label:"Center",value:"center"},{label:"Right",value:"right"}],group:"text",applicableTo:["text"],defaultValue:"left"},{key:"text",label:"Content",type:"textarea",group:"text",applicableTo:["text"],defaultValue:""},{key:"startArrowhead",label:"Start Arrow",type:"select",options:[{label:"None",value:null},{label:"Arrow",value:"arrow"},{label:"Dot",value:"dot"}],group:"style",applicableTo:["arrow","line"],defaultValue:null},{key:"endArrowhead",label:"End Arrow",type:"select",options:[{label:"None",value:null},{label:"Arrow",value:"arrow"},{label:"Dot",value:"dot"},{label:"Triangle",value:"triangle"}],group:"style",applicableTo:["arrow","line"],defaultValue:"arrow"},{key:"angle",label:"Angle",type:"number",group:"dimensions",applicableTo:"all",defaultValue:0},{key:"locked",label:"Locked",type:"toggle",group:"advanced",applicableTo:"all",defaultValue:!1},{key:"link",label:"Link",type:"input",group:"advanced",applicableTo:"all",defaultValue:null}];var Nl=R('<div class=control-col><label></label><div class=color-picker-container><div class=color-grid></div><div class=hex-input-row><span class=hash>#</span><input type=text class=hex-input><div class=system-picker-wrapper><input type=color title="Custom Color">'),zl=R("<button>"),Ll=R("<div class=diagonal-line-sm>"),Il=R("<div class=control-row><label></label><div class=slider-wrapper><input type=range><span class=value-display>"),Dl=R("<div class=control-row><label></label><select>"),Rl=R("<option>"),jl=R("<div class=control-row><label></label><input type=checkbox>"),Fl=R("<div class=control-row><label></label><input type=text>"),Xl=R('<div class=control-col><label></label><textarea rows=3 style="width:100%;padding:8px;border:1px solid #d1d5db;border-radius:6px;font-family:inherit;font-size:13px;resize:vertical">'),Wl=R("<div class=header-actions><button title=Duplicate></button><button class=delete-btn title=Delete>"),Yl=R('<div class=property-group><div class=group-title>LAYERS</div><div class=layer-controls><button title="To Front"></button><button title=Forward></button><button title=Backward></button><button title="To Back">'),Vl=R("<div class=property-panel-container><div class=property-header><h3></h3></div><div class=property-content>"),Hl=R("<div class=property-group><div class=group-title>");const Ul=()=>{const t=ue(()=>{if(b.selection.length===1){const a=b.elements.find(l=>l.id===b.selection[0]);return a?{type:"element",data:a}:null}return null}),e=ue(()=>{const a=t();if(!a)return[];const l=a.data.type;return El.filter(r=>r.applicableTo==="all"?!0:Array.isArray(r.applicableTo)?r.applicableTo.includes(l):!0)}),n=(a,l)=>{const r=t();r&&(r.type==="element"?pe(r.data.id,{[a]:l},!0):Os({[a]:l}))},s=()=>{b.selection.length>0&&Re(b.selection)},i=(a,l)=>{switch(a.type){case"color":const r=["transparent","#ffffff","#f8f9fa","#f1f3f5","#fff5f5","#fff0f6","#f3f0ff","#e03131","#e8590c","#fcc419","#2f9e44","#1971c2","#6741d9","#c2255c","#343a40"];return(()=>{var h=Nl(),c=h.firstChild,u=c.nextSibling,f=u.firstChild,p=f.nextSibling,m=p.firstChild,k=m.nextSibling,g=k.nextSibling,x=g.firstChild;return T(c,()=>a.label),T(f,v(Le,{each:r,children:P=>(()=>{var A=zl();return A.$$click=()=>n(a.key,P),Ce(A,`color-swatch ${l===P?"selected":""}`),Ne(A,"background",P==="transparent"?"white":P),xe(A,"title",P),T(A,P==="transparent"&&Ll()),A})()})),k.$$input=P=>{let A=P.currentTarget.value;n(a.key,"#"+A)},x.$$input=P=>n(a.key,P.currentTarget.value),B(()=>k.value=l?.replace("#","")||""),B(()=>x.value=l?.startsWith("#")?l:"#000000"),h})();case"slider":return(()=>{var h=Il(),c=h.firstChild,u=c.nextSibling,f=u.firstChild,p=f.nextSibling;return T(c,()=>a.label),f.$$input=m=>n(a.key,Number(m.currentTarget.value)),T(p,l),B(m=>{var k=a.min,g=a.max,x=a.step;return k!==m.e&&xe(f,"min",m.e=k),g!==m.t&&xe(f,"max",m.t=g),x!==m.a&&xe(f,"step",m.a=x),m},{e:void 0,t:void 0,a:void 0}),B(()=>f.value=l??a.defaultValue),h})();case"select":return(()=>{var h=Dl(),c=h.firstChild,u=c.nextSibling;return T(c,()=>a.label),u.addEventListener("change",f=>{const p=f.currentTarget.value,m=a.options?.some(k=>typeof k.value=="number");n(a.key,m?Number(p):p)}),T(u,v(Le,{get each(){return a.options},children:f=>(()=>{var p=Rl();return T(p,()=>f.label),B(()=>p.value=f.value??""),p})()})),B(()=>u.value=l??a.defaultValue),h})();case"toggle":return(()=>{var h=jl(),c=h.firstChild,u=c.nextSibling;return T(c,()=>a.label),u.addEventListener("change",f=>n(a.key,f.currentTarget.checked)),u.checked=!!l,h})();case"input":return(()=>{var h=Fl(),c=h.firstChild,u=c.nextSibling;return T(c,()=>a.label),u.$$input=f=>n(a.key,f.currentTarget.value),u.value=l||"",h})();case"textarea":return(()=>{var h=Xl(),c=h.firstChild,u=c.nextSibling;return T(c,()=>a.label),u.$$input=f=>n(a.key,f.currentTarget.value),u.value=l||"",h})();default:return null}},o=ue(()=>{const a={};return e().forEach(l=>{a[l.group]||(a[l.group]=[]),a[l.group].push(l)}),a});return v(ce,{get when(){return t()},get children(){var a=Vl(),l=a.firstChild,r=l.firstChild,h=l.nextSibling;return T(r,()=>t()?.type==="element"?"Properties":"Defaults"),T(l,v(ce,{get when(){return t()?.type==="element"},get children(){var c=Wl(),u=c.firstChild,f=u.nextSibling;return u.$$click=()=>Es(t().data.id),T(u,v(Wi,{size:16})),f.$$click=s,T(f,v(Jt,{size:16})),c}}),null),T(h,v(Le,{get each(){return Object.entries(o())},children:([c,u])=>(()=>{var f=Hl(),p=f.firstChild;return T(p,()=>c.toUpperCase()),T(f,v(Le,{each:u,children:m=>i(m,(t()?.data)[m.key])}),null),f})()}),null),T(h,v(ce,{get when(){return t()?.type==="element"},get children(){var c=Yl(),u=c.firstChild,f=u.nextSibling,p=f.firstChild,m=p.nextSibling,k=m.nextSibling,g=k.nextSibling;return p.$$click=()=>st(t().data.id,"front"),T(p,v(Ii,{size:16})),m.$$click=()=>st(t().data.id,"forward"),T(m,v(Oi,{size:16})),k.$$click=()=>st(t().data.id,"backward"),T(k,v(Ci,{size:16})),g.$$click=()=>st(t().data.id,"back"),T(g,v(Ni,{size:16})),c}}),null),a}})};ke(["input","click"]);var ql=R("<div>");const Bl=()=>(St(()=>{const t=e=>{(e.ctrlKey||e.metaKey)&&e.key==="z"?(e.preventDefault(),e.shiftKey?Ft():On()):(e.ctrlKey||e.metaKey)&&e.key==="y"?(e.preventDefault(),Ft()):(e.key==="Delete"||e.key==="Backspace")&&document.activeElement?.tagName!=="INPUT"&&document.activeElement?.tagName!=="TEXTAREA"&&(e.preventDefault(),b.selection.length>0&&Re(b.selection))};window.addEventListener("keydown",t),Mt(()=>window.removeEventListener("keydown",t))}),(()=>{var t=ql();return T(t,v(rl,{}),null),T(t,v(Ul,{}),null),T(t,v(Al,{}),null),T(t,v(Tl,{}),null),T(t,v(bi,{}),null),t})()),Gl=document.getElementById("root");fs(()=>v(Bl,{}),Gl);
