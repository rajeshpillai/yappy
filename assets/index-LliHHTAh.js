(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(i){if(i.ep)return;i.ep=!0;const l=n(i);fetch(i.href,l)}})();const Vn=!1,Hn=(t,e)=>t===e,de=Symbol("solid-proxy"),gn=typeof Proxy=="function",Lt=Symbol("solid-track"),ut={equals:Hn};let yn=vn;const Me=1,dt=2,mn={owned:null,cleanups:null,context:null,owner:null};var Q=null;let Ot=null,Un=null,Z=null,ne=null,ve=null,$t=0;function rt(t,e){const n=Z,s=Q,i=t.length===0,l=e===void 0?s:e,a=i?mn:{owned:null,cleanups:null,context:l?l.context:null,owner:l},o=i?t:()=>t(()=>ge(()=>Ue(a)));Q=a,Z=null;try{return Fe(o,!0)}finally{Z=n,Q=s}}function ee(t,e){e=e?Object.assign({},ut,e):ut;const n={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},s=i=>(typeof i=="function"&&(i=i(n.value)),wn(n,i));return[bn.bind(n),s]}function B(t,e,n){const s=qt(t,e,!1,Me);Je(s)}function De(t,e,n){yn=Kn;const s=qt(t,e,!1,Me);s.user=!0,ve?ve.push(s):Je(s)}function ue(t,e,n){n=n?Object.assign({},ut,n):ut;const s=qt(t,e,!0,0);return s.observers=null,s.observerSlots=null,s.comparator=n.equals||void 0,Je(s),bn.bind(s)}function Bn(t){return Fe(t,!1)}function ge(t){if(Z===null)return t();const e=Z;Z=null;try{return t()}finally{Z=e}}function St(t){De(()=>ge(t))}function Mt(t){return Q===null||(Q.cleanups===null?Q.cleanups=[t]:Q.cleanups.push(t)),t}function It(){return Z}function bn(){if(this.sources&&this.state)if(this.state===Me)Je(this);else{const t=ne;ne=null,Fe(()=>pt(this),!1),ne=t}if(Z){const t=this.observers?this.observers.length:0;Z.sources?(Z.sources.push(this),Z.sourceSlots.push(t)):(Z.sources=[this],Z.sourceSlots=[t]),this.observers?(this.observers.push(Z),this.observerSlots.push(Z.sources.length-1)):(this.observers=[Z],this.observerSlots=[Z.sources.length-1])}return this.value}function wn(t,e,n){let s=t.value;return(!t.comparator||!t.comparator(s,e))&&(t.value=e,t.observers&&t.observers.length&&Fe(()=>{for(let i=0;i<t.observers.length;i+=1){const l=t.observers[i],a=Ot&&Ot.running;a&&Ot.disposed.has(l),(a?!l.tState:!l.state)&&(l.pure?ne.push(l):ve.push(l),l.observers&&kn(l)),a||(l.state=Me)}if(ne.length>1e6)throw ne=[],new Error},!1)),e}function Je(t){if(!t.fn)return;Ue(t);const e=$t;qn(t,t.value,e)}function qn(t,e,n){let s;const i=Q,l=Z;Z=Q=t;try{s=t.fn(e)}catch(a){return t.pure&&(t.state=Me,t.owned&&t.owned.forEach(Ue),t.owned=null),t.updatedAt=n+1,xn(a)}finally{Z=l,Q=i}(!t.updatedAt||t.updatedAt<=n)&&(t.updatedAt!=null&&"observers"in t?wn(t,s):t.value=s,t.updatedAt=n)}function qt(t,e,n,s=Me,i){const l={fn:t,state:s,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:Q,context:Q?Q.context:null,pure:n};return Q===null||Q!==mn&&(Q.owned?Q.owned.push(l):Q.owned=[l]),l}function ft(t){if(t.state===0)return;if(t.state===dt)return pt(t);if(t.suspense&&ge(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<$t);)t.state&&e.push(t);for(let n=e.length-1;n>=0;n--)if(t=e[n],t.state===Me)Je(t);else if(t.state===dt){const s=ne;ne=null,Fe(()=>pt(t,e[0]),!1),ne=s}}function Fe(t,e){if(ne)return t();let n=!1;e||(ne=[]),ve?n=!0:ve=[],$t++;try{const s=t();return Gn(n),s}catch(s){n||(ve=null),ne=null,xn(s)}}function Gn(t){if(ne&&(vn(ne),ne=null),t)return;const e=ve;ve=null,e.length&&Fe(()=>yn(e),!1)}function vn(t){for(let e=0;e<t.length;e++)ft(t[e])}function Kn(t){let e,n=0;for(e=0;e<t.length;e++){const s=t[e];s.user?t[n++]=s:ft(s)}for(e=0;e<n;e++)ft(t[e])}function pt(t,e){t.state=0;for(let n=0;n<t.sources.length;n+=1){const s=t.sources[n];if(s.sources){const i=s.state;i===Me?s!==e&&(!s.updatedAt||s.updatedAt<$t)&&ft(s):i===dt&&pt(s,e)}}}function kn(t){for(let e=0;e<t.observers.length;e+=1){const n=t.observers[e];n.state||(n.state=dt,n.pure?ne.push(n):ve.push(n),n.observers&&kn(n))}}function Ue(t){let e;if(t.sources)for(;t.sources.length;){const n=t.sources.pop(),s=t.sourceSlots.pop(),i=n.observers;if(i&&i.length){const l=i.pop(),a=n.observerSlots.pop();s<i.length&&(l.sourceSlots[a]=s,i[s]=l,n.observerSlots[s]=a)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)Ue(t.tOwned[e]);delete t.tOwned}if(t.owned){for(e=t.owned.length-1;e>=0;e--)Ue(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function Zn(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function xn(t,e=Q){throw Zn(t)}const Jn=Symbol("fallback");function tn(t){for(let e=0;e<t.length;e++)t[e]()}function Qn(t,e,n={}){let s=[],i=[],l=[],a=0,o=e.length>1?[]:null;return Mt(()=>tn(l)),()=>{let r=t()||[],h=r.length,c,u;return r[Lt],ge(()=>{let p,m,x,g,$,A,w,E,z;if(h===0)a!==0&&(tn(l),l=[],s=[],i=[],a=0,o&&(o=[])),n.fallback&&(s=[Jn],i[0]=rt(I=>(l[0]=I,n.fallback())),a=1);else if(a===0){for(i=new Array(h),u=0;u<h;u++)s[u]=r[u],i[u]=rt(d);a=h}else{for(x=new Array(h),g=new Array(h),o&&($=new Array(h)),A=0,w=Math.min(a,h);A<w&&s[A]===r[A];A++);for(w=a-1,E=h-1;w>=A&&E>=A&&s[w]===r[E];w--,E--)x[E]=i[w],g[E]=l[w],o&&($[E]=o[w]);for(p=new Map,m=new Array(E+1),u=E;u>=A;u--)z=r[u],c=p.get(z),m[u]=c===void 0?-1:c,p.set(z,u);for(c=A;c<=w;c++)z=s[c],u=p.get(z),u!==void 0&&u!==-1?(x[u]=i[c],g[u]=l[c],o&&($[u]=o[c]),u=m[u],p.set(z,u)):l[c]();for(u=A;u<h;u++)u in x?(i[u]=x[u],l[u]=g[u],o&&(o[u]=$[u],o[u](u))):i[u]=rt(d);i=i.slice(0,a=h),s=r.slice(0)}return i});function d(p){if(l[u]=p,o){const[m,x]=ee(u);return o[u]=x,e(r[u],m)}return e(r[u])}}}function k(t,e){return ge(()=>t(e||{}))}function nt(){return!0}const Dt={get(t,e,n){return e===de?n:t.get(e)},has(t,e){return e===de?!0:t.has(e)},set:nt,deleteProperty:nt,getOwnPropertyDescriptor(t,e){return{configurable:!0,enumerable:!0,get(){return t.get(e)},set:nt,deleteProperty:nt}},ownKeys(t){return t.keys()}};function Tt(t){return(t=typeof t=="function"?t():t)?t:{}}function es(){for(let t=0,e=this.length;t<e;++t){const n=this[t]();if(n!==void 0)return n}}function j(...t){let e=!1;for(let a=0;a<t.length;a++){const o=t[a];e=e||!!o&&de in o,t[a]=typeof o=="function"?(e=!0,ue(o)):o}if(gn&&e)return new Proxy({get(a){for(let o=t.length-1;o>=0;o--){const r=Tt(t[o])[a];if(r!==void 0)return r}},has(a){for(let o=t.length-1;o>=0;o--)if(a in Tt(t[o]))return!0;return!1},keys(){const a=[];for(let o=0;o<t.length;o++)a.push(...Object.keys(Tt(t[o])));return[...new Set(a)]}},Dt);const n={},s=Object.create(null);for(let a=t.length-1;a>=0;a--){const o=t[a];if(!o)continue;const r=Object.getOwnPropertyNames(o);for(let h=r.length-1;h>=0;h--){const c=r[h];if(c==="__proto__"||c==="constructor")continue;const u=Object.getOwnPropertyDescriptor(o,c);if(!s[c])s[c]=u.get?{enumerable:!0,configurable:!0,get:es.bind(n[c]=[u.get.bind(o)])}:u.value!==void 0?u:void 0;else{const d=n[c];d&&(u.get?d.push(u.get.bind(o)):u.value!==void 0&&d.push(()=>u.value))}}}const i={},l=Object.keys(s);for(let a=l.length-1;a>=0;a--){const o=l[a],r=s[o];r&&r.get?Object.defineProperty(i,o,r):i[o]=r?r.value:void 0}return i}function $n(t,...e){const n=e.length;if(gn&&de in t){const i=n>1?e.flat():e[0],l=e.map(a=>new Proxy({get(o){return a.includes(o)?t[o]:void 0},has(o){return a.includes(o)&&o in t},keys(){return a.filter(o=>o in t)}},Dt));return l.push(new Proxy({get(a){return i.includes(a)?void 0:t[a]},has(a){return i.includes(a)?!1:a in t},keys(){return Object.keys(t).filter(a=>!i.includes(a))}},Dt)),l}const s=[];for(let i=0;i<=n;i++)s[i]={};for(const i of Object.getOwnPropertyNames(t)){let l=n;for(let r=0;r<e.length;r++)if(e[r].includes(i)){l=r;break}const a=Object.getOwnPropertyDescriptor(t,i);!a.get&&!a.set&&a.enumerable&&a.writable&&a.configurable?s[l][i]=a.value:Object.defineProperty(s[l],i,a)}return s}const ts=t=>`Stale read from <${t}>.`;function Ie(t){const e="fallback"in t&&{fallback:()=>t.fallback};return ue(Qn(()=>t.each,t.children,e||void 0))}function re(t){const e=t.keyed,n=ue(()=>t.when,void 0,void 0),s=e?n:ue(n,void 0,{equals:(i,l)=>!i==!l});return ue(()=>{const i=s();if(i){const l=t.children;return typeof l=="function"&&l.length>0?ge(()=>l(e?i:()=>{if(!ge(s))throw ts("Show");return n()})):l}return t.fallback},void 0,void 0)}const ns=["allowfullscreen","async","alpha","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected","adauctionheaders","browsingtopics","credentialless","defaultchecked","defaultmuted","defaultselected","defer","disablepictureinpicture","disableremoteplayback","preservespitch","shadowrootclonable","shadowrootcustomelementregistry","shadowrootdelegatesfocus","shadowrootserializable","sharedstoragewritable"],ss=new Set(["className","value","readOnly","noValidate","formNoValidate","isMap","noModule","playsInline","adAuctionHeaders","allowFullscreen","browsingTopics","defaultChecked","defaultMuted","defaultSelected","disablePictureInPicture","disableRemotePlayback","preservesPitch","shadowRootClonable","shadowRootCustomElementRegistry","shadowRootDelegatesFocus","shadowRootSerializable","sharedStorageWritable",...ns]),is=new Set(["innerHTML","textContent","innerText","children"]),ls=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),os=Object.assign(Object.create(null),{class:"className",novalidate:{$:"noValidate",FORM:1},formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1},adauctionheaders:{$:"adAuctionHeaders",IFRAME:1},allowfullscreen:{$:"allowFullscreen",IFRAME:1},browsingtopics:{$:"browsingTopics",IMG:1},defaultchecked:{$:"defaultChecked",INPUT:1},defaultmuted:{$:"defaultMuted",AUDIO:1,VIDEO:1},defaultselected:{$:"defaultSelected",OPTION:1},disablepictureinpicture:{$:"disablePictureInPicture",VIDEO:1},disableremoteplayback:{$:"disableRemotePlayback",AUDIO:1,VIDEO:1},preservespitch:{$:"preservesPitch",AUDIO:1,VIDEO:1},shadowrootclonable:{$:"shadowRootClonable",TEMPLATE:1},shadowrootdelegatesfocus:{$:"shadowRootDelegatesFocus",TEMPLATE:1},shadowrootserializable:{$:"shadowRootSerializable",TEMPLATE:1},sharedstoragewritable:{$:"sharedStorageWritable",IFRAME:1,IMG:1}});function as(t,e){const n=os[t];return typeof n=="object"?n[e]?n.$:void 0:n}const rs=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),cs=new Set(["altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignObject","g","glyph","glyphRef","hkern","image","line","linearGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","set","stop","svg","switch","symbol","text","textPath","tref","tspan","use","view","vkern"]),hs={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"},_t=t=>ue(()=>t());function us(t,e,n){let s=n.length,i=e.length,l=s,a=0,o=0,r=e[i-1].nextSibling,h=null;for(;a<i||o<l;){if(e[a]===n[o]){a++,o++;continue}for(;e[i-1]===n[l-1];)i--,l--;if(i===a){const c=l<s?o?n[o-1].nextSibling:n[l-o]:r;for(;o<l;)t.insertBefore(n[o++],c)}else if(l===o)for(;a<i;)(!h||!h.has(e[a]))&&e[a].remove(),a++;else if(e[a]===n[l-1]&&n[o]===e[i-1]){const c=e[--i].nextSibling;t.insertBefore(n[o++],e[a++].nextSibling),t.insertBefore(n[--l],c),e[i]=n[l]}else{if(!h){h=new Map;let u=o;for(;u<l;)h.set(n[u],u++)}const c=h.get(e[a]);if(c!=null)if(o<c&&c<l){let u=a,d=1,p;for(;++u<i&&u<l&&!((p=h.get(e[u]))==null||p!==c+d);)d++;if(d>c-o){const m=e[a];for(;o<c;)t.insertBefore(n[o++],m)}else t.replaceChild(n[o++],e[a++])}else a++;else e[a++].remove()}}}const nn="_$DX_DELEGATE";function ds(t,e,n,s={}){let i;return rt(l=>{i=l,e===document?t():O(e,t(),e.firstChild?null:void 0,n)},s.owner),()=>{i(),e.textContent=""}}function D(t,e,n,s){let i;const l=()=>{const o=document.createElement("template");return o.innerHTML=t,o.content.firstChild},a=()=>(i||(i=l())).cloneNode(!0);return a.cloneNode=a,a}function ke(t,e=window.document){const n=e[nn]||(e[nn]=new Set);for(let s=0,i=t.length;s<i;s++){const l=t[s];n.has(l)||(n.add(l),e.addEventListener(l,ws))}}function $e(t,e,n){n==null?t.removeAttribute(e):t.setAttribute(e,n)}function fs(t,e,n,s){s==null?t.removeAttributeNS(e,n):t.setAttributeNS(e,n,s)}function ps(t,e,n){n?t.setAttribute(e,""):t.removeAttribute(e)}function Pe(t,e){e==null?t.removeAttribute("class"):t.className=e}function he(t,e,n,s){if(s)Array.isArray(n)?(t[`$$${e}`]=n[0],t[`$$${e}Data`]=n[1]):t[`$$${e}`]=n;else if(Array.isArray(n)){const i=n[0];t.addEventListener(e,n[0]=l=>i.call(t,n[1],l))}else t.addEventListener(e,n,typeof n!="function"&&n)}function gs(t,e,n={}){const s=Object.keys(e||{}),i=Object.keys(n);let l,a;for(l=0,a=i.length;l<a;l++){const o=i[l];!o||o==="undefined"||e[o]||(sn(t,o,!1),delete n[o])}for(l=0,a=s.length;l<a;l++){const o=s[l],r=!!e[o];!o||o==="undefined"||n[o]===r||!r||(sn(t,o,!0),n[o]=r)}return n}function ys(t,e,n){if(!e)return n?$e(t,"style"):e;const s=t.style;if(typeof e=="string")return s.cssText=e;typeof n=="string"&&(s.cssText=n=void 0),n||(n={}),e||(e={});let i,l;for(l in n)e[l]==null&&s.removeProperty(l),delete n[l];for(l in e)i=e[l],i!==n[l]&&(s.setProperty(l,i),n[l]=i);return n}function ze(t,e,n){n!=null?t.style.setProperty(e,n):t.style.removeProperty(e)}function Sn(t,e={},n,s){const i={};return s||B(()=>i.children=qe(t,e.children,i.children)),B(()=>typeof e.ref=="function"&&Be(e.ref,t)),B(()=>ms(t,e,n,!0,i,!0)),i}function Be(t,e,n){return ge(()=>t(e,n))}function O(t,e,n,s){if(n!==void 0&&!s&&(s=[]),typeof e!="function")return qe(t,e,s,n);B(i=>qe(t,e(),i,n),s)}function ms(t,e,n,s,i={},l=!1){e||(e={});for(const a in i)if(!(a in e)){if(a==="children")continue;i[a]=ln(t,a,null,i[a],n,l,e)}for(const a in e){if(a==="children")continue;const o=e[a];i[a]=ln(t,a,o,i[a],n,l,e)}}function bs(t){return t.toLowerCase().replace(/-([a-z])/g,(e,n)=>n.toUpperCase())}function sn(t,e,n){const s=e.trim().split(/\s+/);for(let i=0,l=s.length;i<l;i++)t.classList.toggle(s[i],n)}function ln(t,e,n,s,i,l,a){let o,r,h,c,u;if(e==="style")return ys(t,n,s);if(e==="classList")return gs(t,n,s);if(n===s)return s;if(e==="ref")l||n(t);else if(e.slice(0,3)==="on:"){const d=e.slice(3);s&&t.removeEventListener(d,s,typeof s!="function"&&s),n&&t.addEventListener(d,n,typeof n!="function"&&n)}else if(e.slice(0,10)==="oncapture:"){const d=e.slice(10);s&&t.removeEventListener(d,s,!0),n&&t.addEventListener(d,n,!0)}else if(e.slice(0,2)==="on"){const d=e.slice(2).toLowerCase(),p=rs.has(d);if(!p&&s){const m=Array.isArray(s)?s[0]:s;t.removeEventListener(d,m)}(p||n)&&(he(t,d,n,p),p&&ke([d]))}else if(e.slice(0,5)==="attr:")$e(t,e.slice(5),n);else if(e.slice(0,5)==="bool:")ps(t,e.slice(5),n);else if((u=e.slice(0,5)==="prop:")||(h=is.has(e))||!i&&((c=as(e,t.tagName))||(r=ss.has(e)))||(o=t.nodeName.includes("-")||"is"in a))u&&(e=e.slice(5),r=!0),e==="class"||e==="className"?Pe(t,n):o&&!r&&!h?t[bs(e)]=n:t[c||e]=n;else{const d=i&&e.indexOf(":")>-1&&hs[e.split(":")[0]];d?fs(t,d,e,n):$e(t,ls[e]||e,n)}return n}function ws(t){let e=t.target;const n=`$$${t.type}`,s=t.target,i=t.currentTarget,l=r=>Object.defineProperty(t,"target",{configurable:!0,value:r}),a=()=>{const r=e[n];if(r&&!e.disabled){const h=e[`${n}Data`];if(h!==void 0?r.call(e,h,t):r.call(e,t),t.cancelBubble)return}return e.host&&typeof e.host!="string"&&!e.host._$host&&e.contains(t.target)&&l(e.host),!0},o=()=>{for(;a()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return e||document}}),t.composedPath){const r=t.composedPath();l(r[0]);for(let h=0;h<r.length-2&&(e=r[h],!!a());h++){if(e._$host){e=e._$host,o();break}if(e.parentNode===i)break}}else o();l(s)}function qe(t,e,n,s,i){for(;typeof n=="function";)n=n();if(e===n)return n;const l=typeof e,a=s!==void 0;if(t=a&&n[0]&&n[0].parentNode||t,l==="string"||l==="number"){if(l==="number"&&(e=e.toString(),e===n))return n;if(a){let o=n[0];o&&o.nodeType===3?o.data!==e&&(o.data=e):o=document.createTextNode(e),n=Ee(t,n,s,o)}else n!==""&&typeof n=="string"?n=t.firstChild.data=e:n=t.textContent=e}else if(e==null||l==="boolean")n=Ee(t,n,s);else{if(l==="function")return B(()=>{let o=e();for(;typeof o=="function";)o=o();n=qe(t,o,n,s)}),()=>n;if(Array.isArray(e)){const o=[],r=n&&Array.isArray(n);if(Rt(o,e,n,i))return B(()=>n=qe(t,o,n,s,!0)),()=>n;if(o.length===0){if(n=Ee(t,n,s),a)return n}else r?n.length===0?on(t,o,s):us(t,n,o):(n&&Ee(t),on(t,o));n=o}else if(e.nodeType){if(Array.isArray(n)){if(a)return n=Ee(t,n,s,e);Ee(t,n,null,e)}else n==null||n===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);n=e}}return n}function Rt(t,e,n,s){let i=!1;for(let l=0,a=e.length;l<a;l++){let o=e[l],r=n&&n[t.length],h;if(!(o==null||o===!0||o===!1))if((h=typeof o)=="object"&&o.nodeType)t.push(o);else if(Array.isArray(o))i=Rt(t,o,r)||i;else if(h==="function")if(s){for(;typeof o=="function";)o=o();i=Rt(t,Array.isArray(o)?o:[o],Array.isArray(r)?r:[r])||i}else t.push(o),i=!0;else{const c=String(o);r&&r.nodeType===3&&r.data===c?t.push(r):t.push(document.createTextNode(c))}}return i}function on(t,e,n=null){for(let s=0,i=e.length;s<i;s++)t.insertBefore(e[s],n)}function Ee(t,e,n,s){if(n===void 0)return t.textContent="";const i=s||document.createTextNode("");if(e.length){let l=!1;for(let a=e.length-1;a>=0;a--){const o=e[a];if(i!==o){const r=o.parentNode===t;!l&&!a?r?t.replaceChild(i,o):t.insertBefore(i,n):r&&o.remove()}else l=!0}}else t.insertBefore(i,n);return[i]}const vs="http://www.w3.org/2000/svg";function ks(t,e=!1,n=void 0){return e?document.createElementNS(vs,t):document.createElement(t,{is:n})}function xs(t,e){const n=ue(t);return ue(()=>{const s=n();switch(typeof s){case"function":return ge(()=>s(e));case"string":const i=cs.has(s),l=ks(s,i,ge(()=>e.is));return Sn(l,e,i),l}})}function $s(t){const[,e]=$n(t,["component"]);return xs(()=>t.component,e)}const jt=Symbol("store-raw"),Re=Symbol("store-node"),be=Symbol("store-has"),Mn=Symbol("store-self");function _n(t){let e=t[de];if(!e&&(Object.defineProperty(t,de,{value:e=new Proxy(t,_s)}),!Array.isArray(t))){const n=Object.keys(t),s=Object.getOwnPropertyDescriptors(t);for(let i=0,l=n.length;i<l;i++){const a=n[i];s[a].get&&Object.defineProperty(t,a,{enumerable:s[a].enumerable,get:s[a].get.bind(e)})}}return e}function gt(t){let e;return t!=null&&typeof t=="object"&&(t[de]||!(e=Object.getPrototypeOf(t))||e===Object.prototype||Array.isArray(t))}function Ge(t,e=new Set){let n,s,i,l;if(n=t!=null&&t[jt])return n;if(!gt(t)||e.has(t))return t;if(Array.isArray(t)){Object.isFrozen(t)?t=t.slice(0):e.add(t);for(let a=0,o=t.length;a<o;a++)i=t[a],(s=Ge(i,e))!==i&&(t[a]=s)}else{Object.isFrozen(t)?t=Object.assign({},t):e.add(t);const a=Object.keys(t),o=Object.getOwnPropertyDescriptors(t);for(let r=0,h=a.length;r<h;r++)l=a[r],!o[l].get&&(i=t[l],(s=Ge(i,e))!==i&&(t[l]=s))}return t}function yt(t,e){let n=t[e];return n||Object.defineProperty(t,e,{value:n=Object.create(null)}),n}function Ke(t,e,n){if(t[e])return t[e];const[s,i]=ee(n,{equals:!1,internal:!0});return s.$=i,t[e]=s}function Ss(t,e){const n=Reflect.getOwnPropertyDescriptor(t,e);return!n||n.get||!n.configurable||e===de||e===Re||(delete n.value,delete n.writable,n.get=()=>t[de][e]),n}function Cn(t){It()&&Ke(yt(t,Re),Mn)()}function Ms(t){return Cn(t),Reflect.ownKeys(t)}const _s={get(t,e,n){if(e===jt)return t;if(e===de)return n;if(e===Lt)return Cn(t),n;const s=yt(t,Re),i=s[e];let l=i?i():t[e];if(e===Re||e===be||e==="__proto__")return l;if(!i){const a=Object.getOwnPropertyDescriptor(t,e);It()&&(typeof l!="function"||t.hasOwnProperty(e))&&!(a&&a.get)&&(l=Ke(s,e,l)())}return gt(l)?_n(l):l},has(t,e){return e===jt||e===de||e===Lt||e===Re||e===be||e==="__proto__"?!0:(It()&&Ke(yt(t,be),e)(),e in t)},set(){return!0},deleteProperty(){return!0},ownKeys:Ms,getOwnPropertyDescriptor:Ss};function mt(t,e,n,s=!1){if(!s&&t[e]===n)return;const i=t[e],l=t.length;n===void 0?(delete t[e],t[be]&&t[be][e]&&i!==void 0&&t[be][e].$()):(t[e]=n,t[be]&&t[be][e]&&i===void 0&&t[be][e].$());let a=yt(t,Re),o;if((o=Ke(a,e,i))&&o.$(()=>n),Array.isArray(t)&&t.length!==l){for(let r=t.length;r<l;r++)(o=a[r])&&o.$();(o=Ke(a,"length",l))&&o.$(t.length)}(o=a[Mn])&&o.$()}function Pn(t,e){const n=Object.keys(e);for(let s=0;s<n.length;s+=1){const i=n[s];mt(t,i,e[i])}}function Cs(t,e){if(typeof e=="function"&&(e=e(t)),e=Ge(e),Array.isArray(e)){if(t===e)return;let n=0,s=e.length;for(;n<s;n++){const i=e[n];t[n]!==i&&mt(t,n,i)}mt(t,"length",s)}else Pn(t,e)}function He(t,e,n=[]){let s,i=t;if(e.length>1){s=e.shift();const a=typeof s,o=Array.isArray(t);if(Array.isArray(s)){for(let r=0;r<s.length;r++)He(t,[s[r]].concat(e),n);return}else if(o&&a==="function"){for(let r=0;r<t.length;r++)s(t[r],r)&&He(t,[r].concat(e),n);return}else if(o&&a==="object"){const{from:r=0,to:h=t.length-1,by:c=1}=s;for(let u=r;u<=h;u+=c)He(t,[u].concat(e),n);return}else if(e.length>1){He(t[s],e,[s].concat(n));return}i=t[s],n=[s].concat(n)}let l=e[0];typeof l=="function"&&(l=l(i,n),l===i)||s===void 0&&l==null||(l=Ge(l),s===void 0||gt(i)&&gt(l)&&!Array.isArray(l)?Pn(i,l):mt(t,s,l))}function Ps(...[t,e]){const n=Ge(t||{}),s=Array.isArray(n),i=_n(n);function l(...a){Bn(()=>{s&&a.length===1?Cs(n,a[0]):He(n,a)})}return[i,l]}const An={elements:[],viewState:{scale:1,panX:0,panY:0},selectedTool:"selection",selection:[],defaultElementStyles:{strokeColor:"#000000",backgroundColor:"transparent",fillStyle:"hachure",strokeWidth:1,strokeStyle:"solid",roughness:1,renderStyle:"sketch",opacity:100,angle:0,roundness:null,locked:!1,fontFamily:1,fontSize:20,textAlign:"left",startArrowhead:null,endArrowhead:"arrow",seed:0},theme:localStorage.getItem("theme")||"light"},[b,V]=Ps(An),Ae=[],Ze=[],Oe=()=>{const t=JSON.parse(JSON.stringify(b.elements));Ae.push(t),Ae.length>50&&Ae.shift(),Ze.length=0},On=()=>{if(Ae.length===0)return;const t=JSON.parse(JSON.stringify(b.elements));Ze.push(t);const e=Ae.pop();e&&V("elements",e)},Ft=()=>{if(Ze.length===0)return;const t=JSON.parse(JSON.stringify(b.elements));Ae.push(t);const e=Ze.pop();e&&V("elements",e)},Xt=t=>{Oe(),V("elements",e=>[...e,t])},je=t=>{t.length!==0&&(Oe(),V("elements",e=>e.filter(n=>!t.includes(n.id))),V("selection",[]))},pe=(t,e,n=!1)=>{n&&Oe(),V("elements",s=>s.id===t,e)},we=t=>{V("viewState",e=>({...e,...t}))},As=t=>{V("selectedTool",t)},Os=t=>{V("defaultElementStyles",e=>({...e,...t}))},Ts=()=>{Ae.length=0,Ze.length=0},Es=t=>{const e=b.elements.find(l=>l.id===t);if(!e)return;Oe();const n=crypto.randomUUID(),s=10/b.viewState.scale,i={...e,id:n,x:e.x+s,y:e.y+s,points:e.points?e.points.map(l=>({...l})):void 0,roundness:e.roundness?{...e.roundness}:null,crop:e.crop?{...e.crop}:null,boundElements:null,groupIds:e.groupIds?[...e.groupIds]:void 0,seed:Math.floor(Math.random()*2147483647)};V("elements",l=>[...l,i]),V("selection",[n])},st=(t,e)=>{const n=b.elements.findIndex(s=>s.id===t);n!==-1&&(Oe(),V("elements",s=>{const i=[...s],l=i.splice(n,1)[0];if(e==="front")i.push(l);else if(e==="back")i.unshift(l);else if(e==="forward"){const a=Math.min(i.length,n+1);i.splice(a,0,l)}else if(e==="backward"){const a=Math.max(0,n-1);i.splice(a,0,l)}return i}))},Ns=()=>{const t=b.theme==="light"?"dark":"light";V("theme",t),localStorage.setItem("theme",t),document.documentElement.setAttribute("data-theme",t)},zs=()=>{if(b.elements.length===0){V("viewState",{scale:1,panX:0,panY:0});return}let t=1/0,e=1/0,n=-1/0,s=-1/0;b.elements.forEach(g=>{t=Math.min(t,g.x),n=Math.max(n,g.x+g.width),e=Math.min(e,g.y),s=Math.max(s,g.y+g.height)});const i=n-t,l=s-e;if(i===0&&l===0){const g=t,$=e,A=window.innerWidth/2,w=window.innerHeight/2;V("viewState",{scale:1,panX:-g+A,panY:-$+w});return}const a=50,o=window.innerWidth,r=window.innerHeight,h=(o-a*2)/i,c=(r-a*2)/l;let u=Math.min(h,c);u=Math.min(Math.max(u,.1),2);const d=t+i/2,p=e+l/2,m=o/2,x=r/2;V("viewState",{scale:u,panX:-d*u+m,panY:-p*u+x})};document.documentElement.setAttribute("data-theme",An.theme);function Yt(t,e,n){if(t&&t.length){const[s,i]=e,l=Math.PI/180*n,a=Math.cos(l),o=Math.sin(l);for(const r of t){const[h,c]=r;r[0]=(h-s)*a-(c-i)*o+s,r[1]=(h-s)*o+(c-i)*a+i}}}function Ls(t,e,n){const s=[];t.forEach(i=>s.push(...i)),Yt(s,e,n)}function Is(t,e){return t[0]===e[0]&&t[1]===e[1]}function Ds(t,e,n,s=1){const i=n,l=Math.max(e,.1),a=t[0]&&t[0][0]&&typeof t[0][0]=="number"?[t]:t,o=[0,0];if(i)for(const h of a)Yt(h,o,i);const r=Rs(a,l,s);if(i){for(const h of a)Yt(h,o,-i);Ls(r,o,-i)}return r}function Rs(t,e,n){const s=[];for(const h of t){const c=[...h];Is(c[0],c[c.length-1])||c.push([c[0][0],c[0][1]]),c.length>2&&s.push(c)}const i=[];e=Math.max(e,.1);const l=[];for(const h of s)for(let c=0;c<h.length-1;c++){const u=h[c],d=h[c+1];if(u[1]!==d[1]){const p=Math.min(u[1],d[1]);l.push({ymin:p,ymax:Math.max(u[1],d[1]),x:p===u[1]?u[0]:d[0],islope:(d[0]-u[0])/(d[1]-u[1])})}}if(l.sort((h,c)=>h.ymin<c.ymin?-1:h.ymin>c.ymin?1:h.x<c.x?-1:h.x>c.x?1:h.ymax===c.ymax?0:(h.ymax-c.ymax)/Math.abs(h.ymax-c.ymax)),!l.length)return i;let a=[],o=l[0].ymin,r=0;for(;a.length||l.length;){if(l.length){let h=-1;for(let u=0;u<l.length&&!(l[u].ymin>o);u++)h=u;l.splice(0,h+1).forEach(u=>{a.push({s:o,edge:u})})}if(a=a.filter(h=>!(h.edge.ymax<=o)),a.sort((h,c)=>h.edge.x===c.edge.x?0:(h.edge.x-c.edge.x)/Math.abs(h.edge.x-c.edge.x)),(n!==1||r%e===0)&&a.length>1)for(let h=0;h<a.length;h=h+2){const c=h+1;if(c>=a.length)break;const u=a[h].edge,d=a[c].edge;i.push([[Math.round(u.x),o],[Math.round(d.x),o]])}o+=n,a.forEach(h=>{h.edge.x=h.edge.x+n*h.edge.islope}),r++}return i}function Qe(t,e){var n;const s=e.hachureAngle+90;let i=e.hachureGap;i<0&&(i=e.strokeWidth*4),i=Math.round(Math.max(i,.1));let l=1;return e.roughness>=1&&(((n=e.randomizer)===null||n===void 0?void 0:n.next())||Math.random())>.7&&(l=i),Ds(t,i,s,l||1)}class Gt{constructor(e){this.helper=e}fillPolygons(e,n){return this._fillPolygons(e,n)}_fillPolygons(e,n){const s=Qe(e,n);return{type:"fillSketch",ops:this.renderLines(s,n)}}renderLines(e,n){const s=[];for(const i of e)s.push(...this.helper.doubleLineOps(i[0][0],i[0][1],i[1][0],i[1][1],n));return s}}function Ct(t){const e=t[0],n=t[1];return Math.sqrt(Math.pow(e[0]-n[0],2)+Math.pow(e[1]-n[1],2))}class js extends Gt{fillPolygons(e,n){let s=n.hachureGap;s<0&&(s=n.strokeWidth*4),s=Math.max(s,.1);const i=Object.assign({},n,{hachureGap:s}),l=Qe(e,i),a=Math.PI/180*n.hachureAngle,o=[],r=s*.5*Math.cos(a),h=s*.5*Math.sin(a);for(const[u,d]of l)Ct([u,d])&&o.push([[u[0]-r,u[1]+h],[...d]],[[u[0]+r,u[1]-h],[...d]]);return{type:"fillSketch",ops:this.renderLines(o,n)}}}class Fs extends Gt{fillPolygons(e,n){const s=this._fillPolygons(e,n),i=Object.assign({},n,{hachureAngle:n.hachureAngle+90}),l=this._fillPolygons(e,i);return s.ops=s.ops.concat(l.ops),s}}class Xs{constructor(e){this.helper=e}fillPolygons(e,n){n=Object.assign({},n,{hachureAngle:0});const s=Qe(e,n);return this.dotsOnLines(s,n)}dotsOnLines(e,n){const s=[];let i=n.hachureGap;i<0&&(i=n.strokeWidth*4),i=Math.max(i,.1);let l=n.fillWeight;l<0&&(l=n.strokeWidth/2);const a=i/4;for(const o of e){const r=Ct(o),h=r/i,c=Math.ceil(h)-1,u=r-c*i,d=(o[0][0]+o[1][0])/2-i/4,p=Math.min(o[0][1],o[1][1]);for(let m=0;m<c;m++){const x=p+u+m*i,g=d-a+Math.random()*2*a,$=x-a+Math.random()*2*a,A=this.helper.ellipse(g,$,l,l,n);s.push(...A.ops)}}return{type:"fillSketch",ops:s}}}class Ys{constructor(e){this.helper=e}fillPolygons(e,n){const s=Qe(e,n);return{type:"fillSketch",ops:this.dashedLine(s,n)}}dashedLine(e,n){const s=n.dashOffset<0?n.hachureGap<0?n.strokeWidth*4:n.hachureGap:n.dashOffset,i=n.dashGap<0?n.hachureGap<0?n.strokeWidth*4:n.hachureGap:n.dashGap,l=[];return e.forEach(a=>{const o=Ct(a),r=Math.floor(o/(s+i)),h=(o+i-r*(s+i))/2;let c=a[0],u=a[1];c[0]>u[0]&&(c=a[1],u=a[0]);const d=Math.atan((u[1]-c[1])/(u[0]-c[0]));for(let p=0;p<r;p++){const m=p*(s+i),x=m+s,g=[c[0]+m*Math.cos(d)+h*Math.cos(d),c[1]+m*Math.sin(d)+h*Math.sin(d)],$=[c[0]+x*Math.cos(d)+h*Math.cos(d),c[1]+x*Math.sin(d)+h*Math.sin(d)];l.push(...this.helper.doubleLineOps(g[0],g[1],$[0],$[1],n))}}),l}}class Ws{constructor(e){this.helper=e}fillPolygons(e,n){const s=n.hachureGap<0?n.strokeWidth*4:n.hachureGap,i=n.zigzagOffset<0?s:n.zigzagOffset;n=Object.assign({},n,{hachureGap:s+i});const l=Qe(e,n);return{type:"fillSketch",ops:this.zigzagLines(l,i,n)}}zigzagLines(e,n,s){const i=[];return e.forEach(l=>{const a=Ct(l),o=Math.round(a/(2*n));let r=l[0],h=l[1];r[0]>h[0]&&(r=l[1],h=l[0]);const c=Math.atan((h[1]-r[1])/(h[0]-r[0]));for(let u=0;u<o;u++){const d=u*2*n,p=(u+1)*2*n,m=Math.sqrt(2*Math.pow(n,2)),x=[r[0]+d*Math.cos(c),r[1]+d*Math.sin(c)],g=[r[0]+p*Math.cos(c),r[1]+p*Math.sin(c)],$=[x[0]+m*Math.cos(c+Math.PI/4),x[1]+m*Math.sin(c+Math.PI/4)];i.push(...this.helper.doubleLineOps(x[0],x[1],$[0],$[1],s),...this.helper.doubleLineOps($[0],$[1],g[0],g[1],s))}}),i}}const le={};function Vs(t,e){let n=t.fillStyle||"hachure";if(!le[n])switch(n){case"zigzag":le[n]||(le[n]=new js(e));break;case"cross-hatch":le[n]||(le[n]=new Fs(e));break;case"dots":le[n]||(le[n]=new Xs(e));break;case"dashed":le[n]||(le[n]=new Ys(e));break;case"zigzag-line":le[n]||(le[n]=new Ws(e));break;default:n="hachure",le[n]||(le[n]=new Gt(e));break}return le[n]}function Hs(){return Math.floor(Math.random()*2**31)}class Us{constructor(e){this.seed=e}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}}const Bs=0,Wt=1,Tn=2,it={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function qs(t){const e=new Array;for(;t!=="";)if(t.match(/^([ \t\r\n,]+)/))t=t.substr(RegExp.$1.length);else if(t.match(/^([aAcChHlLmMqQsStTvVzZ])/))e[e.length]={type:Bs,text:RegExp.$1},t=t.substr(RegExp.$1.length);else if(t.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))e[e.length]={type:Wt,text:`${parseFloat(RegExp.$1)}`},t=t.substr(RegExp.$1.length);else return[];return e[e.length]={type:Tn,text:""},e}function Et(t,e){return t.type===e}function Kt(t){const e=[],n=qs(t);let s="BOD",i=0,l=n[i];for(;!Et(l,Tn);){let a=0;const o=[];if(s==="BOD")if(l.text==="M"||l.text==="m")i++,a=it[l.text],s=l.text;else return Kt("M0,0"+t);else Et(l,Wt)?a=it[s]:(i++,a=it[l.text],s=l.text);if(i+a<n.length){for(let r=i;r<i+a;r++){const h=n[r];if(Et(h,Wt))o[o.length]=+h.text;else throw new Error("Param not a number: "+s+","+h.text)}if(typeof it[s]=="number"){const r={key:s,data:o};e.push(r),i+=a,l=n[i],s==="M"&&(s="L"),s==="m"&&(s="l")}else throw new Error("Bad segment: "+s)}else throw new Error("Path data ended short")}return e}function En(t){let e=0,n=0,s=0,i=0;const l=[];for(const{key:a,data:o}of t)switch(a){case"M":l.push({key:"M",data:[...o]}),[e,n]=o,[s,i]=o;break;case"m":e+=o[0],n+=o[1],l.push({key:"M",data:[e,n]}),s=e,i=n;break;case"L":l.push({key:"L",data:[...o]}),[e,n]=o;break;case"l":e+=o[0],n+=o[1],l.push({key:"L",data:[e,n]});break;case"C":l.push({key:"C",data:[...o]}),e=o[4],n=o[5];break;case"c":{const r=o.map((h,c)=>c%2?h+n:h+e);l.push({key:"C",data:r}),e=r[4],n=r[5];break}case"Q":l.push({key:"Q",data:[...o]}),e=o[2],n=o[3];break;case"q":{const r=o.map((h,c)=>c%2?h+n:h+e);l.push({key:"Q",data:r}),e=r[2],n=r[3];break}case"A":l.push({key:"A",data:[...o]}),e=o[5],n=o[6];break;case"a":e+=o[5],n+=o[6],l.push({key:"A",data:[o[0],o[1],o[2],o[3],o[4],e,n]});break;case"H":l.push({key:"H",data:[...o]}),e=o[0];break;case"h":e+=o[0],l.push({key:"H",data:[e]});break;case"V":l.push({key:"V",data:[...o]}),n=o[0];break;case"v":n+=o[0],l.push({key:"V",data:[n]});break;case"S":l.push({key:"S",data:[...o]}),e=o[2],n=o[3];break;case"s":{const r=o.map((h,c)=>c%2?h+n:h+e);l.push({key:"S",data:r}),e=r[2],n=r[3];break}case"T":l.push({key:"T",data:[...o]}),e=o[0],n=o[1];break;case"t":e+=o[0],n+=o[1],l.push({key:"T",data:[e,n]});break;case"Z":case"z":l.push({key:"Z",data:[]}),e=s,n=i;break}return l}function Nn(t){const e=[];let n="",s=0,i=0,l=0,a=0,o=0,r=0;for(const{key:h,data:c}of t){switch(h){case"M":e.push({key:"M",data:[...c]}),[s,i]=c,[l,a]=c;break;case"C":e.push({key:"C",data:[...c]}),s=c[4],i=c[5],o=c[2],r=c[3];break;case"L":e.push({key:"L",data:[...c]}),[s,i]=c;break;case"H":s=c[0],e.push({key:"L",data:[s,i]});break;case"V":i=c[0],e.push({key:"L",data:[s,i]});break;case"S":{let u=0,d=0;n==="C"||n==="S"?(u=s+(s-o),d=i+(i-r)):(u=s,d=i),e.push({key:"C",data:[u,d,...c]}),o=c[0],r=c[1],s=c[2],i=c[3];break}case"T":{const[u,d]=c;let p=0,m=0;n==="Q"||n==="T"?(p=s+(s-o),m=i+(i-r)):(p=s,m=i);const x=s+2*(p-s)/3,g=i+2*(m-i)/3,$=u+2*(p-u)/3,A=d+2*(m-d)/3;e.push({key:"C",data:[x,g,$,A,u,d]}),o=p,r=m,s=u,i=d;break}case"Q":{const[u,d,p,m]=c,x=s+2*(u-s)/3,g=i+2*(d-i)/3,$=p+2*(u-p)/3,A=m+2*(d-m)/3;e.push({key:"C",data:[x,g,$,A,p,m]}),o=u,r=d,s=p,i=m;break}case"A":{const u=Math.abs(c[0]),d=Math.abs(c[1]),p=c[2],m=c[3],x=c[4],g=c[5],$=c[6];u===0||d===0?(e.push({key:"C",data:[s,i,g,$,g,$]}),s=g,i=$):(s!==g||i!==$)&&(zn(s,i,g,$,u,d,p,m,x).forEach(function(w){e.push({key:"C",data:w})}),s=g,i=$);break}case"Z":e.push({key:"Z",data:[]}),s=l,i=a;break}n=h}return e}function Gs(t){return Math.PI*t/180}function We(t,e,n){const s=t*Math.cos(n)-e*Math.sin(n),i=t*Math.sin(n)+e*Math.cos(n);return[s,i]}function zn(t,e,n,s,i,l,a,o,r,h){const c=Gs(a);let u=[],d=0,p=0,m=0,x=0;if(h)[d,p,m,x]=h;else{[t,e]=We(t,e,-c),[n,s]=We(n,s,-c);const G=(t-n)/2,X=(e-s)/2;let W=G*G/(i*i)+X*X/(l*l);W>1&&(W=Math.sqrt(W),i=W*i,l=W*l);const se=o===r?-1:1,te=i*i,ce=l*l,xe=te*ce-te*X*X-ce*G*G,Xe=te*X*X+ce*G*G,ye=se*Math.sqrt(Math.abs(xe/Xe));m=ye*i*X/l+(t+n)/2,x=ye*-l*G/i+(e+s)/2,d=Math.asin(parseFloat(((e-x)/l).toFixed(9))),p=Math.asin(parseFloat(((s-x)/l).toFixed(9))),t<m&&(d=Math.PI-d),n<m&&(p=Math.PI-p),d<0&&(d=Math.PI*2+d),p<0&&(p=Math.PI*2+p),r&&d>p&&(d=d-Math.PI*2),!r&&p>d&&(p=p-Math.PI*2)}let g=p-d;if(Math.abs(g)>Math.PI*120/180){const G=p,X=n,W=s;r&&p>d?p=d+Math.PI*120/180*1:p=d+Math.PI*120/180*-1,n=m+i*Math.cos(p),s=x+l*Math.sin(p),u=zn(n,s,X,W,i,l,a,0,r,[p,G,m,x])}g=p-d;const $=Math.cos(d),A=Math.sin(d),w=Math.cos(p),E=Math.sin(p),z=Math.tan(g/4),I=4/3*i*z,H=4/3*l*z,F=[t,e],q=[t+I*A,e-H*$],ie=[n+I*E,s-H*w],oe=[n,s];if(q[0]=2*F[0]-q[0],q[1]=2*F[1]-q[1],h)return[q,ie,oe].concat(u);{u=[q,ie,oe].concat(u);const G=[];for(let X=0;X<u.length;X+=3){const W=We(u[X][0],u[X][1],c),se=We(u[X+1][0],u[X+1][1],c),te=We(u[X+2][0],u[X+2][1],c);G.push([W[0],W[1],se[0],se[1],te[0],te[1]])}return G}}const Ks={randOffset:ti,randOffsetWithRange:ni,ellipse:Qs,doubleLineOps:si};function Ln(t,e,n,s,i){return{type:"path",ops:Se(t,e,n,s,i)}}function ct(t,e,n){const s=(t||[]).length;if(s>2){const i=[];for(let l=0;l<s-1;l++)i.push(...Se(t[l][0],t[l][1],t[l+1][0],t[l+1][1],n));return e&&i.push(...Se(t[s-1][0],t[s-1][1],t[0][0],t[0][1],n)),{type:"path",ops:i}}else if(s===2)return Ln(t[0][0],t[0][1],t[1][0],t[1][1],n);return{type:"path",ops:[]}}function Zs(t,e){return ct(t,!0,e)}function Js(t,e,n,s,i){const l=[[t,e],[t+n,e],[t+n,e+s],[t,e+s]];return Zs(l,i)}function an(t,e){if(t.length){const s=typeof t[0][0]=="number"?[t]:t,i=lt(s[0],1*(1+e.roughness*.2),e),l=e.disableMultiStroke?[]:lt(s[0],1.5*(1+e.roughness*.22),hn(e));for(let a=1;a<s.length;a++){const o=s[a];if(o.length){const r=lt(o,1*(1+e.roughness*.2),e),h=e.disableMultiStroke?[]:lt(o,1.5*(1+e.roughness*.22),hn(e));for(const c of r)c.op!=="move"&&i.push(c);for(const c of h)c.op!=="move"&&l.push(c)}}return{type:"path",ops:i.concat(l)}}return{type:"path",ops:[]}}function Qs(t,e,n,s,i){const l=In(n,s,i);return Vt(t,e,i,l).opset}function In(t,e,n){const s=Math.sqrt(Math.PI*2*Math.sqrt((Math.pow(t/2,2)+Math.pow(e/2,2))/2)),i=Math.ceil(Math.max(n.curveStepCount,n.curveStepCount/Math.sqrt(200)*s)),l=Math.PI*2/i;let a=Math.abs(t/2),o=Math.abs(e/2);const r=1-n.curveFitting;return a+=N(a*r,n),o+=N(o*r,n),{increment:l,rx:a,ry:o}}function Vt(t,e,n,s){const[i,l]=un(s.increment,t,e,s.rx,s.ry,1,s.increment*bt(.1,bt(.4,1,n),n),n);let a=wt(i,null,n);if(!n.disableMultiStroke&&n.roughness!==0){const[o]=un(s.increment,t,e,s.rx,s.ry,1.5,0,n),r=wt(o,null,n);a=a.concat(r)}return{estimatedPoints:l,opset:{type:"path",ops:a}}}function rn(t,e,n,s,i,l,a,o,r){const h=t,c=e;let u=Math.abs(n/2),d=Math.abs(s/2);u+=N(u*.01,r),d+=N(d*.01,r);let p=i,m=l;for(;p<0;)p+=Math.PI*2,m+=Math.PI*2;m-p>Math.PI*2&&(p=0,m=Math.PI*2);const x=Math.PI*2/r.curveStepCount,g=Math.min(x/2,(m-p)/2),$=dn(g,h,c,u,d,p,m,1,r);if(!r.disableMultiStroke){const A=dn(g,h,c,u,d,p,m,1.5,r);$.push(...A)}return a&&(o?$.push(...Se(h,c,h+u*Math.cos(p),c+d*Math.sin(p),r),...Se(h,c,h+u*Math.cos(m),c+d*Math.sin(m),r)):$.push({op:"lineTo",data:[h,c]},{op:"lineTo",data:[h+u*Math.cos(p),c+d*Math.sin(p)]})),{type:"path",ops:$}}function cn(t,e){const n=Nn(En(Kt(t))),s=[];let i=[0,0],l=[0,0];for(const{key:a,data:o}of n)switch(a){case"M":{l=[o[0],o[1]],i=[o[0],o[1]];break}case"L":s.push(...Se(l[0],l[1],o[0],o[1],e)),l=[o[0],o[1]];break;case"C":{const[r,h,c,u,d,p]=o;s.push(...ii(r,h,c,u,d,p,l,e)),l=[d,p];break}case"Z":s.push(...Se(l[0],l[1],i[0],i[1],e)),l=[i[0],i[1]];break}return{type:"path",ops:s}}function Nt(t,e){const n=[];for(const s of t)if(s.length){const i=e.maxRandomnessOffset||0,l=s.length;if(l>2){n.push({op:"move",data:[s[0][0]+N(i,e),s[0][1]+N(i,e)]});for(let a=1;a<l;a++)n.push({op:"lineTo",data:[s[a][0]+N(i,e),s[a][1]+N(i,e)]})}}return{type:"fillPath",ops:n}}function Le(t,e){return Vs(e,Ks).fillPolygons(t,e)}function ei(t,e,n,s,i,l,a){const o=t,r=e;let h=Math.abs(n/2),c=Math.abs(s/2);h+=N(h*.01,a),c+=N(c*.01,a);let u=i,d=l;for(;u<0;)u+=Math.PI*2,d+=Math.PI*2;d-u>Math.PI*2&&(u=0,d=Math.PI*2);const p=(d-u)/a.curveStepCount,m=[];for(let x=u;x<=d;x=x+p)m.push([o+h*Math.cos(x),r+c*Math.sin(x)]);return m.push([o+h*Math.cos(d),r+c*Math.sin(d)]),m.push([o,r]),Le([m],a)}function ti(t,e){return N(t,e)}function ni(t,e,n){return bt(t,e,n)}function si(t,e,n,s,i){return Se(t,e,n,s,i,!0)}function hn(t){const e=Object.assign({},t);return e.randomizer=void 0,t.seed&&(e.seed=t.seed+1),e}function Dn(t){return t.randomizer||(t.randomizer=new Us(t.seed||0)),t.randomizer.next()}function bt(t,e,n,s=1){return n.roughness*s*(Dn(n)*(e-t)+t)}function N(t,e,n=1){return bt(-t,t,e,n)}function Se(t,e,n,s,i,l=!1){const a=l?i.disableMultiStrokeFill:i.disableMultiStroke,o=Ht(t,e,n,s,i,!0,!1);if(a)return o;const r=Ht(t,e,n,s,i,!0,!0);return o.concat(r)}function Ht(t,e,n,s,i,l,a){const o=Math.pow(t-n,2)+Math.pow(e-s,2),r=Math.sqrt(o);let h=1;r<200?h=1:r>500?h=.4:h=-.0016668*r+1.233334;let c=i.maxRandomnessOffset||0;c*c*100>o&&(c=r/10);const u=c/2,d=.2+Dn(i)*.2;let p=i.bowing*i.maxRandomnessOffset*(s-e)/200,m=i.bowing*i.maxRandomnessOffset*(t-n)/200;p=N(p,i,h),m=N(m,i,h);const x=[],g=()=>N(u,i,h),$=()=>N(c,i,h),A=i.preserveVertices;return a?x.push({op:"move",data:[t+(A?0:g()),e+(A?0:g())]}):x.push({op:"move",data:[t+(A?0:N(c,i,h)),e+(A?0:N(c,i,h))]}),a?x.push({op:"bcurveTo",data:[p+t+(n-t)*d+g(),m+e+(s-e)*d+g(),p+t+2*(n-t)*d+g(),m+e+2*(s-e)*d+g(),n+(A?0:g()),s+(A?0:g())]}):x.push({op:"bcurveTo",data:[p+t+(n-t)*d+$(),m+e+(s-e)*d+$(),p+t+2*(n-t)*d+$(),m+e+2*(s-e)*d+$(),n+(A?0:$()),s+(A?0:$())]}),x}function lt(t,e,n){if(!t.length)return[];const s=[];s.push([t[0][0]+N(e,n),t[0][1]+N(e,n)]),s.push([t[0][0]+N(e,n),t[0][1]+N(e,n)]);for(let i=1;i<t.length;i++)s.push([t[i][0]+N(e,n),t[i][1]+N(e,n)]),i===t.length-1&&s.push([t[i][0]+N(e,n),t[i][1]+N(e,n)]);return wt(s,null,n)}function wt(t,e,n){const s=t.length,i=[];if(s>3){const l=[],a=1-n.curveTightness;i.push({op:"move",data:[t[1][0],t[1][1]]});for(let o=1;o+2<s;o++){const r=t[o];l[0]=[r[0],r[1]],l[1]=[r[0]+(a*t[o+1][0]-a*t[o-1][0])/6,r[1]+(a*t[o+1][1]-a*t[o-1][1])/6],l[2]=[t[o+1][0]+(a*t[o][0]-a*t[o+2][0])/6,t[o+1][1]+(a*t[o][1]-a*t[o+2][1])/6],l[3]=[t[o+1][0],t[o+1][1]],i.push({op:"bcurveTo",data:[l[1][0],l[1][1],l[2][0],l[2][1],l[3][0],l[3][1]]})}}else s===3?(i.push({op:"move",data:[t[1][0],t[1][1]]}),i.push({op:"bcurveTo",data:[t[1][0],t[1][1],t[2][0],t[2][1],t[2][0],t[2][1]]})):s===2&&i.push(...Ht(t[0][0],t[0][1],t[1][0],t[1][1],n,!0,!0));return i}function un(t,e,n,s,i,l,a,o){const r=o.roughness===0,h=[],c=[];if(r){t=t/4,c.push([e+s*Math.cos(-t),n+i*Math.sin(-t)]);for(let u=0;u<=Math.PI*2;u=u+t){const d=[e+s*Math.cos(u),n+i*Math.sin(u)];h.push(d),c.push(d)}c.push([e+s*Math.cos(0),n+i*Math.sin(0)]),c.push([e+s*Math.cos(t),n+i*Math.sin(t)])}else{const u=N(.5,o)-Math.PI/2;c.push([N(l,o)+e+.9*s*Math.cos(u-t),N(l,o)+n+.9*i*Math.sin(u-t)]);const d=Math.PI*2+u-.01;for(let p=u;p<d;p=p+t){const m=[N(l,o)+e+s*Math.cos(p),N(l,o)+n+i*Math.sin(p)];h.push(m),c.push(m)}c.push([N(l,o)+e+s*Math.cos(u+Math.PI*2+a*.5),N(l,o)+n+i*Math.sin(u+Math.PI*2+a*.5)]),c.push([N(l,o)+e+.98*s*Math.cos(u+a),N(l,o)+n+.98*i*Math.sin(u+a)]),c.push([N(l,o)+e+.9*s*Math.cos(u+a*.5),N(l,o)+n+.9*i*Math.sin(u+a*.5)])}return[c,h]}function dn(t,e,n,s,i,l,a,o,r){const h=l+N(.1,r),c=[];c.push([N(o,r)+e+.9*s*Math.cos(h-t),N(o,r)+n+.9*i*Math.sin(h-t)]);for(let u=h;u<=a;u=u+t)c.push([N(o,r)+e+s*Math.cos(u),N(o,r)+n+i*Math.sin(u)]);return c.push([e+s*Math.cos(a),n+i*Math.sin(a)]),c.push([e+s*Math.cos(a),n+i*Math.sin(a)]),wt(c,null,r)}function ii(t,e,n,s,i,l,a,o){const r=[],h=[o.maxRandomnessOffset||1,(o.maxRandomnessOffset||1)+.3];let c=[0,0];const u=o.disableMultiStroke?1:2,d=o.preserveVertices;for(let p=0;p<u;p++)p===0?r.push({op:"move",data:[a[0],a[1]]}):r.push({op:"move",data:[a[0]+(d?0:N(h[0],o)),a[1]+(d?0:N(h[0],o))]}),c=d?[i,l]:[i+N(h[p],o),l+N(h[p],o)],r.push({op:"bcurveTo",data:[t+N(h[p],o),e+N(h[p],o),n+N(h[p],o),s+N(h[p],o),c[0],c[1]]});return r}function Ve(t){return[...t]}function fn(t,e=0){const n=t.length;if(n<3)throw new Error("A curve must have at least three points.");const s=[];if(n===3)s.push(Ve(t[0]),Ve(t[1]),Ve(t[2]),Ve(t[2]));else{const i=[];i.push(t[0],t[0]);for(let o=1;o<t.length;o++)i.push(t[o]),o===t.length-1&&i.push(t[o]);const l=[],a=1-e;s.push(Ve(i[0]));for(let o=1;o+2<i.length;o++){const r=i[o];l[0]=[r[0],r[1]],l[1]=[r[0]+(a*i[o+1][0]-a*i[o-1][0])/6,r[1]+(a*i[o+1][1]-a*i[o-1][1])/6],l[2]=[i[o+1][0]+(a*i[o][0]-a*i[o+2][0])/6,i[o+1][1]+(a*i[o][1]-a*i[o+2][1])/6],l[3]=[i[o+1][0],i[o+1][1]],s.push(l[1],l[2],l[3])}}return s}function li(t,e){return Math.sqrt(ht(t,e))}function ht(t,e){return Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)}function oi(t,e,n){const s=ht(e,n);if(s===0)return ht(t,e);let i=((t[0]-e[0])*(n[0]-e[0])+(t[1]-e[1])*(n[1]-e[1]))/s;return i=Math.max(0,Math.min(1,i)),ht(t,Ce(e,n,i))}function Ce(t,e,n){return[t[0]+(e[0]-t[0])*n,t[1]+(e[1]-t[1])*n]}function ai(t,e){const n=t[e+0],s=t[e+1],i=t[e+2],l=t[e+3];let a=3*s[0]-2*n[0]-l[0];a*=a;let o=3*s[1]-2*n[1]-l[1];o*=o;let r=3*i[0]-2*l[0]-n[0];r*=r;let h=3*i[1]-2*l[1]-n[1];return h*=h,a<r&&(a=r),o<h&&(o=h),a+o}function Ut(t,e,n,s){const i=s||[];if(ai(t,e)<n){const l=t[e+0];i.length?li(i[i.length-1],l)>1&&i.push(l):i.push(l),i.push(t[e+3])}else{const a=t[e+0],o=t[e+1],r=t[e+2],h=t[e+3],c=Ce(a,o,.5),u=Ce(o,r,.5),d=Ce(r,h,.5),p=Ce(c,u,.5),m=Ce(u,d,.5),x=Ce(p,m,.5);Ut([a,c,p,x],0,n,i),Ut([x,m,d,h],0,n,i)}return i}function ri(t,e){return vt(t,0,t.length,e)}function vt(t,e,n,s,i){const l=i||[],a=t[e],o=t[n-1];let r=0,h=1;for(let c=e+1;c<n-1;++c){const u=oi(t[c],a,o);u>r&&(r=u,h=c)}return Math.sqrt(r)>s?(vt(t,e,h+1,s,l),vt(t,h,n,s,l)):(l.length||l.push(a),l.push(o)),l}function Bt(t,e=.15,n){const s=[],i=(t.length-1)/3;for(let l=0;l<i;l++){const a=l*3;Ut(t,a,e,s)}return n&&n>0?vt(s,0,s.length,n):s}function ci(t,e,n){const s=Kt(t),i=Nn(En(s)),l=[];let a=[],o=[0,0],r=[];const h=()=>{r.length>=4&&a.push(...Bt(r,e)),r=[]},c=()=>{h(),a.length&&(l.push(a),a=[])};for(const{key:d,data:p}of i)switch(d){case"M":c(),o=[p[0],p[1]],a.push(o);break;case"L":h(),a.push([p[0],p[1]]);break;case"C":if(!r.length){const m=a.length?a[a.length-1]:o;r.push([m[0],m[1]])}r.push([p[0],p[1]]),r.push([p[2],p[3]]),r.push([p[4],p[5]]);break;case"Z":h(),a.push([o[0],o[1]]);break}if(c(),!n)return l;const u=[];for(const d of l){const p=ri(d,n);p.length&&u.push(p)}return u}const ae="none";class kt{constructor(e){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=e||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Hs()}_o(e){return e?Object.assign({},this.defaultOptions,e):this.defaultOptions}_d(e,n,s){return{shape:e,sets:n||[],options:s||this.defaultOptions}}line(e,n,s,i,l){const a=this._o(l);return this._d("line",[Ln(e,n,s,i,a)],a)}rectangle(e,n,s,i,l){const a=this._o(l),o=[],r=Js(e,n,s,i,a);if(a.fill){const h=[[e,n],[e+s,n],[e+s,n+i],[e,n+i]];a.fillStyle==="solid"?o.push(Nt([h],a)):o.push(Le([h],a))}return a.stroke!==ae&&o.push(r),this._d("rectangle",o,a)}ellipse(e,n,s,i,l){const a=this._o(l),o=[],r=In(s,i,a),h=Vt(e,n,a,r);if(a.fill)if(a.fillStyle==="solid"){const c=Vt(e,n,a,r).opset;c.type="fillPath",o.push(c)}else o.push(Le([h.estimatedPoints],a));return a.stroke!==ae&&o.push(h.opset),this._d("ellipse",o,a)}circle(e,n,s,i){const l=this.ellipse(e,n,s,s,i);return l.shape="circle",l}linearPath(e,n){const s=this._o(n);return this._d("linearPath",[ct(e,!1,s)],s)}arc(e,n,s,i,l,a,o=!1,r){const h=this._o(r),c=[],u=rn(e,n,s,i,l,a,o,!0,h);if(o&&h.fill)if(h.fillStyle==="solid"){const d=Object.assign({},h);d.disableMultiStroke=!0;const p=rn(e,n,s,i,l,a,!0,!1,d);p.type="fillPath",c.push(p)}else c.push(ei(e,n,s,i,l,a,h));return h.stroke!==ae&&c.push(u),this._d("arc",c,h)}curve(e,n){const s=this._o(n),i=[],l=an(e,s);if(s.fill&&s.fill!==ae)if(s.fillStyle==="solid"){const a=an(e,Object.assign(Object.assign({},s),{disableMultiStroke:!0,roughness:s.roughness?s.roughness+s.fillShapeRoughnessGain:0}));i.push({type:"fillPath",ops:this._mergedShape(a.ops)})}else{const a=[],o=e;if(o.length){const h=typeof o[0][0]=="number"?[o]:o;for(const c of h)c.length<3?a.push(...c):c.length===3?a.push(...Bt(fn([c[0],c[0],c[1],c[2]]),10,(1+s.roughness)/2)):a.push(...Bt(fn(c),10,(1+s.roughness)/2))}a.length&&i.push(Le([a],s))}return s.stroke!==ae&&i.push(l),this._d("curve",i,s)}polygon(e,n){const s=this._o(n),i=[],l=ct(e,!0,s);return s.fill&&(s.fillStyle==="solid"?i.push(Nt([e],s)):i.push(Le([e],s))),s.stroke!==ae&&i.push(l),this._d("polygon",i,s)}path(e,n){const s=this._o(n),i=[];if(!e)return this._d("path",i,s);e=(e||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");const l=s.fill&&s.fill!=="transparent"&&s.fill!==ae,a=s.stroke!==ae,o=!!(s.simplification&&s.simplification<1),r=o?4-4*(s.simplification||1):(1+s.roughness)/2,h=ci(e,1,r),c=cn(e,s);if(l)if(s.fillStyle==="solid")if(h.length===1){const u=cn(e,Object.assign(Object.assign({},s),{disableMultiStroke:!0,roughness:s.roughness?s.roughness+s.fillShapeRoughnessGain:0}));i.push({type:"fillPath",ops:this._mergedShape(u.ops)})}else i.push(Nt(h,s));else i.push(Le(h,s));return a&&(o?h.forEach(u=>{i.push(ct(u,!1,s))}):i.push(c)),this._d("path",i,s)}opsToPath(e,n){let s="";for(const i of e.ops){const l=typeof n=="number"&&n>=0?i.data.map(a=>+a.toFixed(n)):i.data;switch(i.op){case"move":s+=`M${l[0]} ${l[1]} `;break;case"bcurveTo":s+=`C${l[0]} ${l[1]}, ${l[2]} ${l[3]}, ${l[4]} ${l[5]} `;break;case"lineTo":s+=`L${l[0]} ${l[1]} `;break}}return s.trim()}toPaths(e){const n=e.sets||[],s=e.options||this.defaultOptions,i=[];for(const l of n){let a=null;switch(l.type){case"path":a={d:this.opsToPath(l),stroke:s.stroke,strokeWidth:s.strokeWidth,fill:ae};break;case"fillPath":a={d:this.opsToPath(l),stroke:ae,strokeWidth:0,fill:s.fill||ae};break;case"fillSketch":a=this.fillSketch(l,s);break}a&&i.push(a)}return i}fillSketch(e,n){let s=n.fillWeight;return s<0&&(s=n.strokeWidth/2),{d:this.opsToPath(e),stroke:n.fill||ae,strokeWidth:s,fill:ae}}_mergedShape(e){return e.filter((n,s)=>s===0?!0:n.op!=="move")}}class hi{constructor(e,n){this.canvas=e,this.ctx=this.canvas.getContext("2d"),this.gen=new kt(n)}draw(e){const n=e.sets||[],s=e.options||this.getDefaultOptions(),i=this.ctx,l=e.options.fixedDecimalPlaceDigits;for(const a of n)switch(a.type){case"path":i.save(),i.strokeStyle=s.stroke==="none"?"transparent":s.stroke,i.lineWidth=s.strokeWidth,s.strokeLineDash&&i.setLineDash(s.strokeLineDash),s.strokeLineDashOffset&&(i.lineDashOffset=s.strokeLineDashOffset),this._drawToContext(i,a,l),i.restore();break;case"fillPath":{i.save(),i.fillStyle=s.fill||"";const o=e.shape==="curve"||e.shape==="polygon"||e.shape==="path"?"evenodd":"nonzero";this._drawToContext(i,a,l,o),i.restore();break}case"fillSketch":this.fillSketch(i,a,s);break}}fillSketch(e,n,s){let i=s.fillWeight;i<0&&(i=s.strokeWidth/2),e.save(),s.fillLineDash&&e.setLineDash(s.fillLineDash),s.fillLineDashOffset&&(e.lineDashOffset=s.fillLineDashOffset),e.strokeStyle=s.fill||"",e.lineWidth=i,this._drawToContext(e,n,s.fixedDecimalPlaceDigits),e.restore()}_drawToContext(e,n,s,i="nonzero"){e.beginPath();for(const l of n.ops){const a=typeof s=="number"&&s>=0?l.data.map(o=>+o.toFixed(s)):l.data;switch(l.op){case"move":e.moveTo(a[0],a[1]);break;case"bcurveTo":e.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5]);break;case"lineTo":e.lineTo(a[0],a[1]);break}}n.type==="fillPath"?e.fill(i):e.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(e,n,s,i,l){const a=this.gen.line(e,n,s,i,l);return this.draw(a),a}rectangle(e,n,s,i,l){const a=this.gen.rectangle(e,n,s,i,l);return this.draw(a),a}ellipse(e,n,s,i,l){const a=this.gen.ellipse(e,n,s,i,l);return this.draw(a),a}circle(e,n,s,i){const l=this.gen.circle(e,n,s,i);return this.draw(l),l}linearPath(e,n){const s=this.gen.linearPath(e,n);return this.draw(s),s}polygon(e,n){const s=this.gen.polygon(e,n);return this.draw(s),s}arc(e,n,s,i,l,a,o=!1,r){const h=this.gen.arc(e,n,s,i,l,a,o,r);return this.draw(h),h}curve(e,n){const s=this.gen.curve(e,n);return this.draw(s),s}path(e,n){const s=this.gen.path(e,n);return this.draw(s),s}}const ot="http://www.w3.org/2000/svg";class ui{constructor(e,n){this.svg=e,this.gen=new kt(n)}draw(e){const n=e.sets||[],s=e.options||this.getDefaultOptions(),i=this.svg.ownerDocument||window.document,l=i.createElementNS(ot,"g"),a=e.options.fixedDecimalPlaceDigits;for(const o of n){let r=null;switch(o.type){case"path":{r=i.createElementNS(ot,"path"),r.setAttribute("d",this.opsToPath(o,a)),r.setAttribute("stroke",s.stroke),r.setAttribute("stroke-width",s.strokeWidth+""),r.setAttribute("fill","none"),s.strokeLineDash&&r.setAttribute("stroke-dasharray",s.strokeLineDash.join(" ").trim()),s.strokeLineDashOffset&&r.setAttribute("stroke-dashoffset",`${s.strokeLineDashOffset}`);break}case"fillPath":{r=i.createElementNS(ot,"path"),r.setAttribute("d",this.opsToPath(o,a)),r.setAttribute("stroke","none"),r.setAttribute("stroke-width","0"),r.setAttribute("fill",s.fill||""),(e.shape==="curve"||e.shape==="polygon")&&r.setAttribute("fill-rule","evenodd");break}case"fillSketch":{r=this.fillSketch(i,o,s);break}}r&&l.appendChild(r)}return l}fillSketch(e,n,s){let i=s.fillWeight;i<0&&(i=s.strokeWidth/2);const l=e.createElementNS(ot,"path");return l.setAttribute("d",this.opsToPath(n,s.fixedDecimalPlaceDigits)),l.setAttribute("stroke",s.fill||""),l.setAttribute("stroke-width",i+""),l.setAttribute("fill","none"),s.fillLineDash&&l.setAttribute("stroke-dasharray",s.fillLineDash.join(" ").trim()),s.fillLineDashOffset&&l.setAttribute("stroke-dashoffset",`${s.fillLineDashOffset}`),l}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(e,n){return this.gen.opsToPath(e,n)}line(e,n,s,i,l){const a=this.gen.line(e,n,s,i,l);return this.draw(a)}rectangle(e,n,s,i,l){const a=this.gen.rectangle(e,n,s,i,l);return this.draw(a)}ellipse(e,n,s,i,l){const a=this.gen.ellipse(e,n,s,i,l);return this.draw(a)}circle(e,n,s,i){const l=this.gen.circle(e,n,s,i);return this.draw(l)}linearPath(e,n){const s=this.gen.linearPath(e,n);return this.draw(s)}polygon(e,n){const s=this.gen.polygon(e,n);return this.draw(s)}arc(e,n,s,i,l,a,o=!1,r){const h=this.gen.arc(e,n,s,i,l,a,o,r);return this.draw(h)}curve(e,n){const s=this.gen.curve(e,n);return this.draw(s)}path(e,n){const s=this.gen.path(e,n);return this.draw(s)}}const Zt={canvas(t,e){return new hi(t,e)},svg(t,e){return new ui(t,e)},generator(t){return new kt(t)},newSeed(){return kt.newSeed()}},Rn=(t,e,n)=>{const s=t.x,i=t.y,l=e.x,a=e.y,o=n.x,r=n.y,h=s-l,c=i-a,u=o-l,d=r-a,p=h*u+c*d,m=u*u+d*d;let x=-1;m!==0&&(x=p/m);let g,$;x<0?(g=l,$=a):x>1?(g=o,$=r):(g=l+x*u,$=a+x*d);const A=s-g,w=i-$;return Math.sqrt(A*A+w*w)},di=(t,e,n)=>{if(e.length<2)return!1;for(let s=0;s<e.length-1;s++)if(Rn(t,e[s],e[s+1])<=n)return!0;return!1},fi=(t,e,n,s,i)=>{const l=Math.abs(s/2),a=Math.abs(i/2),o=e+s/2,r=n+i/2;return l<=0||a<=0?!1:Math.pow(t.x-o,2)/Math.pow(l,2)+Math.pow(t.y-r,2)/Math.pow(a,2)<=1},zt=new Map,at=new Set,pi=t=>{if(zt.has(t))return zt.get(t);if(!at.has(t)){at.add(t);const e=new Image;e.src=t,e.onload=()=>{zt.set(t,e),at.delete(t)},e.onerror=()=>{at.delete(t)}}return null},jn=(t,e,n)=>{e.save(),e.globalAlpha=(n.opacity??100)/100;const s=n.x+n.width/2,i=n.y+n.height/2;n.angle&&(e.translate(s,i),e.rotate(n.angle),e.translate(-s,-i));const l={seed:n.seed,roughness:n.roughness,stroke:n.strokeColor,strokeWidth:n.strokeWidth,fill:n.backgroundColor==="transparent"?void 0:n.backgroundColor,fillStyle:n.fillStyle,strokeLineDash:n.strokeStyle==="dashed"?[10,10]:n.strokeStyle==="dotted"?[5,10]:void 0};if(n.type==="rectangle")t.rectangle(n.x,n.y,n.width,n.height,l);else if(n.type==="circle")t.ellipse(n.x+n.width/2,n.y+n.height/2,Math.abs(n.width),Math.abs(n.height),l);else if(n.type==="line"||n.type==="arrow"){const a=n.x+n.width,o=n.y+n.height;if(t.line(n.x,n.y,a,o,l),n.type==="arrow"){const r=Math.atan2(n.height,n.width),h=15,c={x:a-h*Math.cos(r-Math.PI/6),y:o-h*Math.sin(r-Math.PI/6)},u={x:a-h*Math.cos(r+Math.PI/6),y:o-h*Math.sin(r+Math.PI/6)};t.line(a,o,c.x,c.y,l),t.line(a,o,u.x,u.y,l)}}else if(n.type==="pencil"&&n.points&&n.points.length>0){const a=n.points.map(o=>[n.x+o.x,n.y+o.y]);t.linearPath(a,l)}else if(n.type==="image"&&n.dataURL){const a=pi(n.dataURL);a?e.drawImage(a,n.x,n.y,n.width,n.height):(e.save(),e.fillStyle="#e5e5e5",e.fillRect(n.x,n.y,n.width,n.height),e.fillStyle="#999",e.font="12px sans-serif",e.fillText("Loading image...",n.x+10,n.y+20),e.restore())}else if(n.type==="text"&&n.text){const a=n.fontSize||20;e.font=`${a}px sans-serif`;const r=e.measureText(n.text).width,h=n.width&&r?n.width/r:1;e.fillStyle=n.strokeColor,h!==1?(e.save(),e.translate(n.x,n.y),e.scale(h,1),e.fillText(n.text,0,a),e.restore()):e.fillText(n.text,n.x,n.y+a)}e.restore()};var gi=D("<canvas style=display:block;touch-action:none>"),yi=D('<div style=position:fixed;bottom:30px;left:50%;transform:translateX(-50%);z-index:100><button style="background-color:white;border:1px solid #e5e7eb;padding:8px 16px;border-radius:9999px;box-shadow:0 4px 6px -1px rgba(0, 0, 0, 0.1);cursor:pointer;color:#3b82f6;font-weight:500;font-size:14px;transition:all 0.2s">Scroll back to content'),mi=D('<textarea style="position:absolute;background:transparent;border:1px dashed #007acc;outline:none;margin:0;padding:0;resize:none;overflow:hidden;min-width:50px;min-height:1em">');const bi=()=>{let t,e=!1,n=null,s=0,i=0;const[l,a]=ee(null),[o,r]=ee("");let h,c=!1,u=!1,d=null;const[p,m]=ee(null);let x=new Map,g=0,$=0,A=0,w=0,E,z=20;const I=()=>{t&&(t.width=window.innerWidth,t.height=window.innerHeight,q())},[H,F]=ee("default"),q=()=>{if(!t)return;const f=t.getContext("2d");if(!f)return;f.setTransform(1,0,0,1,0,0),f.clearRect(0,0,t.width,t.height),f.fillStyle="#fafafa",f.fillRect(0,0,t.width,t.height),f.save();const{scale:v,panX:P,panY:M}=b.viewState;f.translate(P,M),f.scale(v,v),b.elements.forEach(y=>{let T=y.x+y.width/2,C=y.y+y.height/2;if(y.type!=="text"||l()!==y.id){const S=Zt.canvas(t);jn(S,f,y)}if(b.selection.includes(y.id)){f.save(),y.angle&&(f.translate(T,C),f.rotate(y.angle),f.translate(-T,-C)),f.strokeStyle="#3b82f6",f.lineWidth=1/v;const S=2/v;if(f.strokeRect(y.x-S,y.y-S,y.width+S*2,y.height+S*2),b.selection.length===1){const L=8/v;f.fillStyle="#ffffff",f.strokeStyle="#3b82f6",f.lineWidth=2/v,[{x:y.x-S,y:y.y-S},{x:y.x+y.width+S,y:y.y-S},{x:y.x+y.width+S,y:y.y+y.height+S},{x:y.x-S,y:y.y+y.height+S},{x:y.x+y.width/2,y:y.y-S},{x:y.x+y.width+S,y:y.y+y.height/2},{x:y.x+y.width/2,y:y.y+y.height+S},{x:y.x-S,y:y.y+y.height/2}].forEach(U=>{f.fillRect(U.x-L/2,U.y-L/2,L,L),f.strokeRect(U.x-L/2,U.y-L/2,L,L)});const J={x:y.x+y.width/2,y:y.y-S-20/v};f.beginPath(),f.moveTo(y.x+y.width/2,y.y-S),f.lineTo(J.x,J.y),f.stroke(),f.beginPath(),f.arc(J.x,J.y,L/2,0,2*Math.PI),f.fill(),f.stroke(),f.stroke(),f.restore()}else f.restore()}});const _=p();_&&(f.save(),f.fillStyle="rgba(59, 130, 246, 0.2)",f.strokeStyle="#3b82f6",f.lineWidth=1/v,f.fillRect(_.x,_.y,_.w,_.h),f.strokeRect(_.x,_.y,_.w,_.h),f.restore())};De(()=>{b.elements.length,b.elements.forEach(f=>{f.x,f.y,f.width,f.height,f.points&&f.points.length,f.angle,f.opacity,f.strokeColor,f.backgroundColor,f.fillStyle,f.strokeWidth,f.strokeStyle,f.roughness,f.roundness,f.text,f.fontSize,f.fontFamily,f.textAlign,f.startArrowhead,f.endArrowhead}),b.viewState.scale,b.viewState.panX,b.viewState.panY,b.selection.length,p(),requestAnimationFrame(q)});const ie=f=>({x:f.clientX,y:f.clientY}),oe=(f,v)=>{const{scale:P,panX:M,panY:_}=b.viewState;return{x:(f-M)/P,y:(v-_)/P}},G=f=>{f.preventDefault();const v=f.deltaMode===1?33:f.deltaMode===2?400:1,P=f.deltaX*v,M=f.deltaY*v;if(f.ctrlKey||f.metaKey){const y=1-M*.001,T=Math.min(Math.max(b.viewState.scale*y,.1),10),{x:C,y:S}=ie(f),{scale:L,panX:R,panY:J}=b.viewState,U=(C-R)/L,K=(S-J)/L,me=C-U*T,fe=S-K*T;we({scale:T,panX:me,panY:fe})}else f.shiftKey?we({panX:b.viewState.panX-(M||P),panY:b.viewState.panY}):we({panX:b.viewState.panX-P,panY:b.viewState.panY-M})},X=(f,v,P,M,_)=>{const y=Math.cos(_),T=Math.sin(_);return{x:y*(f-P)-T*(v-M)+P,y:T*(f-P)+y*(v-M)+M}},W=(f,v,P,M,_)=>X(f,v,P,M,-_),se=(f,v)=>{const{scale:P}=b.viewState,M=10/P;for(let _=b.elements.length-1;_>=0;_--){const y=b.elements[_];if(!b.selection.includes(y.id))continue;const T=y.x+y.width/2,C=y.y+y.height/2,S=y.angle||0,L=W(f,v,T,C,S),R=2/P,J=[{type:"tl",x:y.x-R,y:y.y-R},{type:"tr",x:y.x+y.width+R,y:y.y-R},{type:"br",x:y.x+y.width+R,y:y.y+y.height+R},{type:"bl",x:y.x-R,y:y.y+y.height+R},{type:"tm",x:y.x+y.width/2,y:y.y-R},{type:"rm",x:y.x+y.width+R,y:y.y+y.height/2},{type:"bm",x:y.x+y.width/2,y:y.y+y.height+R},{type:"lm",x:y.x-R,y:y.y+y.height/2}];for(const K of J)if(Math.abs(L.x-K.x)<=M/2&&Math.abs(L.y-K.y)<=M/2)return{id:y.id,handle:K.type};const U={x:y.x+y.width/2,y:y.y-R-20/P};if(Math.abs(L.x-U.x)<=M&&Math.abs(L.y-U.y)<=M/2)return{id:y.id,handle:"rotate"}}return null},te=f=>{if(!f.points||f.points.length===0)return null;let v=1/0,P=1/0,M=-1/0,_=-1/0;f.points.forEach(S=>{v=Math.min(v,S.x),P=Math.min(P,S.y),M=Math.max(M,S.x),_=Math.max(_,S.y)});const y=M-v,T=_-P,C=f.points.map(S=>({x:S.x-v,y:S.y-P}));return{x:f.x+v,y:f.y+P,width:y,height:T,points:C}},ce=(f,v,P,M)=>{const _=f.x+f.width/2,y=f.y+f.height/2,T=W(v,P,_,y,f.angle||0);if(T.x<f.x-M||T.x>f.x+f.width+M||T.y<f.y-M||T.y>f.y+f.height+M)return!1;if(f.type==="rectangle")return!0;if(f.type==="circle")return fi(T,f.x,f.y,f.width,f.height);if(f.type==="line"||f.type==="arrow")return Rn(T,{x:f.x,y:f.y},{x:f.x+f.width,y:f.y+f.height})<=M;if(f.type==="pencil"&&f.points){const C={x:T.x-f.x,y:T.y-f.y};return di(C,f.points,M)}else if(f.type==="text"||f.type==="image")return!0;return!1},xe=f=>{f.currentTarget.setPointerCapture(f.pointerId);const{x:v,y:P}=oe(f.clientX,f.clientY);if(l()){et();return}if(b.selectedTool==="selection"){const _=se(v,P);if(_&&b.selection.length===1){Oe(),c=!0,d=_.handle;const C=b.elements.find(S=>S.id===_.id);C&&(g=C.x,$=C.y,A=C.width,w=C.height,E=C.points?[...C.points]:void 0,z=C.fontSize||20,s=v,i=P);return}let y=null;const T=10/b.viewState.scale;for(let C=b.elements.length-1;C>=0;C--){const S=b.elements[C];if(ce(S,v,P,T)){y=S.id;break}}if(y){const C=b.selection.includes(y);f.shiftKey?C?V("selection",S=>S.filter(L=>L!==y)):V("selection",S=>[...S,y]):C||V("selection",[y]),b.selection.length>0&&(Oe(),c=!0,d=null,s=v,i=P,x.clear(),b.elements.forEach(S=>{b.selection.includes(S.id)&&x.set(S.id,{x:S.x,y:S.y})}))}else f.shiftKey||V("selection",[]),u=!0,s=v,i=P,m({x:v,y:P,w:0,h:0});return}if(b.selectedTool==="text"){const _=crypto.randomUUID(),y={id:_,type:"text",x:v,y:P,width:100,height:30,strokeColor:"#000000",backgroundColor:"transparent",strokeWidth:1,text:"",fontSize:20,angle:0,opacity:100,fillStyle:"hachure",strokeStyle:"solid",roughness:1,renderStyle:"sketch",seed:Math.floor(Math.random()*2**31),roundness:null,locked:!1,link:null};Xt(y),a(_),r(""),setTimeout(()=>h?.focus(),0);return}if(b.selectedTool==="eraser"){e=!0;const _=10/b.viewState.scale;for(let y=b.elements.length-1;y>=0;y--){const T=b.elements[y];ce(T,v,P,_)&&je([T.id])}return}if(b.selectedTool==="pan"){c=!0,F("grabbing");return}e=!0,s=v,i=P,n=crypto.randomUUID();const M={id:n,type:b.selectedTool,x:v,y:P,width:0,height:0,strokeColor:"#000000",backgroundColor:"transparent",strokeWidth:2,points:b.selectedTool==="pencil"?[{x:0,y:0}]:void 0,angle:0,opacity:100,strokeStyle:"solid",fillStyle:"hachure",roughness:1,renderStyle:"sketch",seed:Math.floor(Math.random()*2**31),roundness:null,locked:!1,link:null};Xt(M)},Xe=f=>{const{x:v,y:P}=oe(f.clientX,f.clientY);if(b.selectedTool==="pan")F(c?"grabbing":"grab");else if(b.selectedTool==="selection"&&!c){const M=se(v,P);M?M.handle==="rotate"?F("grab"):M.handle==="tl"||M.handle==="br"?F("nwse-resize"):M.handle==="tr"||M.handle==="bl"?F("nesw-resize"):M.handle==="tm"||M.handle==="bm"?F("ns-resize"):(M.handle==="lm"||M.handle==="rm")&&F("ew-resize"):F("default")}if(b.selectedTool==="pan"){c&&we({panX:b.viewState.panX+f.movementX,panY:b.viewState.panY+f.movementY});return}if(b.selectedTool==="selection"){if(u){const M=v-s,_=P-i;m({x:M>0?s:s+M,y:_>0?i:i+_,w:Math.abs(M),h:Math.abs(_)});return}if(c&&b.selection.length>0){const M=b.selection[0],_=b.elements.find(y=>y.id===M);if(!_)return;if(d)if(d==="rotate"){const y=_.x+_.width/2,T=_.y+_.height/2,C=Math.atan2(P-T,v-y);pe(M,{angle:C+Math.PI/2})}else{const y=v-s,T=P-i;let C=g,S=$,L=A,R=w;d==="tl"?(C+=y,S+=T,L-=y,R-=T):d==="tr"?(S+=T,L+=y,R-=T):d==="bl"?(C+=y,L-=y,R+=T):d==="br"?(L+=y,R+=T):d==="tm"?(S+=T,R-=T):d==="bm"?R+=T:d==="lm"?(C+=y,L-=y):d==="rm"&&(L+=y);const J={x:C,y:S,width:L,height:R};if(_.type==="pencil"&&E){const U=L/A,K=R/w,me=E.map(fe=>({x:fe.x*(A===0?1:U),y:fe.y*(w===0?1:K)}));J.points=me}if(_.type==="text"){const U=R/w;if(U>0){let K=z*U;K=Math.max(K,8),J.fontSize=K,J.width=L}}pe(M,J)}else{const y=v-s,T=P-i;b.selection.forEach(C=>{const S=x.get(C);S&&pe(C,{x:S.x+y,y:S.y+T})})}}}if(!e||!n){if(e&&b.selectedTool==="eraser"){const M=10/b.viewState.scale;for(let _=b.elements.length-1;_>=0;_--){const y=b.elements[_];ce(y,v,P,M)&&je([y.id])}}return}if(b.selectedTool==="pencil"){const M=b.elements.find(_=>_.id===n);M&&M.points&&pe(n,{points:[...M.points,{x:v-s,y:P-i}]})}else pe(n,{width:v-s,height:P-i});if(c||e){const y=f.clientX,T=f.clientY;let C=0,S=0;y<50&&(C=10),y>window.innerWidth-50&&(C=-10),T<50&&(S=10),T>window.innerHeight-50&&(S=-10),(C!==0||S!==0)&&we({panX:b.viewState.panX+C,panY:b.viewState.panY+S})}},ye=f=>{if(f.currentTarget.releasePointerCapture(f.pointerId),b.selectedTool==="pan"){c=!1,F("grab");return}if(b.selectedTool==="selection"){if(u){const v=p();if(v){const P=[],M=v.x,_=v.y,y=v.w,T=v.h;if(b.elements.forEach(C=>{const S=C.x,L=C.y,R=C.width,J=C.height;M<S+R&&M+y>S&&_<L+J&&_+T>L&&P.push(C.id)}),f.shiftKey){const C=new Set(b.selection);P.forEach(S=>C.add(S)),V("selection",Array.from(C))}else V("selection",P)}u=!1,m(null)}c=!1,d=null,x.clear();return}if(e&&n){const v=b.elements.find(P=>P.id===n);if(v){if(v.type==="rectangle"||v.type==="circle")v.width<0&&pe(n,{x:v.x+v.width,width:Math.abs(v.width)}),v.height<0&&pe(n,{y:v.y+v.height,height:Math.abs(v.height)});else if(v.type==="pencil"){const P=te(v);P&&pe(n,P)}}}e=!1,n=null},et=()=>{const f=l();if(f){const v=o().trim();if(v){const P=b.elements.find(y=>y.id===f);let M=0,_=0;if(t&&P){const y=t.getContext("2d");if(y){const T=P.fontSize||20;y.font=`${T}px sans-serif`,M=y.measureText(v).width,_=T}}M=Math.max(M,10),_=Math.max(_,10),pe(f,{text:o(),width:M,height:_},!0)}else je([f]);a(null),r(""),requestAnimationFrame(q)}},Pt=()=>{l()&&et()},_e=()=>{const f=l();return f?b.elements.find(v=>v.id===f):null};De(()=>{l()&&h&&(h.style.height="auto",h.style.height=h.scrollHeight+"px")});const[At,tt]=ee(!1);De(()=>{const{scale:f,panX:v,panY:P}=b.viewState;if(!t||b.elements.length===0){tt(!1);return}const M=-v/f,_=-P/f,y=t.width/f,T=t.height/f;let C=1/0,S=1/0,L=-1/0,R=-1/0;b.elements.forEach(U=>{const K=U.x,me=U.x+U.width,fe=U.y,Ye=U.y+U.height;C=Math.min(C,K,me),L=Math.max(L,K,me),S=Math.min(S,fe,Ye),R=Math.max(R,fe,Ye)});const J=!(C>M+y||L<M||S>_+T||R<_);tt(!J)});const Te=()=>{if(b.elements.length===0)return;let f=1/0,v=1/0,P=-1/0,M=-1/0;b.elements.forEach(K=>{const me=K.x,fe=K.x+K.width,Ye=K.y,en=K.y+K.height;f=Math.min(f,me,fe),P=Math.max(P,me,fe),v=Math.min(v,Ye,en),M=Math.max(M,Ye,en)});const _=P-f,y=M-v,T=f+_/2,C=v+y/2,{scale:S}=b.viewState,L=window.innerWidth/2,R=window.innerHeight/2,J=-T*S+L,U=-C*S+R;we({panX:J,panY:U})};return St(()=>{window.addEventListener("resize",I),I(),Mt(()=>window.removeEventListener("resize",I))}),[(()=>{var f=gi();f.$$pointerup=ye,f.$$pointermove=Xe,f.$$pointerdown=xe,f.addEventListener("wheel",G);var v=t;return typeof v=="function"?Be(v,f):t=f,B(P=>ze(f,"cursor",H())),f})(),k(re,{get when(){return At()},get children(){var f=yi(),v=f.firstChild;return v.$$click=Te,f}}),k(re,{get when(){return _t(()=>!!l())()&&_e()},children:f=>{const v=_e(),{scale:P,panX:M,panY:_}=b.viewState,y=v.x*P+M,T=v.y*P+_;return(()=>{var C=mi();C.addEventListener("blur",Pt),C.$$input=L=>r(L.currentTarget.value);var S=h;return typeof S=="function"?Be(S,C):h=C,ze(C,"top",`${T}px`),ze(C,"left",`${y}px`),ze(C,"font",`${20*P}px sans-serif`),B(L=>ze(C,"color",v.strokeColor)),B(()=>C.value=o()),C})()}})]};ke(["pointerdown","pointermove","pointerup","click","input"]);var wi={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"},Ne=wi,vi=D("<svg>"),pn=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ki=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,s)=>s?s.toUpperCase():n.toLowerCase()),xi=t=>{const e=ki(t);return e.charAt(0).toUpperCase()+e.slice(1)},$i=(...t)=>t.filter((e,n,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===n).join(" ").trim(),Si=t=>{const[e,n]=$n(t,["color","size","strokeWidth","children","class","name","iconNode","absoluteStrokeWidth"]);return(()=>{var s=vi();return Sn(s,j(Ne,{get width(){return e.size??Ne.width},get height(){return e.size??Ne.height},get stroke(){return e.color??Ne.stroke},get"stroke-width"(){return _t(()=>!!e.absoluteStrokeWidth)()?Number(e.strokeWidth??Ne["stroke-width"])*24/Number(e.size):Number(e.strokeWidth??Ne["stroke-width"])},get class(){return $i("lucide","lucide-icon",...e.name!=null?[`lucide-${pn(xi(e.name))}`,`lucide-${pn(e.name)}`]:[],e.class!=null?e.class:"")}},n),!0,!0),O(s,k(Ie,{get each(){return e.iconNode},children:([i,l])=>k($s,j({component:i},l))})),s})()},Y=Si,Mi=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],_i=t=>k(Y,j(t,{iconNode:Mi,name:"chevron-down"})),Ci=_i,Pi=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Ai=t=>k(Y,j(t,{iconNode:Pi,name:"chevron-up"})),Oi=Ai,Ti=[["path",{d:"m7 6 5 5 5-5",key:"1lc07p"}],["path",{d:"m7 13 5 5 5-5",key:"1d48rs"}]],Ei=t=>k(Y,j(t,{iconNode:Ti,name:"chevrons-down"})),Ni=Ei,zi=[["path",{d:"m17 11-5-5-5 5",key:"e8nh98"}],["path",{d:"m17 18-5-5-5 5",key:"2avn1x"}]],Li=t=>k(Y,j(t,{iconNode:zi,name:"chevrons-up"})),Ii=Li,Di=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ri=t=>k(Y,j(t,{iconNode:Di,name:"circle"})),ji=Ri,Fi=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Xi=t=>k(Y,j(t,{iconNode:Fi,name:"copy"})),Yi=Xi,Wi=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Vi=t=>k(Y,j(t,{iconNode:Wi,name:"download"})),Hi=Vi,Ui=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],Bi=t=>k(Y,j(t,{iconNode:Ui,name:"eraser"})),qi=Bi,Gi=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M9 15h6",key:"cctwl0"}],["path",{d:"M12 18v-6",key:"17g6i2"}]],Ki=t=>k(Y,j(t,{iconNode:Gi,name:"file-plus"})),Zi=Ki,Ji=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Qi=t=>k(Y,j(t,{iconNode:Ji,name:"file-text"})),el=Qi,tl=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],nl=t=>k(Y,j(t,{iconNode:tl,name:"folder-open"})),sl=nl,il=[["path",{d:"M18 11V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2",key:"1fvzgz"}],["path",{d:"M14 10V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v2",key:"1kc0my"}],["path",{d:"M10 10.5V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2v8",key:"10h0bg"}],["path",{d:"M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"1s1gnw"}]],ll=t=>k(Y,j(t,{iconNode:il,name:"hand"})),ol=ll,al=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],rl=t=>k(Y,j(t,{iconNode:al,name:"image"})),Fn=rl,cl=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]],hl=t=>k(Y,j(t,{iconNode:cl,name:"maximize"})),ul=hl,dl=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],fl=t=>k(Y,j(t,{iconNode:dl,name:"menu"})),pl=fl,gl=[["path",{d:"M5 12h14",key:"1ays0h"}]],yl=t=>k(Y,j(t,{iconNode:gl,name:"minus"})),Xn=yl,ml=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],bl=t=>k(Y,j(t,{iconNode:ml,name:"moon"})),wl=bl,vl=[["path",{d:"M4.037 4.688a.495.495 0 0 1 .651-.651l16 6.5a.5.5 0 0 1-.063.947l-6.124 1.58a2 2 0 0 0-1.438 1.435l-1.579 6.126a.5.5 0 0 1-.947.063z",key:"edeuup"}]],kl=t=>k(Y,j(t,{iconNode:vl,name:"mouse-pointer-2"})),xl=kl,$l=[["path",{d:"M13 5H19V11",key:"1n1gyv"}],["path",{d:"M19 5L5 19",key:"72u4yj"}]],Sl=t=>k(Y,j(t,{iconNode:$l,name:"move-up-right"})),Ml=Sl,_l=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Cl=t=>k(Y,j(t,{iconNode:_l,name:"pencil"})),Pl=Cl,Al=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Ol=t=>k(Y,j(t,{iconNode:Al,name:"plus"})),Tl=Ol,El=[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M20 9H9.5A5.5 5.5 0 0 0 4 14.5A5.5 5.5 0 0 0 9.5 20H13",key:"6uklza"}]],Nl=t=>k(Y,j(t,{iconNode:El,name:"redo-2"})),Yn=Nl,zl=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Ll=t=>k(Y,j(t,{iconNode:zl,name:"save"})),Il=Ll,Dl=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],Rl=t=>k(Y,j(t,{iconNode:Dl,name:"share-2"})),jl=Rl,Fl=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Xl=t=>k(Y,j(t,{iconNode:Fl,name:"square"})),Yl=Xl,Wl=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],Vl=t=>k(Y,j(t,{iconNode:Wl,name:"sun"})),Hl=Vl,Ul=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Bl=t=>k(Y,j(t,{iconNode:Ul,name:"trash-2"})),Jt=Bl,ql=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],Gl=t=>k(Y,j(t,{iconNode:ql,name:"type"})),Kl=Gl,Zl=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],Jl=t=>k(Y,j(t,{iconNode:Zl,name:"undo-2"})),Wn=Jl,Ql=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],eo=t=>k(Y,j(t,{iconNode:Ql,name:"upload"})),to=eo,no=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],so=t=>k(Y,j(t,{iconNode:no,name:"x"})),Qt=so,io=D("<div class=toolbar-container><input type=file accept=image/* style=display:none>"),lo=D("<button>");const oo=[{type:"pan",icon:ol,label:"Pan Tool"},{type:"selection",icon:xl,label:"Selection"},{type:"rectangle",icon:Yl,label:"Rectangle"},{type:"circle",icon:ji,label:"Circle"},{type:"arrow",icon:Ml,label:"Arrow"},{type:"line",icon:Xn,label:"Line"},{type:"pencil",icon:Pl,label:"Pencil"},{type:"text",icon:Kl,label:"Text"},{type:"image",icon:Fn,label:"Insert Image"},{type:"eraser",icon:qi,label:"Eraser"}],ao=()=>{let t=null;const e=s=>{s==="image"?t?.click():As(s)},n=s=>{const i=s.target.files?.[0];if(!i)return;const l=new FileReader;l.onload=a=>{const o=a.target?.result;if(o){const r=new Image;r.src=o,r.onload=()=>{let c=r.width,u=r.height;if(c>500||u>500){const d=c/u;c>u?(c=500,u=c/d):(u=500,c=u*d)}Xt({id:crypto.randomUUID(),type:"image",x:100,y:100,width:c,height:u,strokeColor:"transparent",backgroundColor:"transparent",fillStyle:"solid",strokeWidth:0,strokeStyle:"solid",roughness:0,opacity:100,angle:0,renderStyle:"sketch",seed:Math.floor(Math.random()*2**31),roundness:null,locked:!1,link:null,dataURL:o,mimeType:i.type})}}},l.readAsDataURL(i),s.target.value=""};return(()=>{var s=io(),i=s.firstChild;return i.addEventListener("change",n),Be(l=>t=l,i),O(s,()=>oo.map(l=>(()=>{var a=lo();return a.$$click=()=>e(l.type),O(a,k(l.icon,{size:20})),B(o=>{var r=`toolbar-btn ${b.selectedTool===l.type?"active":""}`,h=l.label;return r!==o.e&&Pe(a,o.e=r),h!==o.t&&$e(a,"title",o.t=h),o},{e:void 0,t:void 0}),a})()),null),s})()};ke(["click"]);class ro{baseUrl="/api/drawings";async saveDrawing(e,n){await fetch(`${this.baseUrl}/${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})}async loadDrawing(e){const n=await fetch(`${this.baseUrl}/${e}`);return n.ok?await n.json():null}async listDrawings(){const e=await fetch(this.baseUrl);return e.ok?await e.json():[]}async deleteDrawing(e){await fetch(`${this.baseUrl}/${e}`,{method:"DELETE"})}}const xt=new ro;var co=D("<div class=loading>Loading..."),ho=D("<div class=empty>No saved drawings found."),uo=D("<div class=modal-overlay><div class=modal-content><div class=modal-header><h3>Open Drawing</h3><button class=close-btn></button></div><div class=modal-body><div class=file-list>"),fo=D("<div class=file-item><div style=display:flex;align-items:center;gap:8px;flex:1><span></span></div><button class=delete-file-btn title=Delete>");const po=t=>{const[e,n]=ee([]),[s,i]=ee(!1),l=async()=>{i(!0);try{const o=await xt.listDrawings();n(o.map(r=>r.replace(".json","")))}catch(o){console.error(o)}finally{i(!1)}},a=async(o,r)=>{if(r.stopPropagation(),confirm(`Are you sure you want to delete "${o}"?`))try{await xt.deleteDrawing(o),l()}catch{alert("Failed to delete file")}};return St(()=>{t.isOpen&&l()}),De(()=>{t.isOpen&&l()}),k(re,{get when(){return t.isOpen},get children(){var o=uo(),r=o.firstChild,h=r.firstChild,c=h.firstChild,u=c.nextSibling,d=h.nextSibling,p=d.firstChild;return he(o,"click",t.onClose,!0),r.$$click=m=>m.stopPropagation(),he(u,"click",t.onClose,!0),O(u,k(Qt,{size:20})),O(d,k(re,{get when(){return s()},get children(){return co()}}),p),O(d,k(re,{get when(){return _t(()=>!s())()&&e().length===0},get children(){return ho()}}),p),O(p,k(Ie,{get each(){return e()},children:m=>(()=>{var x=fo(),g=x.firstChild,$=g.firstChild,A=g.nextSibling;return x.$$click=()=>t.onSelect(m),O(g,k(el,{size:16}),$),O($,m),A.$$click=w=>a(m,w),O(A,k(Jt,{size:16})),x})()})),o}})};ke(["click"]);const go=async(t,e)=>{const n=b.elements;if(n.length===0)return;let s=1/0,i=1/0,l=-1/0,a=-1/0;n.forEach(m=>{s=Math.min(s,m.x),i=Math.min(i,m.y),l=Math.max(l,m.x+m.width),a=Math.max(a,m.y+m.height)});const o=20,r=l-s+o*2,h=a-i+o*2,c=document.createElement("canvas");c.width=r*t,c.height=h*t;const u=c.getContext("2d");if(!u)return;e&&(u.fillStyle="#ffffff",u.fillRect(0,0,c.width,c.height)),u.scale(t,t),u.translate(-s+o,-i+o);const d=Zt.canvas(c);n.forEach(m=>{jn(d,u,m)});const p=document.createElement("a");p.download="yappy_drawing.png",p.href=c.toDataURL("image/png"),p.click()},yo=()=>{const t=b.elements;if(t.length===0)return;let e=1/0,n=1/0,s=-1/0,i=-1/0;t.forEach(g=>{e=Math.min(e,g.x),n=Math.min(n,g.y),s=Math.max(s,g.x+g.width),i=Math.max(i,g.y+g.height)});const l=20,a=s-e+l*2,o=i-n+l*2,r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttribute("width",`${a}`),r.setAttribute("height",`${o}`),r.setAttribute("viewBox",`0 0 ${a} ${o}`),r.style.backgroundColor="#ffffff";const h=Zt.svg(r),c=document.createElementNS("http://www.w3.org/2000/svg","g");c.setAttribute("transform",`translate(${-e+l}, ${-n+l})`),r.appendChild(c),t.forEach(g=>{let $=null;const A={seed:g.seed,roughness:g.roughness,stroke:g.strokeColor,strokeWidth:g.strokeWidth,fill:g.backgroundColor==="transparent"?void 0:g.backgroundColor,fillStyle:g.fillStyle,strokeLineDash:g.strokeStyle==="dashed"?[10,10]:g.strokeStyle==="dotted"?[5,10]:void 0};if(g.type==="rectangle")$=h.rectangle(g.x,g.y,g.width,g.height,A);else if(g.type==="circle")$=h.ellipse(g.x+g.width/2,g.y+g.height/2,Math.abs(g.width),Math.abs(g.height),A);else if(g.type==="line"||g.type==="arrow"){const w=g.x+g.width,E=g.y+g.height;if(g.type==="arrow"){const z=document.createElementNS("http://www.w3.org/2000/svg","g");z.appendChild(h.line(g.x,g.y,w,E,A));const I=Math.atan2(g.height,g.width),H=15,F={x:w-H*Math.cos(I-Math.PI/6),y:E-H*Math.sin(I-Math.PI/6)},q={x:w-H*Math.cos(I+Math.PI/6),y:E-H*Math.sin(I+Math.PI/6)};z.appendChild(h.line(w,E,F.x,F.y,A)),z.appendChild(h.line(w,E,q.x,q.y,A)),$=z}else $=h.line(g.x,g.y,w,E,A)}else if(g.type==="pencil"&&g.points){const w=g.points.map(E=>[g.x+E.x,g.y+E.y]);$=h.linearPath(w,A)}else if(g.type==="text"&&g.text){const w=document.createElementNS("http://www.w3.org/2000/svg","text");w.textContent=g.text,w.setAttribute("x",`${g.x}`),w.setAttribute("y",`${g.y+(g.fontSize||20)}`),w.setAttribute("fill",g.strokeColor),w.setAttribute("font-family","sans-serif"),w.setAttribute("font-size",`${g.fontSize||20}px`),$=w}else if(g.type==="image"&&g.dataURL){const w=document.createElementNS("http://www.w3.org/2000/svg","image");w.setAttribute("href",g.dataURL),w.setAttribute("x",`${g.x}`),w.setAttribute("y",`${g.y}`),w.setAttribute("width",`${g.width}`),w.setAttribute("height",`${g.height}`),$=w}if($){if($.setAttribute("opacity",`${(g.opacity??100)/100}`),g.angle){const w=g.x+g.width/2,E=g.y+g.height/2;$.setAttribute("transform",`rotate(${g.angle*(180/Math.PI)}, ${w}, ${E})`)}c.appendChild($)}});const d=new XMLSerializer().serializeToString(r),p=new Blob([d],{type:"image/svg+xml"}),m=URL.createObjectURL(p),x=document.createElement("a");x.download="yappy_drawing.svg",x.href=m,x.click()};var mo=D("<div class=option-group><label>Scale</label><div class=scale-group><button>1x</button><button>2x</button><button>3x"),bo=D("<div class=option-group><label class=checkbox-label><input type=checkbox>White Background"),wo=D("<div class=export-modal-overlay><div class=export-modal><div class=export-header><h3>Export Image</h3><button class=close-btn></button></div><div class=export-options><div class=option-group><label>Format</label><div class=radio-group><label class=radio-label><input type=radio name=format>PNG</label><label class=radio-label><input type=radio name=format>SVG</label></div></div></div><div class=export-actions><button class=cancel-btn>Cancel</button><button class=export-confirm-btn>Export");const vo=t=>{const[e,n]=ee("png"),[s,i]=ee(2),[l,a]=ee(!0),o=()=>{e()==="png"?go(s(),l()):yo(),t.onClose()};return k(re,{get when(){return t.isOpen},get children(){var r=wo(),h=r.firstChild,c=h.firstChild,u=c.firstChild,d=u.nextSibling,p=c.nextSibling,m=p.firstChild,x=m.firstChild,g=x.nextSibling,$=g.firstChild,A=$.firstChild,w=$.nextSibling,E=w.firstChild,z=p.nextSibling,I=z.firstChild,H=I.nextSibling;return he(r,"click",t.onClose,!0),h.$$click=F=>F.stopPropagation(),he(d,"click",t.onClose,!0),O(d,k(Qt,{size:20})),A.addEventListener("change",()=>n("png")),E.addEventListener("change",()=>n("svg")),O(p,k(re,{get when(){return e()==="png"},get children(){return[(()=>{var F=mo(),q=F.firstChild,ie=q.nextSibling,oe=ie.firstChild,G=oe.nextSibling,X=G.nextSibling;return oe.$$click=()=>i(1),G.$$click=()=>i(2),X.$$click=()=>i(3),B(W=>{var se=`scale-btn ${s()===1?"active":""}`,te=`scale-btn ${s()===2?"active":""}`,ce=`scale-btn ${s()===3?"active":""}`;return se!==W.e&&Pe(oe,W.e=se),te!==W.t&&Pe(G,W.t=te),ce!==W.a&&Pe(X,W.a=ce),W},{e:void 0,t:void 0,a:void 0}),F})(),(()=>{var F=bo(),q=F.firstChild,ie=q.firstChild;return ie.addEventListener("change",oe=>a(oe.currentTarget.checked)),B(()=>ie.checked=l()),F})()]}}),null),he(I,"click",t.onClose,!0),H.$$click=o,B(()=>A.checked=e()==="png"),B(()=>E.checked=e()==="svg"),r}})};ke(["click"]);var ko=D("<div class=save-overlay><div class=save-modal><div class=save-header><h2>Save Drawing</h2><button class=close-btn></button></div><div class=save-content><div class=input-group><label>Filename</label><input type=text class=filename-input autofocus></div><div class=save-actions><button class=cancel-btn>Cancel</button><button class=confirm-btn>Save");const xo=t=>{const[e,n]=ee("");De(()=>{t.isOpen&&n(t.initialFilename||"untitled")});const s=()=>{e().trim()&&(t.onSave(e().trim()),t.onClose())},i=l=>{l.key==="Enter"?s():l.key==="Escape"&&t.onClose()};return k(re,{get when(){return t.isOpen},get children(){var l=ko(),a=l.firstChild,o=a.firstChild,r=o.firstChild,h=r.nextSibling,c=o.nextSibling,u=c.firstChild,d=u.firstChild,p=d.nextSibling,m=u.nextSibling,x=m.firstChild,g=x.nextSibling;return he(l,"click",t.onClose,!0),a.$$click=$=>$.stopPropagation(),he(h,"click",t.onClose,!0),O(h,k(Qt,{size:20})),p.$$keydown=i,p.$$input=$=>n($.currentTarget.value),he(x,"click",t.onClose,!0),g.$$click=s,B(()=>p.value=e()),l}})};ke(["click","input","keydown"]);var $o=D("<div class=menu-backdrop>"),So=D("<input type=file accept=.json style=display:none>"),Mo=D("<div class=app-title>"),_o=D('<div class=menu-dropdown><button class=menu-item><span class=label>Open Saved...</span><span class=shortcut>Ctrl+O</span></button><button class=menu-item><span class=label>Open from Disk...</span></button><button class=menu-item><span class=label>Save to Browser...</span><span class=shortcut>Ctrl+S</span></button><button class=menu-item><span class=label>Download JSON</span></button><div class=menu-separator></div><button class=menu-item><span class=label>Export image...</span><span class=shortcut>Ctrl+Shift+E</span></button><div class=menu-separator></div><button class=menu-item><span class=label>Reset Canvas</span></button><div class=menu-separator></div><div style="padding:4px 12px;font-size:12px;color:var(--text-secondary)">Found a bug? <a href=https://github.com/rajeshpillai/yappy/issues target=_blank rel="noopener noreferrer">Report'),Co=D('<div style=position:fixed;top:12px;left:12px;z-index:1001><div class=menu-container style=position:relative><button title=Menu></button><div style="width:1px;height:24px;background:var(--border-color);margin:0 4px"></div><button class=menu-btn title="Undo (Ctrl+Z)"></button><button class=menu-btn title="Redo (Ctrl+Y)"></button><div style="width:1px;height:24px;background:var(--border-color);margin:0 4px"></div><button class=menu-btn title=Delete></button><div style="width:1px;height:24px;background:var(--border-color);margin:0 4px"></div><button class=menu-btn title="Zoom to Fit">'),Po=D('<div style=position:fixed;top:12px;right:12px;z-index:100><div class=menu-container><button class="menu-btn primary"title=Share><span style=margin-left:4px>Share</span></button><div style="width:1px;height:24px;background:var(--border-color);margin:0 4px"></div><button class=menu-btn title="Toggle Theme">');const Ao=()=>{const[t,e]=ee("default"),[n,s]=ee(!1),[i,l]=ee(!1),[a,o]=ee(!1),[r,h]=ee(!1);let c;const u=()=>{o(!0),h(!1)},d=async w=>{try{await xt.saveDrawing(w,{elements:b.elements,viewState:b.viewState}),e(w),alert(`Drawing saved as "${w}"!`)}catch(E){console.error(E),alert("Failed to save")}},p=async w=>{const E=w||t();try{const z=await xt.loadDrawing(E);z?(V({elements:z.elements||[],viewState:z.viewState||{scale:1,panX:0,panY:0}}),e(E)):alert("Drawing not found")}catch(z){console.error(z),alert("Failed to load")}},m=()=>{confirm("Clear canvas?")&&(V("elements",[]),V("viewState",{scale:1,panX:0,panY:0}),V("selection",[]),Ts(),e("untitled")),h(!1)},x=()=>{zs()},g=()=>{const w=`${window.location.origin}${window.location.pathname}?id=${t()}`;navigator.clipboard.writeText(w),alert(`Link copied: ${w}`)},$=()=>{const w=JSON.stringify({elements:b.elements,viewState:b.viewState,version:1},null,2),E=new Blob([w],{type:"application/json"}),z=URL.createObjectURL(E),I=document.createElement("a");I.href=z,I.download=`${t()}.json`,document.body.appendChild(I),I.click(),document.body.removeChild(I),URL.revokeObjectURL(z),h(!1)},A=w=>{const E=w.target.files?.[0];if(!E)return;const z=new FileReader;z.onload=I=>{try{const H=JSON.parse(I.target?.result);if(H.elements){V({elements:H.elements,viewState:H.viewState||{scale:1,panX:0,panY:0}});const F=E.name.replace(/\.json$/i,"");e(F)}else alert("Invalid file format")}catch(H){console.error(H),alert("Failed to parse JSON")}},z.readAsText(E),h(!1),w.target.value=""};return St(()=>{const E=new URLSearchParams(window.location.search).get("id");E&&(e(E),p(E));const z=I=>{I.ctrlKey&&(I.key==="o"?(I.preventDefault(),s(!0)):I.key==="s"?(I.preventDefault(),u()):I.key.toLowerCase()==="e"&&I.shiftKey&&(I.preventDefault(),l(!0)))};window.addEventListener("keydown",z),Mt(()=>window.removeEventListener("keydown",z))}),[k(re,{get when(){return r()},get children(){var w=$o();return w.$$click=()=>h(!1),w}}),(()=>{var w=So();w.addEventListener("change",A);var E=c;return typeof E=="function"?Be(E,w):c=w,w})(),k(po,{get isOpen(){return n()},onClose:()=>s(!1),onSelect:w=>{p(w),s(!1)}}),k(vo,{get isOpen(){return i()},onClose:()=>l(!1)}),k(xo,{get isOpen(){return a()},onClose:()=>o(!1),onSave:d,get initialFilename(){return t()}}),(()=>{var w=Mo();return O(w,t),w})(),(()=>{var w=Co(),E=w.firstChild,z=E.firstChild,I=z.nextSibling,H=I.nextSibling,F=H.nextSibling,q=F.nextSibling,ie=q.nextSibling,oe=ie.nextSibling,G=oe.nextSibling;return z.$$click=()=>h(!r()),O(z,k(pl,{size:20})),O(E,k(re,{get when(){return r()},get children(){var X=_o(),W=X.firstChild,se=W.firstChild,te=W.nextSibling,ce=te.firstChild,xe=te.nextSibling,Xe=xe.firstChild,ye=xe.nextSibling,et=ye.firstChild,Pt=ye.nextSibling,_e=Pt.nextSibling,At=_e.firstChild,tt=_e.nextSibling,Te=tt.nextSibling,f=Te.firstChild,v=Te.nextSibling;return v.nextSibling,W.$$click=()=>{s(!0),h(!1)},O(W,k(sl,{size:16}),se),te.$$click=()=>{c?.click(),h(!1)},O(te,k(to,{size:16}),ce),xe.$$click=u,O(xe,k(Il,{size:16}),Xe),ye.$$click=$,O(ye,k(Hi,{size:16}),et),_e.$$click=()=>{l(!0),h(!1)},O(_e,k(Fn,{size:16}),At),Te.$$click=m,O(Te,k(Zi,{size:16}),f),X}}),I),he(H,"click",On,!0),O(H,k(Wn,{size:18})),he(F,"click",Ft,!0),O(F,k(Yn,{size:18})),ie.$$click=()=>je(b.selection),O(ie,k(Jt,{size:18})),G.$$click=x,O(G,k(ul,{size:18})),B(X=>{var W=`menu-btn ${r()?"active":""}`,se=b.selection.length===0;return W!==X.e&&Pe(z,X.e=W),se!==X.t&&(ie.disabled=X.t=se),X},{e:void 0,t:void 0}),w})(),(()=>{var w=Po(),E=w.firstChild,z=E.firstChild,I=z.firstChild,H=z.nextSibling,F=H.nextSibling;return z.$$click=g,O(z,k(jl,{size:18}),I),he(F,"click",Ns,!0),O(F,(()=>{var q=_t(()=>b.theme==="dark");return()=>q()?k(Hl,{size:18}):k(wl,{size:18})})()),w})()]};ke(["click"]);var Oo=D('<div class=zoom-container><div class=zoom-group><button class=zoom-btn title="Zoom Out"></button><button class="zoom-btn text-btn"title="Reset Zoom">%</button><button class=zoom-btn title="Zoom In"></button></div><div class=zoom-group style=margin-left:12px><button class=zoom-btn title="Undo (Coming Soon)"></button><button class=zoom-btn title="Redo (Coming Soon)">');const To=()=>{const t=()=>{const s=Math.min(b.viewState.scale*1.1,10);we({scale:s})},e=()=>{const s=Math.max(b.viewState.scale*.9,.1);we({scale:s})},n=()=>{we({scale:1})};return(()=>{var s=Oo(),i=s.firstChild,l=i.firstChild,a=l.nextSibling,o=a.firstChild,r=a.nextSibling,h=i.nextSibling,c=h.firstChild,u=c.nextSibling;return l.$$click=e,O(l,k(Xn,{size:16})),a.$$click=n,O(a,()=>Math.round(b.viewState.scale*100),o),r.$$click=t,O(r,k(Tl,{size:16})),O(c,k(Wn,{size:16})),O(u,k(Yn,{size:16})),s})()};ke(["click"]);const Eo=[{key:"renderStyle",label:"Style",type:"select",group:"style",options:[{label:"Sketch",value:"sketch"},{label:"Architectural",value:"architectural"}],applicableTo:["rectangle","circle","line","arrow"],defaultValue:"sketch"},{key:"strokeColor",label:"Stroke",type:"color",group:"stroke",applicableTo:"all",defaultValue:"#000000"},{key:"backgroundColor",label:"Background",type:"color",group:"background",applicableTo:["rectangle","circle","text"],defaultValue:"transparent"},{key:"fillStyle",label:"Fill",type:"select",group:"background",options:[{label:"Solid",value:"solid"},{label:"Hachure",value:"hachure"},{label:"Cross-Hatch",value:"cross-hatch"}],applicableTo:["rectangle","circle"],defaultValue:"hachure"},{key:"strokeWidth",label:"Width",type:"slider",min:1,max:20,step:1,group:"stroke",applicableTo:["rectangle","circle","line","arrow","pencil"],defaultValue:1},{key:"strokeStyle",label:"Stroke Style",type:"select",group:"stroke",options:[{label:"Solid",value:"solid"},{label:"Dashed",value:"dashed"},{label:"Dotted",value:"dotted"}],applicableTo:["rectangle","circle","line","arrow","pencil"],defaultValue:"solid"},{key:"roughness",label:"Sloppiness",type:"slider",min:0,max:3,step:.1,group:"style",applicableTo:["rectangle","circle","line","arrow"],defaultValue:1},{key:"opacity",label:"Opacity",type:"slider",min:0,max:100,step:1,group:"style",applicableTo:"all",defaultValue:100},{key:"fontSize",label:"Size",type:"select",options:[{label:"Small",value:16},{label:"Medium",value:20},{label:"Large",value:28},{label:"XL",value:36}],group:"text",applicableTo:["text"],defaultValue:20},{key:"fontFamily",label:"Font",type:"select",options:[{label:"Hand-drawn",value:1},{label:"Normal",value:2},{label:"Code",value:3}],group:"text",applicableTo:["text"],defaultValue:1},{key:"textAlign",label:"Align",type:"select",options:[{label:"Left",value:"left"},{label:"Center",value:"center"},{label:"Right",value:"right"}],group:"text",applicableTo:["text"],defaultValue:"left"},{key:"text",label:"Content",type:"textarea",group:"text",applicableTo:["text"],defaultValue:""},{key:"startArrowhead",label:"Start Arrow",type:"select",options:[{label:"None",value:null},{label:"Arrow",value:"arrow"},{label:"Dot",value:"dot"}],group:"style",applicableTo:["arrow","line"],defaultValue:null},{key:"endArrowhead",label:"End Arrow",type:"select",options:[{label:"None",value:null},{label:"Arrow",value:"arrow"},{label:"Dot",value:"dot"},{label:"Triangle",value:"triangle"}],group:"style",applicableTo:["arrow","line"],defaultValue:"arrow"},{key:"angle",label:"Angle",type:"number",group:"dimensions",applicableTo:"all",defaultValue:0},{key:"locked",label:"Locked",type:"toggle",group:"advanced",applicableTo:"all",defaultValue:!1},{key:"link",label:"Link",type:"input",group:"advanced",applicableTo:"all",defaultValue:null}];var No=D('<div class=control-col><label></label><div class=color-picker-container><div class=color-grid></div><div class=hex-input-row><span class=hash>#</span><input type=text class=hex-input><div class=system-picker-wrapper><input type=color title="Custom Color">'),zo=D("<button>"),Lo=D("<div class=diagonal-line-sm>"),Io=D("<div class=control-row><label></label><div class=slider-wrapper><input type=range><span class=value-display>"),Do=D("<div class=control-row><label></label><select>"),Ro=D("<option>"),jo=D("<div class=control-row><label></label><input type=checkbox>"),Fo=D("<div class=control-row><label></label><input type=text>"),Xo=D('<div class=control-col><label></label><textarea rows=3 style="width:100%;padding:8px;border:1px solid #d1d5db;border-radius:6px;font-family:inherit;font-size:13px;resize:vertical">'),Yo=D("<div class=header-actions><button title=Duplicate></button><button class=delete-btn title=Delete>"),Wo=D('<div class=property-group><div class=group-title>LAYERS</div><div class=layer-controls><button title="To Front"></button><button title=Forward></button><button title=Backward></button><button title="To Back">'),Vo=D("<div class=property-panel-container><div class=property-header><h3></h3></div><div class=property-content>"),Ho=D("<div class=property-group><div class=group-title>");const Uo=()=>{const t=ue(()=>{if(b.selection.length===1){const a=b.elements.find(o=>o.id===b.selection[0]);return a?{type:"element",data:a}:null}return null}),e=ue(()=>{const a=t();if(!a)return[];const o=a.data.type;return Eo.filter(r=>r.applicableTo==="all"?!0:Array.isArray(r.applicableTo)?r.applicableTo.includes(o):!0)}),n=(a,o)=>{const r=t();r&&(r.type==="element"?pe(r.data.id,{[a]:o},!0):Os({[a]:o}))},s=()=>{b.selection.length>0&&je(b.selection)},i=(a,o)=>{switch(a.type){case"color":const r=["transparent","#ffffff","#f8f9fa","#f1f3f5","#fff5f5","#fff0f6","#f3f0ff","#e03131","#e8590c","#fcc419","#2f9e44","#1971c2","#6741d9","#c2255c","#343a40"];return(()=>{var h=No(),c=h.firstChild,u=c.nextSibling,d=u.firstChild,p=d.nextSibling,m=p.firstChild,x=m.nextSibling,g=x.nextSibling,$=g.firstChild;return O(c,()=>a.label),O(d,k(Ie,{each:r,children:A=>(()=>{var w=zo();return w.$$click=()=>n(a.key,A),Pe(w,`color-swatch ${o===A?"selected":""}`),ze(w,"background",A==="transparent"?"white":A),$e(w,"title",A),O(w,A==="transparent"&&Lo()),w})()})),x.$$input=A=>{let w=A.currentTarget.value;n(a.key,"#"+w)},$.$$input=A=>n(a.key,A.currentTarget.value),B(()=>x.value=o?.replace("#","")||""),B(()=>$.value=o?.startsWith("#")?o:"#000000"),h})();case"slider":return(()=>{var h=Io(),c=h.firstChild,u=c.nextSibling,d=u.firstChild,p=d.nextSibling;return O(c,()=>a.label),d.$$input=m=>n(a.key,Number(m.currentTarget.value)),O(p,o),B(m=>{var x=a.min,g=a.max,$=a.step;return x!==m.e&&$e(d,"min",m.e=x),g!==m.t&&$e(d,"max",m.t=g),$!==m.a&&$e(d,"step",m.a=$),m},{e:void 0,t:void 0,a:void 0}),B(()=>d.value=o??a.defaultValue),h})();case"select":return(()=>{var h=Do(),c=h.firstChild,u=c.nextSibling;return O(c,()=>a.label),u.addEventListener("change",d=>{const p=d.currentTarget.value,m=a.options?.some(x=>typeof x.value=="number");n(a.key,m?Number(p):p)}),O(u,k(Ie,{get each(){return a.options},children:d=>(()=>{var p=Ro();return O(p,()=>d.label),B(()=>p.value=d.value??""),p})()})),B(()=>u.value=o??a.defaultValue),h})();case"toggle":return(()=>{var h=jo(),c=h.firstChild,u=c.nextSibling;return O(c,()=>a.label),u.addEventListener("change",d=>n(a.key,d.currentTarget.checked)),u.checked=!!o,h})();case"input":return(()=>{var h=Fo(),c=h.firstChild,u=c.nextSibling;return O(c,()=>a.label),u.$$input=d=>n(a.key,d.currentTarget.value),u.value=o||"",h})();case"textarea":return(()=>{var h=Xo(),c=h.firstChild,u=c.nextSibling;return O(c,()=>a.label),u.$$input=d=>n(a.key,d.currentTarget.value),u.value=o||"",h})();default:return null}},l=ue(()=>{const a={};return e().forEach(o=>{a[o.group]||(a[o.group]=[]),a[o.group].push(o)}),a});return k(re,{get when(){return t()},get children(){var a=Vo(),o=a.firstChild,r=o.firstChild,h=o.nextSibling;return O(r,()=>t()?.type==="element"?"Properties":"Defaults"),O(o,k(re,{get when(){return t()?.type==="element"},get children(){var c=Yo(),u=c.firstChild,d=u.nextSibling;return u.$$click=()=>Es(t().data.id),O(u,k(Yi,{size:16})),d.$$click=s,O(d,k(Jt,{size:16})),c}}),null),O(h,k(Ie,{get each(){return Object.entries(l())},children:([c,u])=>(()=>{var d=Ho(),p=d.firstChild;return O(p,()=>c.toUpperCase()),O(d,k(Ie,{each:u,children:m=>i(m,(t()?.data)[m.key])}),null),d})()}),null),O(h,k(re,{get when(){return t()?.type==="element"},get children(){var c=Wo(),u=c.firstChild,d=u.nextSibling,p=d.firstChild,m=p.nextSibling,x=m.nextSibling,g=x.nextSibling;return p.$$click=()=>st(t().data.id,"front"),O(p,k(Ii,{size:16})),m.$$click=()=>st(t().data.id,"forward"),O(m,k(Oi,{size:16})),x.$$click=()=>st(t().data.id,"backward"),O(x,k(Ci,{size:16})),g.$$click=()=>st(t().data.id,"back"),O(g,k(Ni,{size:16})),c}}),null),a}})};ke(["input","click"]);var Bo=D("<div>");const qo=()=>(St(()=>{const t=e=>{(e.ctrlKey||e.metaKey)&&e.key==="z"?(e.preventDefault(),e.shiftKey?Ft():On()):(e.ctrlKey||e.metaKey)&&e.key==="y"?(e.preventDefault(),Ft()):(e.key==="Delete"||e.key==="Backspace")&&document.activeElement?.tagName!=="INPUT"&&document.activeElement?.tagName!=="TEXTAREA"&&(e.preventDefault(),b.selection.length>0&&je(b.selection))};window.addEventListener("keydown",t),Mt(()=>window.removeEventListener("keydown",t))}),(()=>{var t=Bo();return O(t,k(ao,{}),null),O(t,k(Uo,{}),null),O(t,k(Ao,{}),null),O(t,k(To,{}),null),O(t,k(bi,{}),null),t})()),Go=document.getElementById("root");ds(()=>k(qo,{}),Go);
