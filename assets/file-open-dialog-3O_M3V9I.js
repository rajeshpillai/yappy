import{t as v,h as C,i as o,x as N,m as A,q as j,ax as z,e as K,d as X}from"./vendor-rendering-DL4SfLBt.js";import{e as u,l as Y,d as L,h as r,S as $,F as q,a as T}from"./solid-framework-CtC0wtKI.js";import{av as S,f as M}from"./index-CnAfgKvU.js";import"./vendor-export-B6WwIQ1_.js";var R=v("<div class=loading>Loading..."),U=v("<div class=empty>No saved drawings found."),V=v("<div class=modal-overlay><div class=modal-content><div class=modal-header><h3>Open Drawing</h3><button class=close-btn></button></div><div class=modal-body><div class=file-list>"),B=v("<div><div style=display:flex;align-items:center;gap:8px;flex:1><span></span></div><button class=delete-file-btn title=Delete>");const W=a=>{const[g,O]=u([]),[y,_]=u(!1),[h,m]=u(null),[b,p]=u(!1);let x=0,k=0;const D=async()=>{_(!0);try{const n=(await S.listDrawings()).map(e=>{const t=e.replace(/\.(json|yappy)$/i,"");return{id:t,name:t}}).sort((e,t)=>e.name.localeCompare(t.name));O(n),n.length>0&&m(n[0].id)}catch(i){console.error(i)}finally{_(!1)}},F=async(i,n)=>{n.stopPropagation();const e=i.replace(/\.json$/i,"");if(confirm(`Are you sure you want to delete "${e}"?`))try{await S.deleteDrawing(i),D(),M(`Deleted "${e}"`,"success")}catch{M("Failed to delete file","error")}};return Y(()=>{const i=e=>{if(!a.isOpen)return;const t=g();if(t.length===0)return;const d=h(),c=t.findIndex(s=>s.id===d);if(e.key==="ArrowDown"){e.preventDefault(),e.stopImmediatePropagation(),p(!0);const s=(c+1)%t.length;m(t[s].id)}else if(e.key==="ArrowUp"){e.preventDefault(),e.stopImmediatePropagation(),p(!0);const s=(c-1+t.length)%t.length;m(t[s].id)}else e.key==="Enter"?(e.preventDefault(),e.stopImmediatePropagation(),d&&a.onSelect(d)):e.key==="Escape"&&(e.preventDefault(),e.stopImmediatePropagation(),a.onClose())},n=e=>{(Math.abs(e.clientX-x)>2||Math.abs(e.clientY-k)>2)&&p(!1),x=e.clientX,k=e.clientY};return window.addEventListener("keydown",i,!0),window.addEventListener("mousemove",n),()=>{window.removeEventListener("keydown",i,!0),window.removeEventListener("mousemove",n)}}),L(()=>{a.isOpen&&D()}),L(()=>{h()&&a.isOpen&&b()&&setTimeout(()=>{const n=document.querySelector(".file-item.active");n&&n.scrollIntoView({block:"nearest",behavior:"smooth"})},0)}),r($,{get when(){return a.isOpen},get children(){var i=V(),n=i.firstChild,e=n.firstChild,t=e.firstChild,d=t.nextSibling,c=e.nextSibling,s=c.firstChild;return C(i,"click",a.onClose,!0),n.$$click=l=>l.stopPropagation(),C(d,"click",a.onClose,!0),o(d,r(N,{size:20})),o(c,r($,{get when(){return y()},get children(){return R()}}),s),o(c,r($,{get when(){return A(()=>!y())()&&g().length===0},get children(){return U()}}),s),o(s,r(q,{get each(){return g()},children:l=>(()=>{var f=B(),w=f.firstChild,E=w.firstChild,I=w.nextSibling;return f.addEventListener("mouseenter",()=>{b()||m(l.id)}),f.$$click=()=>a.onSelect(l.id),o(w,r(j,{size:16}),E),o(E,()=>l.name),I.$$click=P=>F(l.id,P),o(I,r(z,{size:16})),T(()=>K(f,`file-item ${h()===l.id?"active":""}`)),f})()})),i}})};X(["click"]);export{W as default};
